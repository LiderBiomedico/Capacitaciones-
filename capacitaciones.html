<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Capacitaciones - Hospital Susana L√≥pez de Valencia</title>
    
    <meta name="description" content="Sistema integral de gesti√≥n de capacitaciones hospitalarias">
    <meta name="theme-color" content="#2E7D32">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27%3E%3Ctext y=%27.9em%27 font-size=%2790%27%3Eüè•%3C/text%3E%3C/svg%3E">
    <link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27%3E%3Ctext y=%27.9em%27 font-size=%2790%27%3Eüè•%3C/text%3E%3C/svg%3E">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- QRCode.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2E7D32;
            --secondary: #66BB6A;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            transition: background 0.3s ease;
        }

        body.authenticated {
            background: linear-gradient(135deg, #f5f7fa 0%, #e9ecf1 100%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 30px rgba(0,0,0,0.08);
        }

        /* Header */
        .header {
            background: white;
            padding: 1.5rem 2rem;
            border-bottom: 2px solid #f0f0f0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo-section {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .logo-section h1 {
            color: var(--primary);
            font-size: 1.5rem;
            margin: 0;
            line-height: 1.20;
            }

        .logo-section p {
            color: #475569;
            font-size: 0.9rem;
            margin: 0;
            line-height: 1.05;
            }

        
        .header-hslv-logo{
            width: 48px;
            height: 48px;
            object-fit: contain;
            border-radius: 12px;
            background: #ffffff;
            padding: 6px;
            border: 1px solid rgba(15,23,42,0.08);
            box-shadow: 0 10px 24px rgba(15,23,42,0.08);
            flex: 0 0 auto;
            margin-top: 2px;
        }

        .title-block{
            display: flex;
            flex-direction: column;
            gap: 0px;
        
            line-height: 1.20;
        }

        .header-subtitle{
            margin: 0;
            margin-top: 2px;
            color: #0f766e;
            font-size: 0.95rem;
            font-weight: 600;
            letter-spacing: 0.2px;
        
            line-height: 1.20;
        }

        .header-hospital{
            color: #64748b;
            font-size: 0.9rem;
            margin: 0;
            
            margin-top: 2px;
            line-height: 1.20;
        }

        .header-developed{
            color: #94a3b8;
            font-size: 0.8rem;
            font-style: italic;
            margin: 0;
            
            margin-top: 2px;
            line-height: 1.20;
        }
.header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .connection-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
            border: 1px solid #81c784;
            border-radius: 20px;
            font-size: 0.85em;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            user-select: none;
        }

        .connection-indicator:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .connection-indicator.connected {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
            border-color: #F2FFFA;
            color: #F2FFFA;
        }

        .connection-indicator.disconnected {
            background: linear-gradient(135deg, #ffebee 0%, #fce4ec 100%);
            border-color: #F2FFFA;
            color: #F2FFFA;
        }

        .connection-indicator.checking {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-color: #F2FFFA;
            color: #F2FFFA;
        }

        .connection-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4caf50;
            animation: pulse 2s infinite;
            display: inline-block;
        }

        .connection-indicator.disconnected .connection-dot {
            background: #ef5350;
            animation: none;
            box-shadow: none;
        }

        .connection-indicator.checking .connection-dot {
            background: #ffa726;
            animation: pulse-fast 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
            50% { opacity: 0.7; box-shadow: 0 0 0 4px rgba(76, 175, 80, 0); }
        }

        @keyframes pulse-fast {
            0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(255, 167, 38, 0.7); }
            50% { opacity: 0.7; box-shadow: 0 0 0 4px rgba(255, 167, 38, 0); }
        }

        /* Navigation */
        .navigation {
            display: flex;
            background: #ffffff;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
            position: sticky;
            top: 100px;
            z-index: 999;
        }

        .nav-tab {
            flex: 1;
            min-width: 120px;
            padding: 1rem;
            background: white;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            color: #334155;
        }

        .nav-tab i {
            font-size: 1.3rem;
        
            color: currentColor;
        }

        .nav-tab:hover {
            background: #f8fafc;
            color: var(--primary);
        }

        .nav-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: #F1FAF5;
        }

        /* Main Content */
        .main-content {
            padding: 2rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            color: var(--primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.8rem;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #F2FFFA;
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .stat-icon {
            font-size: 3rem;
            opacity: 0.8;
        }

        .stat-info h3 {
            font-size: 2rem;
            margin: 0;
            color: #F2FFFA;
        }

        .stat-info p {
            margin: 0;
            opacity: 0.9;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        /* Questions Container */
        .questions-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .question-counter {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #F2FFFA;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
        }

        .question-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .question-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(102,126,234,0.15);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #e0e0e0;
        }

        .question-header h4 {
            color: var(--primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-remove {
            background: var(--danger);
            color: #F2FFFA;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-remove:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .question-text {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            transition: all 0.3s;
        }

        .question-text:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102,126,234,0.1);
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 0.5rem;
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: white;
            padding: 0.75rem;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .option-item:hover {
            border-color: var(--primary);
            background: #F1FAF5;
        }

        .option-item input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .radio-label {
            font-size: 0.85rem;
            color: #F2FFFA;
            min-width: 70px;
            font-weight: 500;
        }

        .option-text {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.95rem;
        }

        .option-text:focus {
            outline: none;
            border-color: var(--primary);
        }

        .help-text {
            display: block;
            margin-top: 0.5rem;
            font-size: 0.85rem;
            color: #F2FFFA;
            font-style: italic;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #F2FFFA;
        }

        .btn-secondary {
            background: #6c757d;
            color: #F2FFFA;
        }

        .btn-success {
            background: var(--success);
            color: #F2FFFA;
        }

        .btn-info {
            background: var(--info);
            color: #F2FFFA;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .modal-content h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 2rem;
            cursor: pointer;
            color: #6b7280;
            font-weight: bold;
        }

        .close:hover {
            color: var(--danger);
        }

        .qr-container {
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .access-info {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .access-info p {
            margin: 0.5rem 0;
        }

        .access-info strong {
            color: var(--primary);
        }

        .modal-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .modal-actions button {
            flex: 1;
        }

        /* Charts */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .charts-container canvas {
            max-height: 300px;
        }

                /* Loading Screen */
        .loading-screen {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            /* Verde claro futurista (sin transparencias) */
            background-color: #FFFFFF;
            background:
                radial-gradient(circle at 18% 18%, rgba(14,165,164,0.10) 0%, rgba(255,255,255,1) 55%),
                radial-gradient(circle at 82% 30%, rgba(22,163,74,0.10) 0%, rgba(255,255,255,1) 60%),
                linear-gradient(135deg,
                    rgba(255,255,255,1) 0%,
                    rgba(248,250,252,1) 55%,
                    rgba(255,255,255,1) 100%);
            background-size: 200% 200%;
            animation: greenFlow 10s ease-in-out infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.25s;
            overflow: hidden;
        }

        /* Grid futurista */
        .loading-screen::before {
            content: '';
            position: absolute;
            inset: -40%;
            background:
                repeating-linear-gradient(90deg, rgba(15,23,42,0.06) 0 1px, transparent 1px 88px),
                repeating-linear-gradient(0deg,  rgba(14,165,164,0.06) 0 1px, transparent 1px 88px);
            transform: rotate(12deg);
            animation: gridDrift 12s linear infinite;
            pointer-events: none;
        }

        /* Ondas / glow en movimiento */
        .loading-screen::after {
            content: '';
            position: absolute;
            inset: -50%;
            background:
                radial-gradient(circle at 50% 50%, rgba(14,165,164,0.18) 0%, rgba(22,163,74,0.12) 40%, rgba(255,255,255,1) 100%),
                conic-gradient(from 180deg at 50% 50%,
                    rgba(14,165,164,0.14),
                    rgba(22,163,74,0.14),
                    rgba(14,165,164,0.14));
            filter: blur(30px);
            animation: waveGlow 8s ease-in-out infinite;
            pointer-events: none;
        }

        .loader {
            position: relative;
            z-index: 1;
            text-align: center;
            color: #0F172A;
        }

        .loader i {
            font-size: 4rem;
            animation: pulse 1.5s infinite;
            filter: drop-shadow(0 0 18px rgba(0, 255, 170, 0.75));
        }

        .loader p {
            margin-top: 1rem;
            font-weight: 500;
            letter-spacing: 0.6px;
            text-shadow: 0 2px 10px rgba(15, 23, 42, 0.10);
            color: #F6F7F2;
            color: #334155;
        }


        .loader-title {
            margin-top: 1.1rem;
            font-weight: 700;
            letter-spacing: 0.8px;
            font-size: clamp(0.9rem, 1.7vw, 1.2rem); /* ~doble tama√±o */
            text-shadow: 0 0 16px rgba(0,0,0,0.35);
            text-align: center;
        }

        .loader-credit {
    position: fixed;
    left: 18px;
    bottom: 14px;
    margin: 0;
    font-weight: 500;
    letter-spacing: 0.3px;
    font-size: clamp(0.45rem, 0.95vw, 0.65rem); /* ~mitad del t√≠tulo */
    opacity: 0.85;
    text-shadow: 0 0 12px rgba(0,0,0,0.30);
    text-align: left;
    z-index: 2;
}

        .splash-logo {
            width: 160px;
            max-width: 45vw;
            height: auto;
            border-radius: 18px;
            background: #ffffff;
            padding: 10px;
            box-shadow:
                0 10px 28px rgba(0,0,0,0.25),
                0 0 28px rgba(14, 165, 164, 0.14);
            animation: logoFloat 2.4s ease-in-out infinite;
            display: inline-block;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .progress-track {
            width: min(420px, 78vw);
            height: 12px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.06);
            border: 1px solid rgba(15, 23, 42, 0.10);
overflow: hidden;
            margin: 18px auto 0;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            box-shadow: 0 6px 18px rgba(0,0,0,0.18);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg,
                rgba(14,165,164,0.95),
                rgba(22,163,74,0.95));
            box-shadow: 0 0 18px rgba(14, 165, 164, 0.20);
            animation: progressFill 5s linear forwards;
        }

        @keyframes progressFill {
            to { width: 100%; }
        }

        @keyframes greenFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes gridDrift {
            0% { transform: translate3d(0, 0, 0) rotate(12deg); }
            100% { transform: translate3d(120px, 80px, 0) rotate(12deg); }
        }

        @keyframes waveGlow {
            0%, 100% { transform: translate3d(-2%, -1%, 0) scale(1); }
            50% { transform: translate3d(2%, 1%, 0) scale(1.05); }
        }

        /* Footer */
        .footer {
            background: #f8f9fa;
            padding: 2rem;
            text-align: center;
            border-top: 2px solid #e0e0e0;
        }

        .footer p {
            margin: 0.5rem 0;
            color: #F2FFFA;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .charts-container {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }

            .form-actions .btn {
                width: 100%;
            }
        }

        /* ==================== GESTIONAR CAPACITACIONES ==================== */
        
        .trainings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .training-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .training-card:hover {
            border-color: var(--primary);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.2);
            transform: translateY(-5px);
        }

        .training-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .training-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .training-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .training-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .training-status.active {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #ffffff;
            font-weight: 600;
        }

        .training-status.inactive {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: #ffffff;
            font-weight: 600;
        }

        .training-info {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .training-info-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #F2FFFA;
        }

        .training-info-item i {
            width: 20px;
            color: var(--primary);
        }

        .training-code {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #F2FFFA;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            margin: 1rem 0;
        }

        .training-code-label {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-bottom: 0.25rem;
        }

        .training-code-value {
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 3px;
        }

        .training-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-action {
            flex: 1;
            padding: 0.6rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn-view {
            background: linear-gradient(135deg, #1565c0 0%, #1a3a8a 100%);
            color: #ffffff;
            font-weight: 600;
        }

        .btn-view:hover {
            background: #0d47a1;
            color: #ffffff;
        }

        .btn-qr {
            background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);
            color: #ffffff;
            font-weight: 600;
        }

        .btn-qr:hover {
            background: #4a235a;
            color: #ffffff;
        }

        .btn-delete {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: #ffffff;
            font-weight: 600;
        }

        .btn-delete:hover {
            background: #7f0000;
            color: #ffffff;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: #F2FFFA;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #F2FFFA;
        }

        .empty-state p {
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        /* Modal de detalles */
        .details-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .details-modal.active {
            display: flex;
        }

        .details-content {
            background: white;
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .details-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #F2FFFA;
            padding: 2rem;
            border-radius: 12px 12px 0 0;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .details-body {
            padding: 2rem;
        }

        .details-section {
            margin-bottom: 2rem;
        }

        .details-section h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .questions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .question-item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        .question-number {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 0.75rem;
            color: #F2FFFA;
        }

        .question-options {
            display: grid;
            gap: 0.5rem;
            margin-left: 1rem;
        }

        .question-option {
            padding: 0.5rem;
            background: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .question-option.correct {
            background: #e8f5e9;
            border-left: 3px solid #4caf50;
            font-weight: 500;
        }

        .loading-spinner {
            text-align: center;
            padding: 3rem;
            color: var(--primary);
        }

        .loading-spinner i {
            font-size: 3rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
           ESTILOS PARA LA SECCI√ìN DE REPORTES DE PARTICIPANTES
           ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

        /* Estilos para la tabla de participantes */
        #participantsTable tbody tr {
            border-bottom: 1px solid #e0e0e0;
            transition: all 0.3s;
        }

        #participantsTable tbody tr:hover {
            background: #F1FAF5;
        }

        #participantsTable tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        #participantsTable tbody tr:nth-child(even):hover {
            background: #f0f4ff;
        }

        .score-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            min-width: 50px;
            text-align: center;
            color: #ffffff;
        }

        .score-badge.excellent {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #ffffff;
        }

        .score-badge.good {
            background: linear-gradient(135deg, #1565c0 0%, #1a3a8a 100%);
            color: #ffffff;
        }

        .score-badge.average {
            background: linear-gradient(135deg, #e65100 0%, #bf360c 100%);
            color: #ffffff;
        }

        .score-badge.low {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: #ffffff;
        }

        .score-badge.pending {
            background: linear-gradient(135deg, #424242 0%, #616161 100%);
            color: #ffffff;
        }

        .improvement-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
            color: #ffffff;
        }

        .improvement-badge.positive {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #ffffff;
        }

        .improvement-badge.negative {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: #ffffff;
        }

        .improvement-badge.neutral {
            background: linear-gradient(135deg, #424242 0%, #616161 100%);
            color: #ffffff;
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            color: #ffffff;
        }

        .status-badge.completed {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #ffffff;
        }

        .status-badge.pretest-done {
            background: linear-gradient(135deg, #e65100 0%, #bf360c 100%);
            color: #ffffff;
        }

        .status-badge.pending {
            background: linear-gradient(135deg, #424242 0%, #616161 100%);
            color: #ffffff;
        }

        /* Estilos para impresi√≥n */
        @media print {
            .header, .navigation, .footer, .btn, .form-group, #trainingActionsContainer {
                display: none !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
            }
            
            #reportContainer {
                display: block !important;
            }
            
            .stats-grid {
                display: flex !important;
                flex-wrap: wrap !important;
            }
            
            .stat-card {
                background: white !important;
                color: #333 !important;
                border: 1px solid #ddd !important;
            }
            
            .stat-card h3, .stat-card p {
                color: #333 !important;
            }
        }

        /* Animaci√≥n de carga para reportes */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #reportContainer .card {
            animation: fadeInUp 0.5s ease-out;
        }

        #reportContainer .card:nth-child(2) { animation-delay: 0.1s; }
        #reportContainer .card:nth-child(3) { animation-delay: 0.2s; }
        #reportContainer .card:nth-child(4) { animation-delay: 0.3s; }
    
        .heartbeat-heart{
            display: inline-block;
            margin-left: 0.45em;
            font-size: 1em; /* mismo tama√±o del texto */
            line-height: 1;
            transform-origin: center;
            animation: heartBeat 1.05s ease-in-out infinite;
            filter: drop-shadow(0 2px 6px rgba(22, 163, 74, 0.28));
        }

        @keyframes heartBeat{
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.15); }
            40% { transform: scale(0.98); }
            60% { transform: scale(1.22); }
            75% { transform: scale(1.02); }
        }

        /* Header: indicador + fecha en esquina superior derecha */
        .header{
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-content{
            position: relative;
        }

        .header-actions{
            position: absolute;
            top: 14px;
            right: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: nowrap;
        }

        #currentDateTime{
            color: #0f172a;
            font-weight: 500;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        /* Ajuste visual del indicador para modo institucional */
        .connection-indicator{
            border-radius: 999px;
            padding: 8px 14px;
            box-shadow: 0 10px 22px rgba(15,23,42,0.06);
        }

        @media (max-width: 768px){
            .header-actions{
                position: static;
                margin-left: auto;
                margin-top: 8px;
            }
        }

</style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loader">
            <img class="splash-logo" src="data:image/png;base64,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" alt="Hospital Susana L√≥pez de Valencia">
            <div class="progress-track" aria-label="Cargando">
                <div class="progress-fill"></div>
            </div>
<p class="loader-title">Iniciando Sistema Inteligente de Capacitaciones HSLV <span class="heartbeat-heart" aria-hidden="true">üíö</span></p>
            <p class="loader-credit">Desarrollado por Ing. Paul Eduardo Mu√±oz Rodriguez</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <img class="header-hslv-logo" src="data:image/png;base64,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" alt="Hospital Susana L√≥pez de Valencia">
                    <div class="title-block">
                        <h1>Sistema de Capacitaciones</h1>
                        <p class="header-subtitle">Gesti√≥n del Ambiente y la Tecnolog√≠a</p>
                        <p class="header-hospital">Hospital Susana L√≥pez de Valencia</p>
                        <p class="header-developed">Desarrollado por Ing. Paul Eduardo Mu√±oz Rodriguez</p>
                    </div>
</div>
                </div>
                <div class="header-actions">
                    <div id="connectionIndicator" class="connection-indicator connected" onclick="testAirtableConnection()" title="Click para reconectar">
                        <div class="connection-dot"></div>
                        <span id="connectionText">Sistema en l√≠nea</span>
                    </div>
                    <span id="currentDateTime"></span>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navigation">
            <button class="nav-tab active" onclick="switchTab('dashboard')">
                <i class="fas fa-chart-line"></i>
                <span>Dashboard</span>
            </button>
            <button class="nav-tab" onclick="switchTab('create')">
                <i class="fas fa-plus-circle"></i>
                <span>Crear</span>
            </button>
            <button class="nav-tab" onclick="switchTab('manage')">
                <i class="fas fa-tasks"></i>
                <span>Gestionar</span>
            </button>
            <button class="nav-tab" onclick="switchTab('exam')">
                <i class="fas fa-clipboard-check"></i>
                <span>Examen</span>
            </button>
            <button class="nav-tab" onclick="switchTab('reports')">
                <i class="fas fa-chart-bar"></i>
                <span>Reportes</span>
            </button>

            <!-- Nuevo: Cronograma anual -->
            <button class="nav-tab" onclick="switchTab('schedule')">
                <i class="fas fa-calendar-alt"></i>
                <span>Cronograma</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Dashboard Tab -->
            <section id="dashboard" class="tab-content active">
                <h2 class="section-title">
                    <i class="fas fa-chart-line"></i> Panel de Control
                </h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-graduation-cap"></i></div>
                        <div class="stat-info">
                            <h3 id="totalTrainings">0</h3>
                            <p>Capacitaciones Activas</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <h3 id="totalParticipants">0</h3>
                            <p>Participantes Totales</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                        <div class="stat-info">
                            <h3 id="adherenceRate">0%</h3>
                            <p>Tasa de Adherencia</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="stat-info">
                            <h3 id="avgImprovement">0%</h3>
                            <p>Mejora Promedio</p>
                        </div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="card">
                        <h3>Participaciones por D√≠a</h3>
                        <canvas id="participationsChart"></canvas>
                    </div>
                    
                    <div class="card">
                        <h3>Rendimiento por Departamento</h3>
                        <canvas id="departmentChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Create Tab -->
            <section id="create" class="tab-content">
                <h2 class="section-title">
                    <i class="fas fa-plus-circle"></i> Crear Nueva Capacitaci√≥n
                </h2>
                
                <div class="card">
                    <h3>üìã Informaci√≥n General</h3>
                    <form id="trainingForm">
                        <div class="form-group">
                            <label><i class="fas fa-graduation-cap"></i> Capacitaci√≥n *</label>
                            <input type="text" id="trainingTitle" required placeholder="Ej: Protocolo de Higiene de Manos">
                        </div>
                        
                        <div class="form-group">
                            <label><i class="fas fa-align-left"></i> Descripci√≥n</label>
                            <textarea id="trainingDescription" rows="3" placeholder="Describe los objetivos..."></textarea>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label><i class="fas fa-calendar"></i> Fecha de Creaci√≥n *</label>
                                <input type="date" id="trainingDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label><i class="fas fa-building"></i> Departamento *</label>
                                <select id="trainingDepartment" required>
                                    <option value="">Seleccione...</option>
                                    <option value="General">General</option>
                                    <option value="Enfermer√≠a">Enfermer√≠a</option>
                                    <option value="Medicina">Medicina</option>
                                    <option value="Administraci√≥n">Administraci√≥n</option>
                                    <option value="Laboratorio">Laboratorio</option>
                                    <option value="Radiolog√≠a">Radiolog√≠a</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label><i class="fas fa-clock"></i> Duraci√≥n</label>
                                <input type="text" id="trainingDuration" placeholder="Ej: 30 minutos">
                            </div>
                        </div>

                        <div class="form-group">
                            <label><i class="fas fa-users-cog"></i> Personal Capacitado *</label>
                            <div id="trainingStaffContainer" style="background: #f8f9fa; border: 2px solid #e0e0e0; border-radius: 8px; padding: 1rem; max-height: 300px; overflow-y: auto;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.75rem;">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Jefe de Enfermer√≠a" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Jefe de Enfermer√≠a</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="M√©dico General" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>M√©dico General</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="M√©dico Especialista" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>M√©dico Especialista</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Ingeniero Biom√©dico" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Ingeniero Biom√©dico</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Estudiante" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Estudiante</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Auxiliar de Enfermer√≠a" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Auxiliar de Enfermer√≠a</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Terapeuta Respiratorio" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Terapeuta Respiratorio</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Fisioterapeuta" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Fisioterapeuta</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Conductor" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Conductor</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="T√©cnico de Rayos X" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>T√©cnico de Rayos X</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Fonoaudi√≥logo" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Fonoaudi√≥logo</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Instrumentador Quir√∫rgico" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Instrumentador Quir√∫rgico</span>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 0.5rem; margin: 0; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: all 0.3s;" onmouseover="this.style.background='#e8f0ff'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" value="Administrativo" class="trainingStaff" style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary);">
                                        <span>Administrativo</span>
                                    </label>
                                </div>
                            </div>
                            <small class="help-text">Selecciona el personal que recibir√° esta capacitaci√≥n</small>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <h3>‚ùì Pretest (Evaluaci√≥n Inicial)</h3>
                    <div id="pretestQuestions" class="questions-container"></div>
                    <button class="btn btn-secondary" onclick="addQuestion('pretest')">
                        <i class="fas fa-plus"></i> Agregar Pregunta
                    </button>
                </div>

                <div class="card">
                    <h3>‚úÖ Post-test (Evaluaci√≥n Final)</h3>
                    <div id="postestQuestions" class="questions-container"></div>
                    <button class="btn btn-secondary" onclick="addQuestion('postest')">
                        <i class="fas fa-plus"></i> Agregar Pregunta
                    </button>
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" onclick="saveTraining()">
                        <i class="fas fa-save"></i> Guardar Capacitaci√≥n
                    </button>
                    <button class="btn btn-secondary" onclick="resetForm()">
                        <i class="fas fa-undo"></i> Limpiar Formulario
                    </button>
                </div>
            </section>

            <!-- Other tabs... -->
            <section id="manage" class="tab-content">
                <h2 class="section-title"><i class="fas fa-tasks"></i> Gestionar Capacitaciones</h2>
                
                <!-- Loading State -->
                <div id="trainingsLoading" class="loading-spinner" style="display: none;">
                    <i class="fas fa-spinner"></i>
                    <p>Cargando capacitaciones...</p>
                </div>

                <!-- Empty State -->
                <div id="trainingsEmpty" class="empty-state" style="display: none;">
                    <i class="fas fa-inbox"></i>
                    <h3>No hay capacitaciones creadas</h3>
                    <p>Las capacitaciones que crees aparecer√°n aqu√≠</p>
                    <button class="btn btn-primary" onclick="switchTab('create')">
                        <i class="fas fa-plus"></i> Crear Primera Capacitaci√≥n
                    </button>
                </div>

                <!-- Trainings Grid -->
                <div id="trainingsGrid" class="trainings-grid"></div>
            </section>

            <!-- Modal para mostrar QR generado -->
            <div id="qrModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 500px; padding: 2rem; text-align: center;">
                    <button class="modal-close" onclick="closeQRModal()">&times;</button>
                    
                    <h3 style="margin-bottom: 1.5rem;">
                        <i class="fas fa-qrcode"></i> C√≥digo QR Generado
                    </h3>
                    
                    <p style="color: #F2FFFA; margin-bottom: 1.5rem;">
                        Captura este c√≥digo QR o comparte el enlace con tu personal
                    </p>
                    
                    <!-- Contenedor para el QR -->
                    <div id="qrCodeContainer" style="background: white; padding: 1.5rem; border-radius: 8px; border: 2px solid #e0e0e0; margin-bottom: 1.5rem; display: flex; justify-content: center;">
                        <div id="qrCode"></div>
                    </div>
                    
                    <!-- URL para compartir -->
                    <div style="margin-bottom: 1.5rem;">
                        <label style="font-weight: bold; color: #F2FFFA; display: block; margin-bottom: 0.5rem;">
                            <i class="fas fa-link"></i> Enlace de Acceso
                        </label>
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" id="qrUrl" readonly style="flex: 1; padding: 0.75rem; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 0.85rem; background: #f8f9fa;">
                            <button class="btn btn-secondary" onclick="copyQRUrl()" style="padding: 0.75rem 1rem; white-space: nowrap;">
                                <i class="fas fa-copy"></i> Copiar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Instrucciones -->
                    <div style="background: #f0f8ff; padding: 1rem; border-radius: 6px; text-align: left; margin-bottom: 1.5rem;">
                        <h4 style="margin: 0 0 0.75rem 0; color: #F2FFFA;">
                            <i class="fas fa-info-circle"></i> Instrucciones
                        </h4>
                        <ol style="margin: 0; padding-left: 1.25rem; color: #F2FFFA; font-size: 0.9rem;">
                            <li>Imprime este c√≥digo QR</li>
                            <li>Col√≥calo en el hospital (carteles, pasillos)</li>
                            <li>O comparte el enlace por WhatsApp/Email</li>
                            <li>Cuando alguien lo escanee, se abrir√° autom√°ticamente</li>
                            <li>‚úÖ La sesi√≥n se crear√° autom√°ticamente en Airtable</li>
                        </ol>
                    </div>
                    
                    <!-- Botones de acci√≥n -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                        <button class="btn btn-primary" onclick="downloadQRCode()" style="margin: 0;">
                            <i class="fas fa-download"></i> Descargar
                        </button>
                        <button class="btn btn-secondary" onclick="closeQRModal()" style="margin: 0;">
                            <i class="fas fa-times"></i> Cerrar
                        </button>
                    </div>
                </div>
            </div>

            <section id="exam" class="tab-content">
                <h2 class="section-title"><i class="fas fa-clipboard-check"></i> Realizar Examen</h2>
                
                <!-- Acceso con c√≥digo -->
                <div class="card" id="accessSection">
                    <h3><i class="fas fa-key"></i> Acceso a Capacitaci√≥n</h3>
                    <p style="color: #F2FFFA; margin-bottom: 1.5rem;">Ingresa el c√≥digo de acceso que recibiste para acceder a la capacitaci√≥n</p>
                    
                    <div class="form-group">
                        <label><i class="fas fa-barcode"></i> C√≥digo de Acceso *</label>
                        <input type="text" id="accessCode" placeholder="Ej: 3LZ5RV" style="text-transform: uppercase;">
                    </div>
                    
                    <button class="btn btn-primary" onclick="validateAndStartTraining()" style="width: 100%;">
                        <i class="fas fa-arrow-right"></i> Acceder a Capacitaci√≥n
                    </button>
                </div>
                
                <!-- √Årea de pretest (oculta inicialmente) -->
                <div id="pretestSection" style="display: none;">
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3><i class="fas fa-book"></i> Evaluaci√≥n Previa (Pre-Test)</h3>
                            <button class="btn btn-light" onclick="cancelTraining()" style="margin: 0;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <!-- Informaci√≥n de capacitaci√≥n -->
                        <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #2196F3;">
                            <p style="margin: 0;"><strong>Capacitaci√≥n:</strong> <span id="currentTrainingTitle">-</span></p>
                            <p style="margin: 0.5rem 0 0 0;"><strong>C√≥digo:</strong> <span id="currentAccessCode">-</span></p>
                        </div>
                        
                        <!-- Preguntas -->
                        <div id="pretestQuestionsContainer">
                            <!-- Se llena din√°micamente -->
                        </div>
                        
                        <!-- Bot√≥n enviar -->
                        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e0e0e0;">
                            <button class="btn btn-success" onclick="submitPretest()" style="width: 100%;">
                                <i class="fas fa-check"></i> Enviar Pre-Test
                            </button>
                        </div>
                    </div>
                </div>

                <!-- √Årea de Postest (oculta inicialmente) -->
                <div id="postestSection" style="display: none;">
                    <div class="section-header">
                        <h2>
                            <i class="fas fa-star"></i>
                            <span>Post-Test</span>
                        </h2>
                        <p>Evaluaci√≥n despu√©s de la capacitaci√≥n</p>
                    </div>

                    <div class="questions-section">
                        <div id="postestQuestionsContainer">
                            <!-- Preguntas del postest -->
                        </div>

                        <!-- Bot√≥n enviar -->
                        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e0e0e0;">
                            <button class="btn btn-success" onclick="submitPosttest()" style="width: 100%;">
                                <i class="fas fa-check"></i> Enviar Post-Test
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="reports" class="tab-content">
                <h2 class="section-title"><i class="fas fa-chart-bar"></i> Reportes de Participantes</h2>
                
                <!-- Selector de Capacitaci√≥n -->
                <div class="card">
                    <h3><i class="fas fa-graduation-cap"></i> Seleccionar Capacitaci√≥n</h3>
                    <p style="color: #F2FFFA; margin-bottom: 1rem;">Selecciona una capacitaci√≥n para ver el listado de participantes y sus calificaciones</p>
                    
                    <div class="form-group">
                        <label><i class="fas fa-list"></i> Capacitaci√≥n</label>
                        <select id="reportTrainingSelect" onchange="loadTrainingReport()">
                            <option value="">-- Selecciona una capacitaci√≥n --</option>
                        </select>
                    </div>
                </div>
                
                <!-- √Årea del Reporte (oculta inicialmente) -->
                <div id="reportContainer" style="display: none;">
                    
                    <!-- Informaci√≥n de la Capacitaci√≥n -->
                    <div class="card" style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%); color: #F2FFFA;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 1rem;">
                            <div>
                                <h3 style="color: #F2FFFA; margin: 0;"><i class="fas fa-book"></i> <span id="reportTrainingTitle">-</span></h3>
                                <p style="margin: 0.5rem 0 0 0; opacity: 0.9;"><span id="reportTrainingDescription">-</span></p>
                                <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">
                                    <i class="fas fa-building"></i> <span id="reportTrainingDepartment">-</span> | 
                                    <i class="fas fa-calendar"></i> <span id="reportTrainingDate">-</span>
                                </p>
                            </div>
                            <div style="text-align: right;">
                                <span id="reportTrainingStatus" class="training-status active" style="background: rgba(255,255,255,0.2); color: #F2FFFA;">Activa</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estad√≠sticas Generales -->
                    <div class="stats-grid" style="margin-bottom: 1.5rem;">
                        <div class="stat-card" style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);">
                            <div class="stat-icon"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <h3 id="reportTotalParticipants">0</h3>
                                <p>Participantes Totales</p>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);">
                            <div class="stat-icon"><i class="fas fa-check-double"></i></div>
                            <div class="stat-info">
                                <h3 id="reportCompletedPostest">0</h3>
                                <p>Completados</p>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="background: linear-gradient(135deg, #ffc107 0%, #d39e00 100%);">
                            <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="stat-info">
                                <h3 id="reportAvgImprovement">0%</h3>
                                <p>Mejora Promedio</p>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);">
                            <div class="stat-icon"><i class="fas fa-percentage"></i></div>
                            <div class="stat-info">
                                <h3 id="reportAdherenceRate">0%</h3>
                                <p>Tasa de Adherencia</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Promedios de Calificaciones -->
                    <div class="card" style="margin-bottom: 1.5rem;">
                        <h3><i class="fas fa-star"></i> Promedios de Calificaciones</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #1565c0 0%, #1a3a8a 100%); border-radius: 8px;">
                                <p style="margin: 0; color: #ffffff; font-size: 0.9rem; font-weight: 600;">Promedio Pretest</p>
                                <p style="margin: 0.5rem 0 0 0; font-size: 2rem; font-weight: bold; color: #ffffff;" id="reportAvgPretest">0%</p>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%); border-radius: 8px;">
                                <p style="margin: 0; color: #ffffff; font-size: 0.9rem; font-weight: 600;">Promedio Posttest</p>
                                <p style="margin: 0.5rem 0 0 0; font-size: 2rem; font-weight: bold; color: #ffffff;" id="reportAvgPostest">0%</p>
                            </div>
                            <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, #e65100 0%, #bf360c 100%); border-radius: 8px;">
                                <p style="margin: 0; color: #ffffff; font-size: 0.9rem; font-weight: 600;">Mejora Promedio</p>
                                <p style="margin: 0.5rem 0 0 0; font-size: 2rem; font-weight: bold; color: #ffffff;" id="reportAvgImprovementBig">+0%</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabla de Participantes -->
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;">
                            <h3 style="margin: 0;"><i class="fas fa-list-alt"></i> Listado de Participantes</h3>
                            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                <button class="btn btn-info" onclick="exportReportCSV()" style="margin: 0;">
                                    <i class="fas fa-file-csv"></i> Exportar CSV
                                </button>
                                <button class="btn btn-success" onclick="exportReportExcel()" style="margin: 0;">
                                    <i class="fas fa-file-excel"></i> Exportar Excel
                                </button>
                                <button class="btn btn-secondary" onclick="printReport()" style="margin: 0;">
                                    <i class="fas fa-print"></i> Imprimir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Filtros de la tabla -->
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                            <div class="form-group" style="margin: 0; flex: 1; min-width: 200px;">
                                <input type="text" id="participantSearchInput" placeholder="üîç Buscar por nombre..." onkeyup="filterParticipantsTable()">
                            </div>
                            <div class="form-group" style="margin: 0; min-width: 150px;">
                                <select id="participantStatusFilter" onchange="filterParticipantsTable()">
                                    <option value="">Todos los estados</option>
                                    <option value="Completado">Completados</option>
                                    <option value="Pretest Completado">Pretest Completado</option>
                                    <option value="Pendiente">Pendientes</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Tabla -->
                        <div style="overflow-x: auto;">
                            <table id="participantsTable" style="width: 100%; border-collapse: collapse; min-width: 800px;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%); color: #F2FFFA;">
                                        <th style="padding: 0.75rem; text-align: left; border-radius: 8px 0 0 0;">#</th>
                                        <th style="padding: 0.75rem; text-align: left;">Participante</th>
                                        <th style="padding: 0.75rem; text-align: left;">Departamento</th>
                                        <th style="padding: 0.75rem; text-align: center;">Pretest</th>
                                        <th style="padding: 0.75rem; text-align: center;">Posttest</th>
                                        <th style="padding: 0.75rem; text-align: center;">Mejora</th>
                                        <th style="padding: 0.75rem; text-align: center; border-radius: 0 8px 0 0;">Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="participantsTableBody">
                                    <!-- Se llena din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Mensaje cuando no hay participantes -->
                        <div id="noParticipantsMessage" style="display: none; text-align: center; padding: 2rem; color: #F2FFFA;">
                            <i class="fas fa-users" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                            <p>No hay participantes registrados en esta capacitaci√≥n</p>
                        </div>
                    </div>
                    
                    <!-- Acciones de la Capacitaci√≥n -->
                    <div class="card" style="background: #f8f9fa; border: 2px dashed #dee2e6;">
                        <h3><i class="fas fa-cog"></i> Acciones de la Capacitaci√≥n</h3>
                        <p style="color: #1f2937; margin-bottom: 1.5rem; font-weight: 500;">
                            Cuando una capacitaci√≥n ha finalizado, puedes marcarla como completada para poder reutilizarla en el futuro.
                        </p>
                        
                        <div id="trainingActionsContainer">
                            <!-- Se llena din√°micamente seg√∫n el estado de la capacitaci√≥n -->
                        </div>
                    </div>
                </div>
                
                <!-- Estado de carga -->
                <div id="reportLoading" style="display: none; text-align: center; padding: 3rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 3rem; color: var(--primary);"></i>
                    <p style="color: #1f2937; margin-top: 1rem; font-weight: 600;">Cargando reporte...</p>
                </div>
                
                <!-- Mensaje inicial -->
                <div id="reportInitialMessage" class="card" style="text-align: center; padding: 3rem;">
                    <i class="fas fa-chart-pie" style="font-size: 4rem; color: var(--primary); margin-bottom: 1rem;"></i>
                    <h3 style="color: #1f2937;">Selecciona una Capacitaci√≥n</h3>
                    <p style="color: #4b5563; font-weight: 500;">Elige una capacitaci√≥n del listado para ver el reporte de participantes</p>
                </div>
            </section>

            <!-- Cronograma Tab (Nuevo) -->
            <section id="schedule" class="tab-content">
                <h2 class="section-title">
                    <i class="fas fa-calendar-alt"></i> Cronograma Anual de Capacitaciones
                </h2>

                <div class="card">
                    <h3><i class="fas fa-sliders-h"></i> Configuraci√≥n</h3>
                    <p style="color: #F2FFFA; margin-bottom: 1rem;">
                        Genera un cronograma para un <strong>a√±o completo</strong> usando las capacitaciones <strong>activas</strong> (no finalizadas)
                        registradas en el sistema.
                    </p>

                    <div class="form-row" style="display:flex; flex-wrap:wrap; gap: 1rem; align-items: end;">
                        <div class="form-group" style="margin: 0; min-width: 140px;">
                            <label><i class="fas fa-calendar"></i> A√±o</label>
                            <input id="scheduleYear" type="number" min="2020" max="2100" />
                        </div>

                        <div class="form-group" style="margin: 0; min-width: 180px;">
                            <label><i class="fas fa-clock"></i> Frecuencia</label>
                            <select id="scheduleFrequency">
                                <option value="monthly" selected>Mensual (12 eventos)</option>
                                <option value="bimonthly">Bimestral (6 eventos)</option>
                                <option value="quarterly">Trimestral (4 eventos)</option>
                                <option value="weekly">Semanal (52 eventos)</option>
                            </select>
                        </div>

                        <div class="form-group" style="margin: 0; min-width: 180px;">
                            <label><i class="fas fa-layer-group"></i> Semana del mes</label>
                            <select id="scheduleWeekOfMonth">
                                <option value="1" selected>1ra semana</option>
                                <option value="2">2da semana</option>
                                <option value="3">3ra semana</option>
                                <option value="4">4ta semana</option>
                                <option value="last">√öltima semana</option>
                            </select>
                        </div>

                        <div class="form-group" style="margin: 0; min-width: 180px;">
                            <label><i class="fas fa-calendar-day"></i> D√≠a de la semana</label>
                            <select id="scheduleDayOfWeek">
                                <option value="1" selected>Lunes</option>
                                <option value="2">Martes</option>
                                <option value="3">Mi√©rcoles</option>
                                <option value="4">Jueves</option>
                                <option value="5">Viernes</option>
                                <option value="6">S√°bado</option>
                                <option value="0">Domingo</option>
                            </select>
                        </div>

                        <div class="form-group" style="margin: 0; min-width: 140px;">
                            <label><i class="fas fa-hourglass-half"></i> Hora</label>
                            <input id="scheduleTime" type="time" value="08:00" />
                        </div>
                    </div>

                    <div class="form-actions" style="display:flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="generateAnnualSchedule()">
                            <i class="fas fa-magic"></i> Generar Cronograma
                        </button>
                        <button id="btnLoadScheduleFromAirtable" class="btn btn-light" onclick="loadManualScheduleData(true)">
                            <i class="fas fa-cloud-download-alt"></i> Cargar de Airtable
                        </button>
                        <button id="btnSaveGeneratedToAirtable" class="btn btn-outline-primary" onclick="saveGeneratedScheduleToAirtable()" disabled>
                            <i class="fas fa-cloud-upload-alt"></i> Guardar generados
                        </button>
                        <button id="btnDownloadScheduleExcel" class="btn btn-success" onclick="downloadScheduleExcel()" disabled>
                            <i class="fas fa-file-excel"></i> Descargar Excel
                        </button>
                        <button id="btnDownloadScheduleICS" class="btn btn-info" onclick="downloadScheduleICS()" disabled>
                            <i class="fas fa-calendar-plus"></i> Descargar .ICS
                        </button>
                        <button id="btnPrintSchedule" class="btn btn-secondary" onclick="printSchedule()" disabled>
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                    </div>

                    <div style="margin-top: 0.75rem; color: #F2FFFA; font-size: 0.9em;">
                        Consejo: si tienes m√°s de 12 capacitaciones activas, se distribuir√°n en el a√±o con m√∫ltiples eventos por mes.
                    </div>
                </div>

                                <div class="card" style="margin-top: 1.25rem;">
                    <h3><i class="fas fa-calendar-plus"></i> Capacitaciones individuales (fecha espec√≠fica)</h3>
                    <p style="color: #F2FFFA; margin-bottom: 1rem;">
                        Agrega eventos puntuales con fecha y hora exactas. Se incluyen en <strong>Excel</strong>, <strong>.ICS</strong> e <strong>Impresi√≥n</strong>.
                    </p>

                    <div class="form-row" style="display:flex; flex-wrap:wrap; gap: 1rem; align-items:end;">
                        <div class="form-group" style="margin:0; min-width: 260px; flex:1;">
                            <label><i class="fas fa-chalkboard-teacher"></i> Capacitaci√≥n</label>
                            <select id="manualTrainingSelect"></select>
                            <small style="color: #F2FFFA;">Si no aparece, selecciona ‚ÄúOtra‚Ä¶‚Äù y escribe el nombre.</small>
                        </div>

                        <div class="form-group" style="margin:0; min-width: 240px; flex:1; display:none;" id="manualTrainingOtherWrap">
                            <label><i class="fas fa-pen"></i> Nombre (otra)</label>
                            <input id="manualTrainingOther" type="text" placeholder="Ej: Seguridad del Paciente" />
                        </div>

                        <div class="form-group" style="margin:0; min-width: 160px;">
                            <label><i class="fas fa-calendar-day"></i> Fecha</label>
                            <input id="manualDate" type="date" />
                        </div>

                        <div class="form-group" style="margin:0; min-width: 140px;">
                            <label><i class="fas fa-clock"></i> Hora</label>
                            <input id="manualTime" type="time" value="08:00" />
                        </div>

                        <div class="form-group" style="margin:0; min-width: 160px;">
                            <label><i class="fas fa-stopwatch"></i> Duraci√≥n</label>
                            <input id="manualDuration" type="text" placeholder="Ej: 2 horas" />
                        </div>

                        <div class="form-group" style="margin:0; min-width: 220px; flex:1;">
                            <label><i class="fas fa-location-dot"></i> Lugar</label>
                            <input id="manualLocation" type="text" placeholder="Ej: Auditorio / UCI" />
                        </div>

                        <div class="form-group" style="margin:0; min-width: 220px; flex:1;">
                            <label><i class="fas fa-note-sticky"></i> Observaci√≥n</label>
                            <input id="manualNotes" type="text" placeholder="Ej: Turno ma√±ana / grupo A" />
                        </div>
                    </div>

                    <div class="form-actions" style="display:flex; flex-wrap:wrap; gap: 0.75rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="addManualScheduleEvent()">
                            <i class="fas fa-plus"></i> Agregar
                        </button>
                        <button class="btn btn-secondary" onclick="clearManualScheduleForm()">
                            <i class="fas fa-eraser"></i> Limpiar
                        </button>
                    </div>

                    <div id="manualScheduleEmpty" style="margin-top: 1rem; color: #F2FFFA;">
                        A√∫n no has agregado eventos individuales.
                    </div>

                    <div id="manualScheduleContainer" style="display:none; margin-top: 1rem;">
                        <div style="overflow-x:auto;">
                            <table id="manualScheduleTable" style="width:100%; border-collapse: collapse; min-width: 900px;">
                                <thead>
                                    <tr style="background: #f3f4f6;">
                                        <th style="padding:10px; border:1px solid #e5e7eb;">#</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Fecha</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Hora</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Capacitaci√≥n</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Lugar</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Duraci√≥n</th>
                                        <th style="padding:10px; border:1px solid #e5e7eb;">Acci√≥n</th>
                                    </tr>
                                </thead>
                                <tbody id="manualScheduleTbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

<div id="scheduleEmpty" class="card" style="text-align:center; padding: 2.5rem; display:none;">
                    <i class="fas fa-info-circle" style="font-size: 3rem; color: #F2FFFA; margin-bottom: 1rem;"></i>
                    <h3 style="color: #F2FFFA;">Sin capacitaciones activas</h3>
                    <p style="color: #F2FFFA;">Crea o activa capacitaciones para poder generar el cronograma anual.</p>
                </div>

                <div id="scheduleContainer" style="display:none;">
                    <div class="card">
                        <h3><i class="fas fa-table"></i> Cronograma Generado</h3>
                        <div style="overflow-x:auto;">
                            <table id="scheduleTable" style="width: 100%; border-collapse: collapse; min-width: 950px;">
                                <thead>
                                    <tr style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%); color: #F2FFFA;">
                                        <th style="padding: 0.75rem; text-align:left; border-radius: 8px 0 0 0;">#</th>
                                        <th style="padding: 0.75rem; text-align:left;">Fecha</th>
                                        <th style="padding: 0.75rem; text-align:left;">Hora</th>
                                        <th style="padding: 0.75rem; text-align:left;">Capacitaci√≥n</th>
                                        <th style="padding: 0.75rem; text-align:left;">Departamento</th>
                                        <th style="padding: 0.75rem; text-align:left; border-radius: 0 8px 0 0;">Duraci√≥n</th>
                                    </tr>
                                </thead>
                                <tbody id="scheduleTableBody">
                                    <!-- Se llena din√°micamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2025 Hospital Susana L√≥pez de Valencia</p>
            <p>Desarrollado con ‚ù§Ô∏è por Ing. Paul Eduardo Mu√±oz Rodriguez</p>
        </footer>
    </div>

    <!-- QR Modal -->
    <div id="qrModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>üì± C√≥digo QR de Acceso</h2>
            <div id="qrcode" class="qr-container"></div>
            <div class="access-info">
                <p><strong>C√≥digo:</strong> <span id="modalAccessCode"></span></p>
                <p><strong>Link:</strong> <span id="modalAccessLink"></span></p>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="copyLink()">
                    <i class="fas fa-copy"></i> Copiar
                </button>
                <button class="btn btn-success" onclick="shareWhatsApp()">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </button>
                <button class="btn btn-info" onclick="downloadQR()">
                    <i class="fas fa-download"></i> Descargar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Registro de Participante -->
    <div id="participantRegistrationModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeParticipantModal()">&times;</span>
            <h2 style="text-align: center; margin-bottom: 0.5rem; color: var(--primary);">
                <i class="fas fa-user-plus"></i> Registro de Participante
            </h2>
            <p style="text-align: center; color: #4b5563; margin-bottom: 1.5rem; font-weight: 500;">
                Por favor completa tu informaci√≥n para acceder a la capacitaci√≥n
            </p>
            
            <div class="form-group">
                <label><i class="fas fa-user"></i> Nombre Completo *</label>
                <input type="text" id="participantName" placeholder="Ej: Juan Garc√≠a L√≥pez" required>
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-hospital"></i> Servicio M√©dico (Departamento) *</label>
                <select id="participantDepartment" required>
                    <option value="">Seleccione su departamento...</option>
                    <option value="General">General</option>
                    <option value="Enfermer√≠a">Enfermer√≠a</option>
                    <option value="Medicina">Medicina</option>
                    <option value="Administraci√≥n">Administraci√≥n</option>
                    <option value="Laboratorio">Laboratorio</option>
                    <option value="Radiolog√≠a">Radiolog√≠a</option>
                    <option value="Urgencias">Urgencias</option>
                    <option value="UCI">UCI</option>
                    <option value="Quir√≥fano">Quir√≥fano</option>
                    <option value="Pediatr√≠a">Pediatr√≠a</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            
            <div class="modal-actions" style="flex-direction: column; gap: 0.75rem;">
                <button class="btn btn-success" onclick="proceedToPretest()" style="width: 100%;">
                    <i class="fas fa-check"></i> Continuar al Pre-Test
                </button>
                <button class="btn btn-light" onclick="closeParticipantModal()" style="width: 100%;">
                    <i class="fas fa-times"></i> Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Details Modal -->
    <div id="detailsModal" class="details-modal">
        <div class="details-content">
            <div class="details-header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2 style="margin: 0;"><i class="fas fa-info-circle"></i> Detalles de Capacitaci√≥n</h2>
                    <button class="close" onclick="closeDetailsModal()" style="background: rgba(255,255,255,0.2); color: #F2FFFA; border: none; font-size: 2rem; cursor: pointer; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">&times;</button>
                </div>
            </div>
            <div class="details-body" id="detailsBody">
                <!-- Se llenar√° din√°micamente -->
            </div>
        </div>
    </div>

    <script>
        // ==================== VARIABLES GLOBALES ====================
        let pretestQuestionCount = 0;
        let postestQuestionCount = 0;
        const MAX_QUESTIONS = 10;
        
        // Variables para el flujo de pretest
        let currentAccessCode = null;
        let currentTrainingRecord = null;
        let currentParticipantData = {};
        let pretestAnswers = {};
        let postestAnswers = {};
        
        // Variables para rastrear participaci√≥n
        let currentParticipationId = null;
        let currentSessionId = null;
        let postestCode = null;

        // ==================== FUNCIONES DE PARTICIPANTE ====================
        
        async function validateAndStartTraining() {
            const code = document.getElementById('accessCode').value.toUpperCase().trim();
            
            if (!code) {
                Swal.fire({
                    icon: 'warning',
                    title: 'C√≥digo Requerido',
                    text: 'Por favor ingresa el c√≥digo de acceso',
                    confirmButtonText: 'Entendido'
                });
                return;
            }
            
            try {
                Swal.fire({
                    title: 'Buscando capacitaci√≥n...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                // Buscar todas las sesiones para debugging
                const allResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Sesiones`
                    })
                });
                
                const allData = await allResponse.json();
                console.log('üìã Todas las sesiones:', allData.records);
                
                // Buscar la sesi√≥n espec√≠fica
                let session = null;
                
                if (allData.success && allData.records) {
                    session = allData.records.find(s => {
                        const codigoAcceso = s.fields['C√≥digo Acceso'] || '';
                        const activa = s.fields['Activa'] !== false;
                        return codigoAcceso.toUpperCase() === code && activa;
                    });
                }
                
                if (!session) {
                    Swal.close();
                    Swal.fire({
                        icon: 'error',
                        title: 'C√≥digo Inv√°lido',
                        text: 'El c√≥digo "' + code + '" no existe o la sesi√≥n no est√° activa.\n\nVerifica en Airtable que:\n1. El c√≥digo exista en la tabla Sesiones\n2. El campo "Activa" est√© marcado ‚úÖ\n3. El c√≥digo sea exactamente: ' + code
                    });
                    return;
                }
                
                console.log('‚úÖ Sesi√≥n encontrada:', session);
                
                // Obtener ID de capacitaci√≥n - probar m√∫ltiples nombres de campos
                let trainingId = null;
                
                // Intentar diferentes nombres de campo
                if (session.fields['Capacitaciones'] && Array.isArray(session.fields['Capacitaciones']) && session.fields['Capacitaciones'].length > 0) {
                    trainingId = session.fields['Capacitaciones'][0];
                    console.log('‚úÖ Campo "Capacitaciones" encontrado');
                } else if (session.fields['Capacitaci√≥n'] && Array.isArray(session.fields['Capacitaci√≥n']) && session.fields['Capacitaci√≥n'].length > 0) {
                    trainingId = session.fields['Capacitaci√≥n'][0];
                    console.log('‚úÖ Campo "Capacitaci√≥n" encontrado');
                } else if (session.fields['capacitacion'] && Array.isArray(session.fields['capacitacion']) && session.fields['capacitacion'].length > 0) {
                    trainingId = session.fields['capacitacion'][0];
                    console.log('‚úÖ Campo "capacitacion" encontrado');
                }
                
                if (!trainingId) {
                    Swal.close();
                    console.error('‚ùå Campo de capacitaci√≥n vac√≠o:', session.fields);
                    Swal.fire({
                        icon: 'error',
                        title: 'Error de Configuraci√≥n',
                        html: `<p>La sesi√≥n con c√≥digo <strong>${code}</strong> no tiene capacitaci√≥n enlazada.</p>
                               <p><strong>En Airtable:</strong></p>
                               <p>1. Abre tabla "Sesiones"</p>
                               <p>2. Busca el registro con c√≥digo "${code}"</p>
                               <p>3. En el campo "Capacitaciones" (o "Capacitaci√≥n"), haz click y selecciona una capacitaci√≥n</p>
                               <p>4. Guarda y vuelve a intentar</p>`
                    });
                    return;
                }
                
                console.log('üéì ID de Capacitaci√≥n:', trainingId);
                
                // Obtener datos de la capacitaci√≥n
                const trainingResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Capacitaciones/${trainingId}`
                    })
                });
                
                const trainingData = await trainingResponse.json();
                
                console.log('üìö Datos de Capacitaci√≥n:', trainingData);
                
                if (!trainingData.success || !trainingData.fields) {
                    throw new Error('No se pudieron obtener los datos de la capacitaci√≥n');
                }
                
                // Guardar datos actuales
                currentAccessCode = code;
                currentTrainingRecord = {
                    id: trainingId,
                    fields: trainingData.fields
                };
                
                console.log('‚úÖ Datos guardados - ID de capacitaci√≥n:', trainingId);
                console.log('‚úÖ currentTrainingRecord:', currentTrainingRecord);
                
                Swal.close();
                
                // Mostrar modal de registro
                showParticipantRegistrationModal();
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                Swal.close();
                Swal.fire({
                    icon: 'error',
                    title: 'Error del Sistema',
                    text: 'Hubo un error: ' + error.message + '\n\nAbre DevTools (F12) para ver detalles'
                });
            }
        }
        
        function showParticipantRegistrationModal() {
            document.getElementById('participantRegistrationModal').style.display = 'flex';
        }
        
        function closeParticipantModal() {
            document.getElementById('participantRegistrationModal').style.display = 'none';
        }
        
        async function proceedToPretest() {
            const name = document.getElementById('participantName').value.trim();
            const department = document.getElementById('participantDepartment').value;
            
            if (!name) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Nombre Requerido',
                    text: 'Por favor ingresa tu nombre completo',
                    confirmButtonText: 'Entendido'
                });
                return;
            }
            
            if (!department) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Departamento Requerido',
                    text: 'Por favor selecciona tu departamento/servicio',
                    confirmButtonText: 'Entendido'
                });
                return;
            }
            
            // Guardar datos del participante
            currentParticipantData = {
                name: name,
                department: department,
                accessCode: currentAccessCode
            };
            
            // Cerrar modal y cargar pretest
            closeParticipantModal();
            loadAndDisplayPretest();
        }
        
        async function loadAndDisplayPretest() {
            try {
                Swal.fire({
                    title: 'Cargando evaluaci√≥n...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                const trainingId = currentTrainingRecord.id;
                const trainingTitle = currentTrainingRecord.fields['name'] || currentTrainingRecord.fields['T√≠tulo'] || 'Capacitaci√≥n';
                
                console.log(`üîç Buscando preguntas para entrenamiento: ${trainingId} (${trainingTitle})`);
                
                // Obtener TODAS las preguntas primero
                const allQuestionsResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Preguntas`
                    })
                });
                
                const allQuestionsData = await allQuestionsResponse.json();
                
                console.log('üìö Todas las preguntas disponibles:', allQuestionsData.records?.length || 0);
                
                if (!allQuestionsData.success || !allQuestionsData.records) {
                    throw new Error('No se pudieron cargar las preguntas');
                }
                
                // IMPORTANTE: Obtener el trainingId correcto de la sesi√≥n
                console.log('üéì Training ID de la sesi√≥n:', trainingId);
                console.log('üìã Registro de capacitaci√≥n actual:', currentTrainingRecord);
                
                // Filtrar preguntas en JavaScript - m√°s robusto
                const pretestQuestions = allQuestionsData.records.filter(q => {
                    const fields = q.fields;
                    
                    // Obtener el tipo de pregunta (intentar diferentes nombres)
                    const tipo = fields['Tipo Examen'] || fields['Tipo'] || fields['tipo'] || fields['Type'] || '';
                    
                    // Verificar si es pretest (case-insensitive)
                    const isPretest = tipo.toLowerCase() === 'pretest' || tipo.toLowerCase() === 'pre-test' || tipo.toLowerCase() === 'pre test';
                    
                    // Obtener capacitaci√≥n (intentar diferentes nombres)
                    let capacitacionId = null;
                    
                    if (fields['Capacitaci√≥n'] && Array.isArray(fields['Capacitaci√≥n'])) {
                        capacitacionId = fields['Capacitaci√≥n'][0];
                    } else if (fields['Capacitaciones'] && Array.isArray(fields['Capacitaciones'])) {
                        capacitacionId = fields['Capacitaciones'][0];
                    } else if (fields['capacitacion'] && Array.isArray(fields['capacitacion'])) {
                        capacitacionId = fields['capacitacion'][0];
                    } else if (fields['capacitaciones'] && Array.isArray(fields['capacitaciones'])) {
                        capacitacionId = fields['capacitaciones'][0];
                    }
                    
                    const isMatch = isPretest && capacitacionId === trainingId;
                    
                    if (!isMatch) {
                        console.log(`‚úó Pregunta NO match: "${fields['Pregunta'] || 'Sin nombre'}" | Tipo: "${tipo}" | CapID: "${capacitacionId}" vs "${trainingId}"`);
                    }
                    
                    return isMatch;
                });
                
                console.log(`‚úÖ Preguntas de pretest encontradas: ${pretestQuestions.length}`);
                
                Swal.close();
                
                // Mostrar interfaz de pretest
                displayPretestQuestions(pretestQuestions);
                
                // Ocultar secci√≥n de acceso, mostrar pretest
                document.getElementById('accessSection').style.display = 'none';
                document.getElementById('pretestSection').style.display = 'block';
                
                // Actualizar informaci√≥n de capacitaci√≥n
                document.getElementById('currentTrainingTitle').textContent = trainingTitle;
                document.getElementById('currentAccessCode').textContent = currentAccessCode;
                
            } catch (error) {
                console.error('‚ùå Error cargando pretest:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error Cargando Pretest',
                    text: 'No se pudieron cargar las preguntas del pretest: ' + error.message + '\n\nAbre DevTools (F12) para ver detalles'
                });
            }
        }
        
        function displayPretestQuestions(questions) {
            const container = document.getElementById('pretestQuestionsContainer');
            container.innerHTML = '';
            
            if (!questions || questions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; background: #fff3cd; border-radius: 8px; border: 2px solid #ffc107;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #F2FFFA; margin-bottom: 1rem; display: block;"></i>
                        <p style="color: #F2FFFA; margin: 0; font-size: 1.1rem;">
                            <strong>‚ö†Ô∏è No hay preguntas de pretest configuradas</strong>
                        </p>
                        <p style="color: #F2FFFA; margin: 0.5rem 0 0 0; font-size: 0.9rem;">
                            En Airtable, crea preguntas con Tipo = "Pretest" enlazadas a esta capacitaci√≥n
                        </p>
                    </div>
                `;
                return;
            }
            
            questions.forEach((question, index) => {
                const fields = question.fields;
                const questionNumber = index + 1;
                const questionId = `pretest-q${question.id}`;
                
                // Buscar el nombre de la pregunta (intentar diferentes campos)
                const questionText = fields['name'] || fields['Nombre'] || fields['Pregunta'] || fields['T√≠tulo'] || 'Sin pregunta';
                
                // Obtener opciones (intentar variaciones de nombres)
                const options = [
                    { letter: 'A', text: fields['Opci√≥n A'] || fields['opci√≥n a'] || fields['Option A'] || fields['A'] || '' },
                    { letter: 'B', text: fields['Opci√≥n B'] || fields['opci√≥n b'] || fields['Option B'] || fields['B'] || '' },
                    { letter: 'C', text: fields['Opci√≥n C'] || fields['opci√≥n c'] || fields['Option C'] || fields['C'] || '' },
                    { letter: 'D', text: fields['Opci√≥n D'] || fields['opci√≥n d'] || fields['Option D'] || fields['D'] || '' }
                ].filter(opt => opt.text && opt.text.trim());
                
                // Si no hay opciones, intentar b√∫squeda m√°s amplia
                if (options.length === 0) {
                    console.warn(`‚ö†Ô∏è Pregunta ${questionNumber} no tiene opciones configuradas:`, fields);
                }
                
                const questionHTML = `
                    <div class="question-card" style="margin-bottom: 1.5rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--primary);">
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 0.75rem;">
                            <i class="fas fa-question-circle"></i> Pregunta ${questionNumber} / ${questions.length}
                        </h4>
                        <p style="margin: 0 0 1rem 0; font-weight: 500; color: #F2FFFA; font-size: 1.05rem;">
                            ${questionText}
                        </p>
                        
                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            ${options.length > 0 ? options.map(option => `
                                <label style="display: flex; align-items: flex-start; padding: 0.75rem; background: white; border-radius: 6px; cursor: pointer; transition: all 0.3s; border: 2px solid #e0e0e0; hover: border-color: var(--primary);">
                                    <input type="radio" 
                                           name="${questionId}" 
                                           value="${option.letter}" 
                                           onchange="pretestAnswers['${question.id}'] = this.value"
                                           style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary); margin-top: 2px; flex-shrink: 0;">
                                    <span style="margin-left: 0.75rem; flex: 1;">
                                        <strong style="color: var(--primary);">${option.letter})</strong> <span style="color: #F2FFFA;">${option.text}</span>
                                    </span>
                                </label>
                            `).join('') : '<p style="color: #F2FFFA; font-weight: bold;">‚ö†Ô∏è Sin opciones de respuesta</p>'}
                        </div>
                    </div>
                `;
                
                container.innerHTML += questionHTML;
            });
        }
        
        async function submitPretest() {
            const answers = Object.keys(pretestAnswers).length;
            const questionCards = document.querySelectorAll('.question-card');
            const totalQuestions = questionCards.length;
            
            // Validar que se hayan respondido todas las preguntas
            if (answers === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Respuestas Incompletas',
                    text: 'Por favor responde todas las preguntas antes de enviar'
                });
                return;
            }
            
            if (answers < totalQuestions) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Respuestas Incompletas',
                    text: `Has respondido ${answers} de ${totalQuestions} preguntas. Por favor completa todas antes de enviar`
                });
                return;
            }
            
            try {
                Swal.fire({
                    title: 'Enviando Pre-Test...',
                    text: 'Por favor espera mientras guardamos tu evaluaci√≥n',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                console.log('üìù Iniciando proceso de guardado del pretest...');
                console.log('üë§ Participante:', currentParticipantData);
                console.log('üìã Respuestas:', pretestAnswers);
                
                // ==========================================
                // PASO 1: Buscar la sesi√≥n actual
                // ==========================================
                
                const sessionResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Sesiones`
                    })
                });
                
                const sessionData = await sessionResponse.json();
                
                if (!sessionData.success || !sessionData.records) {
                    throw new Error('No se pudieron obtener las sesiones');
                }
                
                // Encontrar la sesi√≥n por c√≥digo de acceso
                const currentSession = sessionData.records.find(s => {
                    const codigo = s.fields['C√≥digo Acceso'] || '';
                    return codigo.toUpperCase() === currentAccessCode.toUpperCase();
                });
                
                if (!currentSession) {
                    throw new Error('No se encontr√≥ la sesi√≥n con c√≥digo: ' + currentAccessCode);
                }
                
                console.log('‚úÖ Sesi√≥n encontrada:', currentSession.id);
                
                // ==========================================
                // PASO 2: Obtener preguntas para calcular score
                // ==========================================
                
                const questionsResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Preguntas`
                    })
                });
                
                const questionsData = await questionsResponse.json();
                
                if (!questionsData.success || !questionsData.records) {
                    throw new Error('No se pudieron obtener las preguntas');
                }
                
                // ==========================================
                // PASO 3: Calcular el score del pretest
                // ==========================================
                
                let correctAnswers = 0;
                let totalAnswered = 0;
                const answersToSave = [];
                
                for (const [questionId, userAnswer] of Object.entries(pretestAnswers)) {
                    // Buscar la pregunta en los registros
                    const question = questionsData.records.find(q => q.id === questionId);
                    
                    if (question) {
                        totalAnswered++;
                        
                        // Obtener la respuesta correcta (intentar diferentes nombres de campo)
                        const correctAnswer = question.fields['Respuesta Correcta'] || 
                                             question.fields['Respuesta correcta'] || 
                                             question.fields['RespuestaCorrecta'] ||
                                             question.fields['Correct Answer'] ||
                                             question.fields['correct_answer'] || '';
                        
                        // Comparar respuestas (case-insensitive)
                        const isCorrect = userAnswer.toUpperCase() === correctAnswer.toUpperCase();
                        
                        if (isCorrect) {
                            correctAnswers++;
                        }
                        
                        console.log(`Pregunta ${questionId}: Usuario=${userAnswer}, Correcta=${correctAnswer}, ‚úì=${isCorrect}`);
                        
                        // Preparar respuesta para guardar
                        answersToSave.push({
                            questionId: questionId,
                            userAnswer: userAnswer,
                            isCorrect: isCorrect
                        });
                    }
                }
                
                // Calcular porcentaje de score (escala de 0 a 100)
                const pretestScore = totalAnswered > 0 
                    ? Math.round((correctAnswers / totalAnswered) * 100) 
                    : 0;
                
                console.log(`üìä Score calculado: ${correctAnswers}/${totalAnswered} = ${pretestScore}%`);
                
                // ==========================================
                // PASO 4: Crear registro de participaci√≥n (LISTA DE ASISTENCIA)
                // ==========================================
                
                // ‚úÖ CORREGIDO: Generar fecha y hora en formato correcto
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                
                // Formato: YYYY-MM-DD HH:mm:ss (compatible con campos Date en Airtable)
                const fechaFormato = `${year}-${month}-${day}`;
                const horaFormato = `${hours}:${minutes}:${seconds}`;
                const fechaHoraCompleta = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                
                const participationData = {
                    fields: {
                        'Nombre': currentParticipantData.name,
                        'Departamento': currentParticipantData.department,
                        'Sesi√≥n': [currentSession.id],
                        'Pretest Score': pretestScore,
                        'Fecha de Inicio': fechaFormato,
                        'Completado Pretest': true
                    }
                };
                
                console.log('üì§ Creando participaci√≥n:', participationData);
                
                const createParticipationResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'POST',
                        path: `/Participaciones`,
                        body: participationData
                    })
                });
                
                const participationResult = await createParticipationResponse.json();
                
                if (!participationResult.success) {
                    console.error('‚ùå Error creando participaci√≥n:', participationResult);
                    throw new Error(participationResult.error || 'No se pudo crear el registro de participaci√≥n');
                }
                
                console.log('‚úÖ Participaci√≥n creada:', participationResult.id);
                
                // ==========================================
                // PASO 5: Guardar respuestas individuales (opcional)
                // ==========================================
                
                const participationId = participationResult.id;
                
                // Guardar cada respuesta en la tabla Respuestas
                for (const answer of answersToSave) {
                    try {
                        const answerData = {
                            fields: {
                                'Participaci√≥n': [participationId],
                                'Pregunta': [answer.questionId],
                                'Respuesta Usuario': answer.userAnswer,
                                'Es Correcta': answer.isCorrect,
                                'Tipo Examen': 'Pretest'
                            }
                        };
                        
                        await fetch('/.netlify/functions/airtable-proxy', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                method: 'POST',
                                path: `/Respuestas`,
                                body: answerData
                            })
                        });
                        
                        console.log(`‚úÖ Respuesta guardada para pregunta: ${answer.questionId}`);
                        
                    } catch (answerError) {
                        console.warn(`‚ö†Ô∏è No se pudo guardar respuesta individual:`, answerError);
                        // Continuar con las dem√°s respuestas aunque una falle
                    }
                }
                
                // ==========================================
                // PASO 6: Mostrar resultado al usuario
                // ==========================================
                
                Swal.close();
                
                // Determinar el mensaje seg√∫n el score
                let scoreMessage = '';
                let scoreIcon = 'success';
                
                if (pretestScore >= 80) {
                    scoreMessage = '¬°Excelente conocimiento previo!';
                } else if (pretestScore >= 60) {
                    scoreMessage = 'Buen nivel de conocimiento';
                } else if (pretestScore >= 40) {
                    scoreMessage = 'Conocimiento b√°sico';
                } else {
                    scoreMessage = 'Esta capacitaci√≥n ser√° muy √∫til para ti';
                    scoreIcon = 'info';
                }
                
                Swal.fire({
                    icon: scoreIcon,
                    title: '¬°Pre-Test Enviado!',
                    html: `
                        <div style="text-align: center;">
                            <div style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%); 
                                        color: #F2FFFA; 
                                        padding: 1.5rem; 
                                        border-radius: 12px; 
                                        margin-bottom: 1rem;">
                                <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">Tu calificaci√≥n</p>
                                <p style="margin: 0.5rem 0; font-size: 2.5rem; font-weight: bold;">${pretestScore}%</p>
                                <p style="margin: 0; font-size: 0.85rem;">${correctAnswers} de ${totalAnswered} correctas</p>
                            </div>
                            
                            <p style="margin: 0.5rem 0;"><strong>${currentParticipantData.name}</strong></p>
                            <p style="margin: 0; color: #F2FFFA; font-size: 0.9rem;">${currentParticipantData.department}</p>
                            <p style="margin: 1rem 0 0 0; color: #F2FFFA; font-size: 0.9rem;">${scoreMessage}</p>
                            <p style="margin: 0.5rem 0 0 0; color: #F2FFFA; font-size: 0.8rem;">
                                Tu asistencia y calificaci√≥n han sido registradas
                            </p>
                        </div>
                    `,
                    confirmButtonText: 'Continuar a la Capacitaci√≥n',
                    showCancelButton: true,
                    cancelButtonText: 'Volver al Inicio',
                    confirmButtonColor: '#2E7D32'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // GUARDAR participationId para uso posterior en postest
                        currentParticipationId = participationResult.id;
                        currentSessionId = currentSession.id;
                        
                        Swal.fire({
                            icon: 'info',
                            title: 'Contenido de Capacitaci√≥n',
                            text: 'El coordinador compartir√° el contenido de la capacitaci√≥n. Una vez finalizado, podr√°s realizar el Post-Test.',
                            confirmButtonText: 'Entendido'
                        }).then(() => {
                            // Mostrar bot√≥n para acceder al postest
                            showPostestButton();
                        });
                    } else {
                        // Volver al inicio
                        cancelTraining();
                    }
                });
                
                console.log('‚úÖ Proceso de pretest completado exitosamente');
                
            } catch (error) {
                console.error('‚ùå Error enviando pretest:', error);
                Swal.close();
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo enviar el pretest: ' + error.message,
                    footer: '<small>Revisa la consola (F12) para m√°s detalles</small>'
                });
            }
        }
        
        // ==================== FUNCIONES DE POSTTEST ====================
        
        function showPostestButton() {
            // Ocultar secci√≥n de pretest
            document.getElementById('pretestSection').style.display = 'none';
            document.getElementById('accessSection').style.display = 'none';
            
            // Mostrar mensaje de espera
            Swal.fire({
                icon: 'info',
                title: 'Esperando acceso al Post-Test',
                html: `
                    <div style="text-align: center; padding: 1rem;">
                        <p style="margin-bottom: 1rem;">¬øYa terminaste la capacitaci√≥n?</p>
                        <button class="btn btn-success" onclick="loadPosttest()" style="width: 100%; padding: 0.75rem; font-size: 1rem; margin-bottom: 0.5rem;">
                            <i class="fas fa-arrow-right"></i> Continuar al Post-Test
                        </button>
                        <button class="btn btn-secondary" onclick="cancelTraining()" style="width: 100%; padding: 0.75rem; font-size: 0.9rem;">
                            <i class="fas fa-times"></i> Salir
                        </button>
                    </div>
                `,
                allowOutsideClick: false,
                showConfirmButton: false
            });
        }
        
        async function loadPosttest() {
            try {
                Swal.close();
                Swal.fire({
                    title: 'Cargando Post-Test...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                // ‚ö†Ô∏è IMPORTANTE: Verificar que tengamos el ID de capacitaci√≥n guardado
                if (!currentTrainingRecord || !currentTrainingRecord.id) {
                    throw new Error('No se encontr√≥ la capacitaci√≥n actual. Por favor vuelve a ingresar el c√≥digo de acceso.');
                }
                
                const trainingId = currentTrainingRecord.id;
                console.log('üéì ID de Capacitaci√≥n para Postest:', trainingId);
                console.log('üìã Registro de capacitaci√≥n:', currentTrainingRecord);
                
                // Obtener TODAS las preguntas
                const questionsResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Preguntas`
                    })
                });
                
                const questionsData = await questionsResponse.json();
                
                if (!questionsData.success || !questionsData.records) {
                    throw new Error('No se pudieron obtener las preguntas del postest');
                }
                
                console.log('üìö Total de preguntas en Airtable:', questionsData.records.length);
                
                // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                // FILTRO CORRECTO: Por tipo Y por capacitaci√≥n
                // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                
                const postestQuestions = questionsData.records.filter(q => {
                    const fields = q.fields;
                    
                    // 1. Obtener el tipo de examen
                    const tipoExamen = (fields['Tipo Examen'] || fields['Tipo'] || '').toLowerCase().trim();
                    
                    // 2. Verificar que sea postest
                    const esPosttest = tipoExamen === 'postest' || 
                                      tipoExamen === 'posttest' || 
                                      tipoExamen === 'post-test';
                    
                    // 3. Obtener el ID de capacitaci√≥n vinculado
                    let capacitacionId = null;
                    
                    if (fields['Capacitaci√≥n'] && Array.isArray(fields['Capacitaci√≥n'])) {
                        capacitacionId = fields['Capacitaci√≥n'][0];
                    } else if (fields['Capacitaciones'] && Array.isArray(fields['Capacitaciones'])) {
                        capacitacionId = fields['Capacitaciones'][0];
                    }
                    
                    // 4. Verificar que coincida con la capacitaci√≥n actual
                    const perteneceACapacitacion = capacitacionId === trainingId;
                    
                    // Log de debug
                    if (esPosttest) {
                        console.log(`üìù Pregunta Postest encontrada:`);
                        console.log(`   Texto: "${fields['Pregunta']?.substring(0, 50)}..."`);
                        console.log(`   Tipo: "${tipoExamen}"`);
                        console.log(`   Cap ID: "${capacitacionId}"`);
                        console.log(`   Match: ${perteneceACapacitacion ? '‚úÖ' : '‚ùå'} (buscando: ${trainingId})`);
                    }
                    
                    // RETORNAR TRUE solo si cumple AMBAS condiciones
                    return esPosttest && perteneceACapacitacion;
                });
                
                console.log('‚úÖ Preguntas de postest filtradas:', postestQuestions.length);
                console.log('üìã IDs de preguntas:', postestQuestions.map(p => p.id));
                
                // Verificar que haya preguntas
                if (postestQuestions.length === 0) {
                    console.error('‚ùå NO HAY PREGUNTAS DE POSTEST PARA ESTA CAPACITACI√ìN');
                    console.error('   Capacitaci√≥n ID:', trainingId);
                    console.error('   Capacitaci√≥n Nombre:', currentTrainingRecord.fields['T√≠tulo'] || currentTrainingRecord.fields['name']);
                    
                    throw new Error(
                        `No hay preguntas de postest configuradas para "${currentTrainingRecord.fields['T√≠tulo'] || 'esta capacitaci√≥n'}".\n\n` +
                        `Verifica en Airtable que:\n` +
                        `1. Existan preguntas con Tipo = "Postest"\n` +
                        `2. Est√©n vinculadas a la capacitaci√≥n correcta (ID: ${trainingId})`
                    );
                }
                
                console.log(`‚úÖ Usando ${postestQuestions.length} preguntas de postest`);
                
                // Limpiar respuestas anteriores
                postestAnswers = {};
                
                // Mostrar interfaz de postest
                displayPosttestQuestions(postestQuestions);
                
                // Ocultar modal y mostrar secci√≥n de postest
                Swal.close();
                document.getElementById('postestSection').style.display = 'block';
                document.getElementById('accessSection').style.display = 'none';
                document.getElementById('pretestSection').style.display = 'none';
                
            } catch (error) {
                console.error('‚ùå Error cargando postest:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo cargar el postest: ' + error.message
                }).then(() => {
                    showPostestButton();
                });
            }
        }
        
        function displayPosttestQuestions(questions) {
            const container = document.getElementById('postestQuestionsContainer');
            container.innerHTML = '';
            
            if (!questions || questions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; background: #fff3cd; border-radius: 8px; border: 2px solid #ffc107;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: #F2FFFA; margin-bottom: 1rem; display: block;"></i>
                        <p style="color: #F2FFFA; margin: 0; font-size: 1.1rem;">
                            <strong>‚ö†Ô∏è No hay preguntas de postest configuradas</strong>
                        </p>
                        <p style="color: #F2FFFA; margin: 0.5rem 0 0 0; font-size: 0.9rem;">
                            En Airtable, crea preguntas con Tipo = "Postest" enlazadas a esta capacitaci√≥n
                        </p>
                    </div>
                `;
                return;
            }
            
            questions.forEach((question, index) => {
                const fields = question.fields;
                const questionNumber = index + 1;
                const questionId = `postest-q${question.id}`;
                
                // Buscar el nombre de la pregunta (intentar diferentes campos)
                const questionText = fields['name'] || fields['Nombre'] || fields['Pregunta'] || fields['T√≠tulo'] || 'Sin pregunta';
                
                // Obtener opciones (intentar variaciones de nombres)
                const options = [
                    { letter: 'A', text: fields['Opci√≥n A'] || fields['opci√≥n a'] || fields['Option A'] || fields['A'] || '' },
                    { letter: 'B', text: fields['Opci√≥n B'] || fields['opci√≥n b'] || fields['Option B'] || fields['B'] || '' },
                    { letter: 'C', text: fields['Opci√≥n C'] || fields['opci√≥n c'] || fields['Option C'] || fields['C'] || '' },
                    { letter: 'D', text: fields['Opci√≥n D'] || fields['opci√≥n d'] || fields['Option D'] || fields['D'] || '' }
                ].filter(opt => opt.text && opt.text.trim());
                
                // Si no hay opciones, intentar b√∫squeda m√°s amplia
                if (options.length === 0) {
                    console.warn(`‚ö†Ô∏è Pregunta ${questionNumber} no tiene opciones configuradas:`, fields);
                }
                
                const questionHTML = `
                    <div class="question-card" style="margin-bottom: 1.5rem; padding: 1.5rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--primary);">
                        <h4 style="margin-top: 0; color: var(--primary); margin-bottom: 0.75rem;">
                            <i class="fas fa-question-circle"></i> Pregunta ${questionNumber} / ${questions.length}
                        </h4>
                        <p style="margin: 0 0 1rem 0; font-weight: 500; color: #F2FFFA; font-size: 1.05rem;">
                            ${questionText}
                        </p>
                        
                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            ${options.length > 0 ? options.map(option => `
                                <label style="display: flex; align-items: flex-start; padding: 0.75rem; background: white; border-radius: 6px; cursor: pointer; transition: all 0.3s; border: 2px solid #e0e0e0; hover: border-color: var(--primary);">
                                    <input type="radio" 
                                           name="${questionId}" 
                                           value="${option.letter}" 
                                           onchange="postestAnswers['${question.id}'] = this.value"
                                           style="width: 20px; height: 20px; cursor: pointer; accent-color: var(--primary); margin-top: 2px; flex-shrink: 0;">
                                    <span style="margin-left: 0.75rem; flex: 1;">
                                        <strong style="color: var(--primary);">${option.letter})</strong> <span style="color: #F2FFFA;">${option.text}</span>
                                    </span>
                                </label>
                            `).join('') : '<p style="color: #F2FFFA; font-weight: bold;">‚ö†Ô∏è Sin opciones de respuesta</p>'}
                        </div>
                    </div>
                `;
                
                container.innerHTML += questionHTML;
            });
        }
        
        async function submitPosttest() {
            const answers = Object.keys(postestAnswers).length;
            const questionCards = document.querySelectorAll('#postestSection .question-card');
            const totalQuestions = questionCards.length;
            
            // Validar que se hayan respondido todas las preguntas
            if (answers === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Respuestas Incompletas',
                    text: 'Por favor responde todas las preguntas antes de enviar'
                });
                return;
            }
            
            if (answers < totalQuestions) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Respuestas Incompletas',
                    text: `Has respondido ${answers} de ${totalQuestions} preguntas. Por favor completa todas antes de enviar`
                });
                return;
            }
            
            try {
                Swal.fire({
                    title: 'Enviando Post-Test...',
                    text: 'Por favor espera mientras guardamos tu evaluaci√≥n',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                console.log('üìù Iniciando proceso de guardado del postest...');
                console.log('üë§ Participante:', currentParticipantData);
                console.log('üìã Respuestas:', postestAnswers);
                
                // ==========================================
                // PASO 1: Obtener preguntas para calcular score
                // ==========================================
                
                const questionsResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Preguntas`
                    })
                });
                
                const questionsData = await questionsResponse.json();
                
                if (!questionsData.success || !questionsData.records) {
                    throw new Error('No se pudieron obtener las preguntas');
                }
                
                // ==========================================
                // PASO 2: Calcular el score del postest
                // ==========================================
                
                let correctAnswers = 0;
                let totalAnswered = 0;
                const answersToSave = [];
                
                for (const [questionId, userAnswer] of Object.entries(postestAnswers)) {
                    const question = questionsData.records.find(q => q.id === questionId);
                    
                    if (question) {
                        totalAnswered++;
                        
                        const correctAnswer = question.fields['Respuesta Correcta'] || 
                                             question.fields['Respuesta correcta'] || 
                                             question.fields['RespuestaCorrecta'] ||
                                             question.fields['Correct Answer'] ||
                                             question.fields['correct_answer'] || '';
                        
                        const isCorrect = userAnswer.toUpperCase() === correctAnswer.toUpperCase();
                        
                        if (isCorrect) {
                            correctAnswers++;
                        }
                        
                        console.log(`Pregunta ${questionId}: Usuario=${userAnswer}, Correcta=${correctAnswer}, ‚úì=${isCorrect}`);
                        
                        answersToSave.push({
                            questionId: questionId,
                            userAnswer: userAnswer,
                            isCorrect: isCorrect
                        });
                    }
                }
                
                const postestScore = totalAnswered > 0 
                    ? Math.round((correctAnswers / totalAnswered) * 100) 
                    : 0;
                
                console.log(`üìä Score calculado: ${correctAnswers}/${totalAnswered} = ${postestScore}%`);
                
                // ==========================================
                // PASO 3: Actualizar registro de participaci√≥n
                // ==========================================
                
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                
                const fechaFormato = `${year}-${month}-${day}`;
                const horaFormato = `${hours}:${minutes}:${seconds}`;
                const fechaHoraCompleta = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                
                const updateParticipationResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'PATCH',
                        path: `/Participaciones/${currentParticipationId}`,
                        body: {
                            fields: {
                                'Post-test Score': postestScore,
                                'Fecha Fin': fechaFormato
                            }
                        }
                    })
                });
                
                const updateParticipationData = await updateParticipationResponse.json();
                
                if (!updateParticipationData.success) {
                    console.error('‚ùå Error actualizando participaci√≥n:', updateParticipationData);
                    throw new Error(updateParticipationData.error || 'No se pudo actualizar el registro');
                }
                
                console.log('‚úÖ Participaci√≥n actualizada:', currentParticipationId);
                
                // ==========================================
                // PASO 4: Guardar respuestas individuales
                // ==========================================
                
                for (const answer of answersToSave) {
                    try {
                        const answerData = {
                            fields: {
                                'Participaci√≥n': [currentParticipationId],
                                'Pregunta': [answer.questionId],
                                'Respuesta Usuario': answer.userAnswer,
                                'Es Correcta': answer.isCorrect,
                                'Tipo Examen': 'Posttest'
                            }
                        };
                        
                        await fetch('/.netlify/functions/airtable-proxy', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                method: 'POST',
                                path: `/Respuestas`,
                                body: answerData
                            })
                        });
                        
                        console.log(`‚úÖ Respuesta guardada para pregunta: ${answer.questionId}`);
                        
                    } catch (answerError) {
                        console.warn(`‚ö†Ô∏è No se pudo guardar respuesta individual:`, answerError);
                    }
                }
                
                // ==========================================
                // PASO 5: Mostrar resultado al usuario
                // ==========================================
                
                Swal.close();
                
                let scoreMessage = '';
                let scoreIcon = 'success';
                let congratsMessage = '¬°Felicidades!';
                
                if (postestScore >= 80) {
                    scoreMessage = '¬°Excelente desempe√±o!';
                    congratsMessage = '¬°Demostraste un excelente dominio del tema!';
                } else if (postestScore >= 60) {
                    scoreMessage = 'Buen desempe√±o';
                    congratsMessage = '¬°Aplicaste muy bien lo aprendido!';
                } else if (postestScore >= 40) {
                    scoreMessage = 'Desempe√±o regular';
                    congratsMessage = 'Contin√∫a practicando para mejorar';
                } else {
                    scoreMessage = 'Es momento de reforzar el aprendizaje';
                    scoreIcon = 'warning';
                    congratsMessage = 'Te recomendamos revisar el contenido nuevamente';
                }
                
                Swal.fire({
                    icon: scoreIcon,
                    title: congratsMessage,
                    html: `
                        <div style="text-align: center;">
                            <div style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%); 
                                        color: #F2FFFA; 
                                        padding: 1.5rem; 
                                        border-radius: 12px; 
                                        margin-bottom: 1rem;">
                                <p style="margin: 0; font-size: 0.9rem; opacity: 0.9;">Tu calificaci√≥n en Post-Test</p>
                                <p style="margin: 0.5rem 0; font-size: 2.5rem; font-weight: bold;">${postestScore}%</p>
                                <p style="margin: 0; font-size: 0.85rem;">${correctAnswers} de ${totalAnswered} correctas</p>
                            </div>
                            
                            <p style="margin: 0.5rem 0;"><strong>${currentParticipantData.name}</strong></p>
                            <p style="margin: 0; color: #F2FFFA; font-size: 0.9rem;">${currentParticipantData.department}</p>
                            <p style="margin: 1rem 0 0 0; color: #F2FFFA; font-size: 0.9rem;">${scoreMessage}</p>
                            <p style="margin: 0.5rem 0 0 0; color: #F2FFFA; font-size: 0.8rem;">
                                Tu evaluaci√≥n ha sido completada y registrada
                            </p>
                        </div>
                    `,
                    confirmButtonText: 'Volver al Inicio',
                    confirmButtonColor: '#2E7D32',
                    allowOutsideClick: false
                }).then(() => {
                    cancelTraining();
                });
                
                console.log('‚úÖ Proceso de postest completado exitosamente');
                
            } catch (error) {
                console.error('‚ùå Error enviando postest:', error);
                Swal.close();
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo enviar el postest: ' + error.message,
                    footer: '<small>Revisa la consola (F12) para m√°s detalles</small>'
                });
            }
        }
        
        function cancelTraining() {
            // Limpiar datos
            currentAccessCode = null;
            currentTrainingRecord = null;
            currentParticipantData = {};
            pretestAnswers = {};
            postestAnswers = {};
            currentParticipationId = null;
            currentSessionId = null;
            postestCode = null;
            
            // Limpiar formulario
            document.getElementById('accessCode').value = '';
            document.getElementById('participantName').value = '';
            document.getElementById('participantDepartment').value = '';
            
            // Mostrar/ocultar secciones
            document.getElementById('accessSection').style.display = 'block';
            document.getElementById('pretestSection').style.display = 'none';
            document.getElementById('postestSection').style.display = 'none';
        }


        // ==================== INICIALIZACI√ìN ====================
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateDateTime();
            setInterval(updateDateTime, 1000);
        });

        // ==================== BLOQUEO POR CONTRASE√ëA (ADMIN) ====================
        // üîí La contrase√±a se lee desde Airtable (tabla AppConfig) mediante una Netlify Function.
        // ‚úÖ Se omite el bloqueo cuando el usuario entra por QR con ?code=... (flujo participante).

        const ADMIN_AUTH_STORAGE_KEY = 'HSLV_ADMIN_AUTH_V1';
        const ADMIN_AUTH_TTL_HOURS = 0; // NO USAR - La contrase√±a NUNCA se guarda

        function isParticipantFlow() {
            const urlParams = new URLSearchParams(window.location.search);
            return !!urlParams.get('code'); // QR / postest siempre trae "code"
        }

        function getStoredAdminAuth() {
            // ‚ö†Ô∏è SEGURIDAD: NUNCA cargamos sesi√≥n previa
            // La contrase√±a SIEMPRE debe ser ingresada
            return null;
        }

        function setStoredAdminAuth() {
            // ‚ö†Ô∏è SEGURIDAD: NUNCA guardamos la contrase√±a
            // Esta funci√≥n no hace nada intencionalmente
            // Cada acceso requiere ingresar la contrase√±a nuevamente
            console.log('‚úÖ Contrase√±a validada para esta sesi√≥n (no se almacena)');
        }

        async function validateAdminPassword(password) {
            const res = await fetch('/.netlify/functions/validate-app-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password })
            });
            const data = await res.json().catch(() => ({}));
            if (!res.ok || !data.success) {
                const msg = data?.error || 'Contrase√±a incorrecta';
                throw new Error(msg);
            }
            return true;
        }

        async function enforceAdminPassword() {
            // ‚ö†Ô∏è SEGURIDAD: Siempre pedir contrase√±a, nunca usar sesi√≥n previa
            // Limpiar cualquier dato de autenticaci√≥n guardado
            try {
                localStorage.removeItem(ADMIN_AUTH_STORAGE_KEY);
            } catch (e) {
                // No hacer nada si localStorage no est√° disponible
            }

            // Pedir contrase√±a hasta que sea correcta
            console.log('üîê SEGURIDAD: Pidiendo contrase√±a administrativa...');
            while (true) {
                const result = await Swal.fire({
                    title: 'üîê Acceso Administrativo',
                    text: 'Ingresa la contrase√±a para administrar el sistema\n(Se pide cada vez que accedes)',
                    input: 'password',
                    inputPlaceholder: 'Contrase√±a',
                    inputAttributes: {
                        autocapitalize: 'off',
                        autocomplete: 'off' // No autocompletar para mayor seguridad
                    },
                    confirmButtonText: 'Ingresar',
                    showCancelButton: false,
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    showLoaderOnConfirm: true,
                    preConfirm: async (pwd) => {
                        if (!pwd || String(pwd).trim().length < 6) {
                            Swal.showValidationMessage('Ingresa una contrase√±a v√°lida');
                            return false;
                        }
                        try {
                            await validateAdminPassword(String(pwd));
                            return true;
                        } catch (e) {
                            Swal.showValidationMessage(e.message || 'Contrase√±a incorrecta');
                            return false;
                        }
                    }
                });

                if (result.isConfirmed) {
                    setStoredAdminAuth(); // No hace nada (por seguridad)
                    console.log('‚úÖ Autenticado - Contrase√±a NO guardada');
                    document.body.classList.add('authenticated');
                    return true;
                }
            }
        }

        function startAdminApp() {
            // Inicializar gr√°ficos y dashboard (ahora SOLO despu√©s de autenticar)
            setTimeout(() => initializeCharts(), 200);
            setTimeout(() => loadDashboardStats(), 600);
            setTimeout(() => loadTrainings(), 600);
        }
        

        async function initializeApp() {
            // Mantener splash / pantalla de inicio
            setTimeout(() => {
                document.getElementById('loadingScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                }, 250);
            }, 5000);

            // Si viene por QR (participante), NO pedir contrase√±a
            if (isParticipantFlow()) {
                checkForAccessCode();
                return;
            }

            // Esperar a que se oculte la pantalla de inicio antes de pedir contrase√±a
            await new Promise(resolve => setTimeout(resolve, 5200));

            // Pedir contrase√±a (guardada en Airtable)
            await enforceAdminPassword();

            // Cargar el modo administrador
            startAdminApp();

            // (Por si en el futuro agregas otros par√°metros)
            checkForAccessCode();
        }
        
        function checkForAccessCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const code = urlParams.get('code');
            const auto = urlParams.get('auto'); // Par√°metro para crear sesi√≥n autom√°ticamente
            
            if (code) {
                setTimeout(() => {
                    // Si tiene par√°metro auto=true, intentar crear sesi√≥n autom√°ticamente
                    if (auto === 'true') {
                        createSessionAutomatically(code);
                    } else {
                        // Comportamiento normal: solo auto-llenar el c√≥digo
                        document.getElementById('accessCode').value = code;
                        switchTab('exam');
                    }
                }, 1000);
            }
        }

        // ==================== NUEVA FUNCI√ìN: CREAR SESI√ìN AUTOM√ÅTICAMENTE ====================
        
        async function createSessionAutomatically(code) {
            try {
                Swal.fire({
                    title: 'Preparando capacitaci√≥n...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });

                console.log(`üì± Intentando crear sesi√≥n autom√°ticamente para c√≥digo: ${code}`);

                // Paso 1: Obtener la primera capacitaci√≥n disponible
                const trainingResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Capacitaciones?maxRecords=1`
                    })
                });

                const trainingData = await trainingResponse.json();

                if (!trainingData.success || !trainingData.records || trainingData.records.length === 0) {
                    throw new Error('No hay capacitaciones disponibles en el sistema');
                }

                const trainingId = trainingData.records[0].id;
                console.log(`üéì Capacitaci√≥n encontrada: ${trainingId}`);

                // Paso 2: Llamar a la funci√≥n serverless para crear sesi√≥n
                const createResponse = await fetch('/.netlify/functions/create-session', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        code: code,
                        trainingId: trainingId
                    })
                });

                const createData = await createResponse.json();

                console.log(`üìù Respuesta del servidor:`, createData);

                if (!createData.success) {
                    throw new Error(createData.error || 'No se pudo crear la sesi√≥n');
                }

                Swal.close();

                // Mostrar mensaje de √©xito
                Swal.fire({
                    icon: 'success',
                    title: '¬°Sesi√≥n Creada!',
                    text: `La sesi√≥n con c√≥digo ${code} ha sido creada autom√°ticamente`,
                    timer: 2000,
                    showConfirmButton: false
                }).then(() => {
                    // Proceder con el flujo normal
                    document.getElementById('accessCode').value = code;
                    switchTab('exam');
                    
                    // Esperar a que se vea el input actualizado
                    setTimeout(() => {
                        validateAndStartTraining();
                    }, 500);
                });

            } catch (error) {
                console.error('‚ùå Error creando sesi√≥n autom√°ticamente:', error);
                Swal.close();
                
                Swal.fire({
                    icon: 'warning',
                    title: 'Crear Sesi√≥n Manualmente',
                    text: 'La sesi√≥n no pudo crearse autom√°ticamente.\n\n' + error.message + '\n\nPor favor, ingresa el c√≥digo manualmente o contacta al coordinador.',
                    confirmButtonText: 'Continuar'
                }).then(() => {
                    // Volver a flujo manual
                    document.getElementById('accessCode').value = code;
                    switchTab('exam');
                });
            }
        }

        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const element = document.getElementById('currentDateTime');
            if (element) {
                element.textContent = now.toLocaleDateString('es-ES', options);
            }
        }

        function switchTab(tabName, event = null) {
            // Mostrar/ocultar tabs
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(btn => btn.classList.remove('active'));

            const selectedTab = document.getElementById(tabName);
            if (selectedTab) selectedTab.classList.add('active');

            // Marcar el bot√≥n activo (no depende de data-tab ni de que el onclick pase event)
            const resolvedEvent = event || (typeof window !== 'undefined' ? window.event : null);

            let navTab = null;
            if (resolvedEvent && resolvedEvent.target) {
                navTab = resolvedEvent.target.closest('.nav-tab');
            }

            if (!navTab) {
                navTab = Array.from(document.querySelectorAll('.nav-tab'))
                    .find(btn => (btn.getAttribute('onclick') || '').includes(`switchTab('${tabName}'`));
            }

            if (navTab) navTab.classList.add('active');

            // Al entrar a Reportes, cargar el combo de capacitaciones
            if (tabName === 'reports' && typeof loadReportOptions === 'function') {
                loadReportOptions();
            }

            // Al entrar a Cronograma, inicializar valores por defecto
            if (tabName === 'schedule' && typeof initScheduleTab === 'function') {
                initScheduleTab();
            }
        }

        // ==================== FUNCIONES DE PREGUNTAS ====================
        
        function addQuestion(type) {
            const container = document.getElementById(`${type}Questions`);
            const currentCount = type === 'pretest' ? pretestQuestionCount : postestQuestionCount;
            
            if (currentCount >= MAX_QUESTIONS) {
                Swal.fire({
                    icon: 'warning',
                    title: 'L√≠mite Alcanzado',
                    text: `Solo puedes agregar hasta ${MAX_QUESTIONS} preguntas por test`,
                    confirmButtonText: 'Entendido'
                });
                return;
            }
            
            if (type === 'pretest') {
                pretestQuestionCount++;
            } else {
                postestQuestionCount++;
            }
            
            const questionNumber = currentCount + 1;
            const questionId = `${type}-q${questionNumber}`;
            
            const questionHTML = `
                <div class="question-card" id="${questionId}" data-question-number="${questionNumber}">
                    <div class="question-header">
                        <h4>üìù Pregunta ${questionNumber}</h4>
                        <button type="button" class="btn-remove" onclick="removeQuestion('${questionId}', '${type}')">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-question"></i> Pregunta *</label>
                        <textarea id="${questionId}-text" class="question-text" rows="2" required 
                                  placeholder="Escriba la pregunta aqu√≠..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-list"></i> Opciones de Respuesta</label>
                        <div class="options-container">
                            <div class="option-item">
                                <input type="radio" name="${questionId}-correct" value="a" id="${questionId}-option-a" required>
                                <label for="${questionId}-option-a" class="radio-label">‚úì Correcta</label>
                                <input type="text" id="${questionId}-text-a" class="option-text" placeholder="Opci√≥n A" required>
                            </div>
                            
                            <div class="option-item">
                                <input type="radio" name="${questionId}-correct" value="b" id="${questionId}-option-b">
                                <label for="${questionId}-option-b" class="radio-label">‚úì Correcta</label>
                                <input type="text" id="${questionId}-text-b" class="option-text" placeholder="Opci√≥n B" required>
                            </div>
                            
                            <div class="option-item">
                                <input type="radio" name="${questionId}-correct" value="c" id="${questionId}-option-c">
                                <label for="${questionId}-option-c" class="radio-label">‚úì Correcta</label>
                                <input type="text" id="${questionId}-text-c" class="option-text" placeholder="Opci√≥n C" required>
                            </div>
                            
                            <div class="option-item">
                                <input type="radio" name="${questionId}-correct" value="d" id="${questionId}-option-d">
                                <label for="${questionId}-option-d" class="radio-label">‚úì Correcta</label>
                                <input type="text" id="${questionId}-text-d" class="option-text" placeholder="Opci√≥n D" required>
                            </div>
                        </div>
                        <small class="help-text">Marca la opci√≥n correcta</small>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', questionHTML);
            updateQuestionCounter(type);
            
            // Animaci√≥n
            const newQuestion = document.getElementById(questionId);
            newQuestion.style.opacity = '0';
            setTimeout(() => {
                newQuestion.style.transition = 'opacity 0.3s';
                newQuestion.style.opacity = '1';
            }, 10);
        }

        function removeQuestion(questionId, type) {
            Swal.fire({
                title: '¬øEliminar pregunta?',
                text: 'Esta acci√≥n no se puede deshacer',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'S√≠, eliminar',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.isConfirmed) {
                    const element = document.getElementById(questionId);
                    if (element) {
                        element.style.transition = 'opacity 0.3s';
                        element.style.opacity = '0';
                        
                        setTimeout(() => {
                            element.remove();
                            
                            if (type === 'pretest') {
                                pretestQuestionCount--;
                            } else {
                                postestQuestionCount--;
                            }
                            
                            renumberQuestions(type);
                            updateQuestionCounter(type);
                        }, 300);
                    }
                }
            });
        }

        function renumberQuestions(type) {
            const container = document.getElementById(`${type}Questions`);
            const questions = container.querySelectorAll('.question-card');
            
            questions.forEach((question, index) => {
                const newNumber = index + 1;
                const header = question.querySelector('h4');
                if (header) {
                    header.textContent = `üìù Pregunta ${newNumber}`;
                }
                question.setAttribute('data-question-number', newNumber);
            });
        }

        function updateQuestionCounter(type) {
            const container = document.getElementById(`${type}Questions`);
            const count = type === 'pretest' ? pretestQuestionCount : postestQuestionCount;
            
            let counter = container.parentElement.querySelector('.question-counter');
            if (!counter) {
                counter = document.createElement('div');
                counter.className = 'question-counter';
                container.parentElement.insertBefore(counter, container);
            }
            
            counter.innerHTML = `
                <i class="fas fa-list-ol"></i> 
                <span>${count} de ${MAX_QUESTIONS} preguntas agregadas</span>
            `;
        }

        function collectQuestions(type) {
            const container = document.getElementById(`${type}Questions`);
            const questionCards = container.querySelectorAll('.question-card');
            const questions = [];
            
            for (let i = 0; i < questionCards.length; i++) {
                const card = questionCards[i];
                const questionId = card.id;
                
                const questionText = document.getElementById(`${questionId}-text`).value.trim();
                if (!questionText) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Pregunta Vac√≠a',
                        text: `Complete la pregunta ${i + 1} del ${type === 'pretest' ? 'Pretest' : 'Post-test'}`,
                    });
                    return null;
                }
                
                const options = {
                    a: document.getElementById(`${questionId}-text-a`).value.trim(),
                    b: document.getElementById(`${questionId}-text-b`).value.trim(),
                    c: document.getElementById(`${questionId}-text-c`).value.trim(),
                    d: document.getElementById(`${questionId}-text-d`).value.trim()
                };
                
                if (!options.a || !options.b || !options.c || !options.d) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Opciones Incompletas',
                        text: `Complete todas las opciones de la pregunta ${i + 1}`,
                    });
                    return null;
                }
                
                const correctAnswer = document.querySelector(`input[name="${questionId}-correct"]:checked`);
                if (!correctAnswer) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Respuesta Correcta',
                        text: `Seleccione la respuesta correcta para la pregunta ${i + 1}`,
                    });
                    return null;
                }
                
                questions.push({
                    number: i + 1,
                    question: questionText,
                    options: options,
                    correctAnswer: correctAnswer.value
                });
            }
            
            return questions;
        }
// Lee SOLO el personal marcado en "Personal Capacitado"
function getSelectedStaff() {
  // Busca checkboxes marcados dentro del contenedor de personal
  const checks = document.querySelectorAll('#trainingStaffContainer input.trainingStaff:checked');
  // Devuelve un array de valores limpios
  return Array.from(checks)
    .map(cb => (cb.value || '').trim())
    .filter(Boolean);
}

        async function saveTraining() {
    const titleInput = document.getElementById('trainingTitle');
    const descInput = document.getElementById('trainingDescription');
    const dateInput = document.getElementById('trainingDate');
    const deptInput = document.getElementById('trainingDepartment');
    const durationInput = document.getElementById('trainingDuration');

    const title = titleInput ? titleInput.value.trim() : '';
    const description = descInput ? descInput.value.trim() : '';
    const trainingDate = dateInput ? dateInput.value : '';
    const department = deptInput ? deptInput.value : '';
    const duration = durationInput ? durationInput.value : '';

    // Solo el personal marcado (checkboxes)
    const selectedStaff = getSelectedStaff();

    if (!title || !description || !trainingDate || !department || !duration || selectedStaff.length === 0) {
        let missingMsg = 'Por favor completa todos los campos requeridos (*)';
        if (selectedStaff.length === 0) {
            missingMsg += ' y marca al menos una casilla en "Personal Capacitado".';
        }
        Swal.fire({ icon: 'warning', title: 'Campos Incompletos', text: missingMsg });
        if (titleInput) titleInput.scrollIntoView({ behavior: 'smooth' });
        return;
    }

    // NUEVO: Recopilar preguntas del pretest y postest
    const pretestQuestions = collectQuestions('pretest');
    const postestQuestions = collectQuestions('postest');
    
    // Validar que hay al menos algunas preguntas
    if (!pretestQuestions || pretestQuestions.length === 0) {
        Swal.fire({
            icon: 'warning',
            title: 'Sin Preguntas de Pretest',
            text: 'Debes agregar al menos una pregunta al pretest',
            confirmButtonText: 'Entendido'
        });
        document.getElementById('pretestQuestions').scrollIntoView({ behavior: 'smooth' });
        return;
    }

    if (!postestQuestions || postestQuestions.length === 0) {
        Swal.fire({
            icon: 'warning',
            title: 'Sin Preguntas de Postest',
            text: 'Debes agregar al menos una pregunta al post-test',
            confirmButtonText: 'Entendido'
        });
        document.getElementById('postestQuestions').scrollIntoView({ behavior: 'smooth' });
        return;
    }

    const accessCode = generateAccessCode();
    const createdAtISO = new Date().toISOString();

    const trainingData = {
        title,
        description,
        trainingDate,
        department,
        duration,
        staffList: selectedStaff,
        accessCode,
        status: 'active',
        createdAtISO,
        pretestQuestions: pretestQuestions,
        postestQuestions: postestQuestions
    };

    // Mostrar indicador de carga
    Swal.fire({
        title: 'Guardando Capacitaci√≥n...',
        html: 'Por favor espera mientras se guarda la capacitaci√≥n y las preguntas',
        allowOutsideClick: false,
        didOpen: () => {
            Swal.showLoading();
        }
    });

    // PASO 1: Guardar la capacitaci√≥n
    const trainingResult = await sendTrainingToAirtable(trainingData);
    
    if (!trainingResult || !trainingResult.id) {
        Swal.fire({
            icon: 'error',
            title: 'Error al Guardar',
            text: 'No se pudo guardar la capacitaci√≥n en Airtable. Verifica la conexi√≥n y los campos.'
        });
        return;
    }

    console.log('‚úÖ Capacitaci√≥n guardada con ID:', trainingResult.id);

    // PASO 2: Guardar preguntas del pretest
    const pretestSaved = await saveQuestionsToAirtable(
        pretestQuestions, 
        trainingResult.id, 
        'pretest'
    );

    // PASO 3: Guardar preguntas del postest
    const postestSaved = await saveQuestionsToAirtable(
        postestQuestions, 
        trainingResult.id, 
        'postest'
    );

    // Respaldo local
    const trainings = JSON.parse(localStorage.getItem('trainings') || '[]');
    trainings.push(trainingData);
    localStorage.setItem('trainings', JSON.stringify(trainings));

    // Limpiar formulario
    if (titleInput) titleInput.value = '';
    if (descInput) descInput.value = '';
    if (dateInput) dateInput.value = '';
    if (deptInput) deptInput.value = '';
    if (durationInput) durationInput.value = '';
    document.querySelectorAll('input.trainingStaff:checked, .trainingStaff:checked, input[name="personalCapacitado[]"]:checked')
        .forEach(cb => cb.checked = false);
    
    // Limpiar preguntas
    document.getElementById('pretestQuestions').innerHTML = '';
    document.getElementById('postestQuestions').innerHTML = '';
    pretestQuestionCount = 0;
    postestQuestionCount = 0;
    document.querySelectorAll('.question-counter').forEach(c => c.remove());

    // Mensaje final
    Swal.fire({
        icon: 'success',
        title: '¬°Capacitaci√≥n Guardada!',
        html: `
            <div style="margin: 20px 0;">
                <p>C√≥digo de Acceso:</p>
                <h2 style="color: #F2FFFA; margin: 10px 0;">${accessCode}</h2>
                <p style="font-size: 0.9em; color: #F2FFFA;">Comparte este c√≥digo con los participantes</p>
                <hr style="margin: 15px 0;">
                <p style="font-size: 0.85em;">
                    ‚úÖ Capacitaci√≥n guardada en Airtable<br>
                    ${pretestSaved ? '‚úÖ' : '‚ö†Ô∏è'} ${pretestQuestions.length} preguntas de pretest ${pretestSaved ? 'guardadas' : 'con error'}<br>
                    ${postestSaved ? '‚úÖ' : '‚ö†Ô∏è'} ${postestQuestions.length} preguntas de postest ${postestSaved ? 'guardadas' : 'con error'}
                </p>
            </div>
        `,
        confirmButtonText: 'Generar QR',
        showCancelButton: true,
        cancelButtonText: 'Cerrar'
    }).then((result) => {
        if (result.isConfirmed) {
            showQRCode(accessCode, title);
        }
    });

    if (typeof renderTrainingsList === 'function') {
        renderTrainingsList();
    }
}

// Env√≠a la capacitaci√≥n a Airtable a trav√©s del proxy Netlify
async function sendTrainingToAirtable(trainingData) {
    try {
        console.log('üì§ Enviando capacitaci√≥n a Airtable...');
        console.log('Datos originales:', trainingData);

        // Usar solo los campos que existen en Airtable
        const airtableRecord = {
            fields: {
                "T√≠tulo": trainingData.title,
                "Descripci√≥n": trainingData.description,
                "Fecha": trainingData.trainingDate,
                "Departamento": trainingData.department,
                "Duraci√≥n": trainingData.duration,
                "C√≥digo de Acceso": trainingData.accessCode,
                "Estado": trainingData.status
                // Campos "Personal" y "Creado En" omitidos (no existen o causan errores)
            }
        };

        console.log('üìã Record a enviar:', JSON.stringify(airtableRecord, null, 2));

        const response = await fetch('/.netlify/functions/airtable-proxy', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                method: 'POST',
                path: '/Capacitaciones',
                body: airtableRecord
            })
        });

        const responseText = await response.text();
        console.log(`üì• Respuesta HTTP ${response.status}:`, responseText);

        if (!response.ok) {
            console.error('‚ùå Error HTTP:', response.status);
            console.error('Detalle:', responseText);
            return false;
        }

        const data = JSON.parse(responseText);
        console.log('‚úÖ Respuesta exitosa:', data);

        // IMPORTANTE: Retornar el ID del registro creado
        if (data && data.id) {
            console.log('‚úÖ Capacitaci√≥n guardada con ID:', data.id);
            return { success: true, id: data.id };
        }

        return false;
    } catch (err) {
        console.error('‚ùå Error enviando a Airtable:', err.message);
        console.error('Stack:', err.stack);
        return false;
    }
}

// NUEVA FUNCI√ìN: Guarda las preguntas en Airtable
async function saveQuestionsToAirtable(questions, trainingRecordId, type) {
    try {
        console.log(`üìù Guardando ${questions.length} preguntas de ${type}...`);
        
        if (!questions || questions.length === 0) {
            console.log(`‚ö†Ô∏è No hay preguntas de ${type} para guardar`);
            return true;
        }

        // Convertir las preguntas al formato de Airtable
        const records = questions.map(q => ({
            fields: {
                "Capacitaci√≥n": [trainingRecordId],  // Link al registro de la capacitaci√≥n
                "Tipo": type === 'pretest' ? 'Pretest' : 'Postest',
                "N√∫mero": q.number,
                "Pregunta": q.question,
                "Opci√≥n A": q.options.a,
                "Opci√≥n B": q.options.b,
                "Opci√≥n C": q.options.c,
                "Opci√≥n D": q.options.d,
                "Respuesta Correcta": q.correctAnswer
            }
        }));

        console.log(`üìã Preguntas a guardar:`, records);

        // Guardar todas las preguntas en un solo request
        const response = await fetch('/.netlify/functions/airtable-proxy', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                method: 'POST',
                path: '/Preguntas',
                body: { records: records }  // Airtable acepta m√∫ltiples records
            })
        });

        const responseText = await response.text();
        console.log(`üì• Respuesta guardado de preguntas HTTP ${response.status}:`, responseText);

        if (!response.ok) {
            console.error(`‚ùå Error guardando preguntas de ${type}:`, response.status);
            console.error('Detalle:', responseText);
            return false;
        }

        const data = JSON.parse(responseText);
        console.log(`‚úÖ ${questions.length} preguntas de ${type} guardadas exitosamente`);
        
        return true;

    } catch (err) {
        console.error(`‚ùå Error guardando preguntas de ${type}:`, err);
        return false;
    }
}


        function generateAccessCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        function showQRCode(accessCode, title) {
            const modal = document.getElementById('qrModal');
            const qrContainer = document.getElementById('qrcode');
            
            qrContainer.innerHTML = '';
            
            const accessUrl = `${window.location.origin}?code=${accessCode}`;
            new QRCode(qrContainer, {
                text: accessUrl,
                width: 256,
                height: 256,
                colorDark: '#2E7D32',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('modalAccessCode').textContent = accessCode;
            document.getElementById('modalAccessLink').textContent = accessUrl;
            
            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('qrModal').style.display = 'none';
        }

        function copyLink() {
            const link = document.getElementById('modalAccessLink').textContent;
            const code = document.getElementById('modalAccessCode').textContent;
            
            const text = `üè• Acceso a Capacitaci√≥n\n\nC√≥digo: ${code}\nLink: ${link}\n\nHospital Susana L√≥pez de Valencia`;
            
            navigator.clipboard.writeText(text).then(() => {
                Swal.fire({
                    icon: 'success',
                    title: 'Copiado',
                    text: 'Link copiado al portapapeles',
                    timer: 2000,
                    showConfirmButton: false
                });
            });
        }

        function shareWhatsApp() {
            const code = document.getElementById('modalAccessCode').textContent;
            const link = document.getElementById('modalAccessLink').textContent;
            
            const message = `üè• *Acceso a Capacitaci√≥n*\nHospital Susana L√≥pez de Valencia\n\n*C√≥digo:* ${code}\n*Link:* ${link}`;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function downloadQR() {
            const canvas = document.querySelector('#qrcode canvas');
            if (canvas) {
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    const code = document.getElementById('modalAccessCode').textContent;
                    link.download = `QR-${code}.png`;
                    link.href = url;
                    link.click();
                    URL.revokeObjectURL(url);
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Descargado',
                        timer: 2000,
                        showConfirmButton: false
                    });
                });
            }
        }

        function resetForm() {
            if (pretestQuestionCount > 0 || postestQuestionCount > 0) {
                Swal.fire({
                    title: '¬øLimpiar Formulario?',
                    text: 'Se perder√°n todas las preguntas',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'S√≠, limpiar',
                    cancelButtonText: 'Cancelar'
                }).then((result) => {
                    if (result.isConfirmed) {
                        performReset();
                    }
                });
            } else {
                performReset();
            }
        }

        function performReset() {
            document.getElementById('trainingForm').reset();
            document.getElementById('pretestQuestions').innerHTML = '';
            document.getElementById('postestQuestions').innerHTML = '';
            pretestQuestionCount = 0;
            postestQuestionCount = 0;
            document.querySelectorAll('.question-counter').forEach(c => c.remove());
            
            Swal.fire({
                icon: 'success',
                title: 'Formulario Limpiado',
                timer: 1500,
                showConfirmButton: false
            });
        }

        // ==================== CONEXI√ìN AIRTABLE SEGURA ====================
        
        // Variables globales para conexi√≥n
        let airtableConnected = false;
        let connectionCheckInterval = null;
        
        // Funci√≥n para actualizar el indicador de conexi√≥n
        function updateConnectionIndicator(status) {
            const indicator = document.getElementById('connectionIndicator');
            const text = document.getElementById('connectionText');
            
            if (!indicator) return;
            
            indicator.classList.remove('connected', 'disconnected', 'checking');
            
            switch(status) {
                case 'connected':
                    indicator.classList.add('connected');
                    text.textContent = '‚úì Sistema en l√≠nea';
                    airtableConnected = true;
                    break;
                case 'disconnected':
                    indicator.classList.add('disconnected');
                    text.textContent = '‚úó Sistema desconectado';
                    airtableConnected = false;
                    break;
                case 'checking':
                    indicator.classList.add('checking');
                    text.textContent = '‚ü≥ Verificando...';
                    break;
            }
        }
        
        // Funci√≥n para verificar conexi√≥n con Airtable (SEGURA - via Netlify)
        async function testAirtableConnection() {
    try {
        updateConnectionIndicator('checking');

        const response = await fetch('/.netlify/functions/airtable-proxy', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                method: 'GET',
                path: '/Capacitaciones?maxRecords=1',
                body: null
            })
        });

        if (!response.ok) {
            updateConnectionIndicator('disconnected');
            console.error('‚ùå Error HTTP al verificar conexi√≥n:', response.status);
            return false;
        }

        const data = await response.json();
        console.log('üîé Respuesta airtable-proxy:', data);

        if (data && data.success === true && Array.isArray(data.records)) {
            updateConnectionIndicator('connected');
            return true;
        } else {
            updateConnectionIndicator('disconnected');
            console.error('‚ùå Proxy respondi√≥ pero sin datos v√°lidos');
            return false;
        }
    } catch (error) {
        updateConnectionIndicator('disconnected');
        console.error('‚ùå Error al verificar conexi√≥n:', error.message);
        return false;
    }
}
        
        // Verificar conexi√≥n al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üîÑ Iniciando verificaci√≥n de conexi√≥n...');
            testAirtableConnection();
            
            // Verificar conexi√≥n cada 30 segundos
            if (connectionCheckInterval) clearInterval(connectionCheckInterval);
            connectionCheckInterval = setInterval(() => {
                testAirtableConnection();
            }, 30000);
        });
        
        // Limpiar intervalo al descargar
        window.addEventListener('beforeunload', () => {
            if (connectionCheckInterval) clearInterval(connectionCheckInterval);
        });
        
        // ==================== FIN CONEXI√ìN AIRTABLE ====================


        // ==================== GESTIONAR CAPACITACIONES ====================
        
        // Variable global para almacenar las capacitaciones
        let allTrainings = [];
        
        // Cargar capacitaciones desde Airtable
        async function loadTrainings() {
            try {
                console.log('üìã Cargando capacitaciones desde Airtable...');
                
                // Mostrar loading
                document.getElementById('trainingsLoading').style.display = 'block';
                document.getElementById('trainingsEmpty').style.display = 'none';
                document.getElementById('trainingsGrid').innerHTML = '';
                
                const response = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: '/Capacitaciones?sort[0][field]=Creado%20En&sort[0][direction]=desc',
                        body: null
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ Respuesta de Airtable:', data);
                
                // Ocultar loading
                document.getElementById('trainingsLoading').style.display = 'none';
                
                if (data.success && data.records && data.records.length > 0) {
                    allTrainings = data.records;
                    renderTrainingsList();
                    updateDashboardStats();
                } else {
                    document.getElementById('trainingsEmpty').style.display = 'block';
                }
                
            } catch (error) {
                console.error('‚ùå Error cargando capacitaciones:', error);
                document.getElementById('trainingsLoading').style.display = 'none';
                document.getElementById('trainingsEmpty').style.display = 'block';
                
                Swal.fire({
                    icon: 'error',
                    title: 'Error al Cargar',
                    text: 'No se pudieron cargar las capacitaciones. Verifica tu conexi√≥n.',
                    confirmButtonText: 'Reintentar'
                }).then(() => loadTrainings());
            }
        }
        
        // Renderizar lista de capacitaciones
        function renderTrainingsList() {
            const grid = document.getElementById('trainingsGrid');
            grid.innerHTML = '';
            
            if (allTrainings.length === 0) {
                document.getElementById('trainingsEmpty').style.display = 'block';
                return;
            }
            
            allTrainings.forEach(training => {
                const fields = training.fields;
                const card = createTrainingCard(training.id, fields);
                grid.innerHTML += card;
            });
        }
        
        // Crear tarjeta de capacitaci√≥n
        function createTrainingCard(id, fields) {
            const title = fields['T√≠tulo'] || 'Sin t√≠tulo';
            const description = fields['Descripci√≥n'] || 'Sin descripci√≥n';
            const date = fields['Fecha'] || '';
            const department = fields['Departamento'] || '';
            const duration = fields['Duraci√≥n'] || '';
            const accessCode = fields['C√≥digo de Acceso'] || '';
            const status = fields['Estado'] || 'active';
            
            const formattedDate = date ? new Date(date).toLocaleDateString('es-ES', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            }) : 'Sin fecha';
            
            return `
                <div class="training-card">
                    <div class="training-card-header">
                        <div>
                            <h3 class="training-title">${title}</h3>
                            <span class="training-status ${status}">${status === 'active' ? 'Activa' : 'Inactiva'}</span>
                        </div>
                    </div>
                    
                    <div class="training-info">
                        <div class="training-info-item">
                            <i class="fas fa-calendar"></i>
                            <span>${formattedDate}</span>
                        </div>
                        <div class="training-info-item">
                            <i class="fas fa-building"></i>
                            <span>${department}</span>
                        </div>
                        <div class="training-info-item">
                            <i class="fas fa-clock"></i>
                            <span>${duration}</span>
                        </div>
                    </div>
                    
                    <div class="training-code">
                        <div class="training-code-label">C√≥digo de Acceso</div>
                        <div class="training-code-value">${accessCode}</div>
                    </div>
                    
                    <div class="training-actions">
                        <button class="btn-action btn-view" onclick="viewTrainingDetails('${id}')">
                            <i class="fas fa-eye"></i> Ver
                        </button>
                        <button class="btn-action btn-qr" onclick="showTrainingQR('${accessCode}', '${title}')">
                            <i class="fas fa-qrcode"></i> QR
                        </button>
                        <button class="btn-action btn-delete" onclick="deleteTraining('${id}', '${title}')">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Ver detalles de capacitaci√≥n
        async function viewTrainingDetails(trainingId) {
            try {
                console.log('üëÅÔ∏è Cargando detalles de capacitaci√≥n:', trainingId);
                
                // Buscar la capacitaci√≥n en el array
                const training = allTrainings.find(t => t.id === trainingId);
                if (!training) {
                    throw new Error('Capacitaci√≥n no encontrada');
                }
                
                const fields = training.fields;
                
                // Cargar preguntas de la capacitaci√≥n
                const questionsResponse = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: `/Preguntas?filterByFormula=SEARCH("${trainingId}",{Capacitacion (from Capacitaci√≥n)})`,
                        body: null
                    })
                });
                
                const questionsData = await questionsResponse.json();
                const questions = questionsData.success ? questionsData.records : [];
                
                // Renderizar detalles
                const detailsBody = document.getElementById('detailsBody');
                detailsBody.innerHTML = `
                    <div class="details-section">
                        <h3><i class="fas fa-info-circle"></i> Informaci√≥n General</h3>
                        <div class="training-info">
                            <div class="training-info-item">
                                <i class="fas fa-heading"></i>
                                <strong>T√≠tulo:</strong> ${fields['T√≠tulo'] || 'N/A'}
                            </div>
                            <div class="training-info-item">
                                <i class="fas fa-align-left"></i>
                                <strong>Descripci√≥n:</strong> ${fields['Descripci√≥n'] || 'N/A'}
                            </div>
                            <div class="training-info-item">
                                <i class="fas fa-calendar"></i>
                                <strong>Fecha:</strong> ${fields['Fecha'] ? new Date(fields['Fecha']).toLocaleDateString('es-ES') : 'N/A'}
                            </div>
                            <div class="training-info-item">
                                <i class="fas fa-building"></i>
                                <strong>Departamento:</strong> ${fields['Departamento'] || 'N/A'}
                            </div>
                            <div class="training-info-item">
                                <i class="fas fa-clock"></i>
                                <strong>Duraci√≥n:</strong> ${fields['Duraci√≥n'] || 'N/A'}
                            </div>
                            <div class="training-info-item">
                                <i class="fas fa-key"></i>
                                <strong>C√≥digo de Acceso:</strong> ${fields['C√≥digo de Acceso'] || 'N/A'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="details-section">
                        <h3><i class="fas fa-question-circle"></i> Preguntas (${questions.length} total)</h3>
                        ${questions.length > 0 ? `
                            <div class="questions-list">
                                ${questions.map((q, index) => {
                                    const qFields = q.fields;
                                    const correctAnswer = qFields['Respuesta Corecta'] || '';
                                    return `
                                        <div class="question-item">
                                            <div class="question-number">Pregunta ${index + 1}</div>
                                            <div class="question-text">${qFields['name'] || 'Sin pregunta'}</div>
                                            <div class="question-options">
                                                <div class="question-option ${correctAnswer === 'B' ? 'correct' : ''}">
                                                    <strong>B)</strong> ${qFields['Opci√≥n B'] || 'N/A'}
                                                    ${correctAnswer === 'B' ? '<i class="fas fa-check-circle" style="color: #F2FFFA; margin-left: auto;"></i>' : ''}
                                                </div>
                                                <div class="question-option ${correctAnswer === 'C' ? 'correct' : ''}">
                                                    <strong>C)</strong> ${qFields['Opci√≥n C'] || 'N/A'}
                                                    ${correctAnswer === 'C' ? '<i class="fas fa-check-circle" style="color: #F2FFFA; margin-left: auto;"></i>' : ''}
                                                </div>
                                                <div class="question-option ${correctAnswer === 'D' ? 'correct' : ''}">
                                                    <strong>D)</strong> ${qFields['Opci√≥n D'] || 'N/A'}
                                                    ${correctAnswer === 'D' ? '<i class="fas fa-check-circle" style="color: #F2FFFA; margin-left: auto;"></i>' : ''}
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : '<p style="text-align: center; color: #F2FFFA;">No hay preguntas registradas</p>'}
                    </div>
                `;
                
                // Mostrar modal
                document.getElementById('detailsModal').classList.add('active');
                
            } catch (error) {
                console.error('‚ùå Error cargando detalles:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudieron cargar los detalles de la capacitaci√≥n'
                });
            }
        }
        
        // Cerrar modal de detalles
        function closeDetailsModal() {
            document.getElementById('detailsModal').classList.remove('active');
        }
        
        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const detailsModal = document.getElementById('detailsModal');
            if (event.target === detailsModal) {
                closeDetailsModal();
            }
            const qrModal = document.getElementById('qrModal');
            if (event.target === qrModal) {
                closeModal();
            }
        };
        
        // Mostrar QR de capacitaci√≥n espec√≠fica
        function showTrainingQR(accessCode, title) {
            showQRCode(accessCode, title);
        }
        
        // Eliminar capacitaci√≥n
        async function deleteTraining(trainingId, title) {
            const result = await Swal.fire({
                title: '¬øEliminar Capacitaci√≥n?',
                html: `Se eliminar√° la capacitaci√≥n:<br><strong>${title}</strong><br><br>Esta acci√≥n no se puede deshacer.`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'S√≠, eliminar',
                cancelButtonText: 'Cancelar'
            });
            
            if (!result.isConfirmed) return;
            
            try {
                Swal.fire({
                    title: 'Eliminando...',
                    text: 'Por favor espera',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                // Eliminar de Airtable
                const response = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'DELETE',
                        path: `/Capacitaciones/${trainingId}`,
                        body: null
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Error al eliminar');
                }
                
                Swal.fire({
                    icon: 'success',
                    title: '¬°Eliminada!',
                    text: 'La capacitaci√≥n ha sido eliminada',
                    timer: 2000,
                    showConfirmButton: false
                });
                
                // Recargar lista
                loadTrainings();
                
            } catch (error) {
                console.error('‚ùå Error eliminando:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo eliminar la capacitaci√≥n'
                });
            }
        }
        
        // Actualizar estad√≠sticas del dashboard
        function updateDashboardStats() {
            document.getElementById('totalTrainings').textContent = allTrainings.length;
            
            // Cargar estad√≠sticas completas desde el servidor
            loadDashboardStats();
        }
        
        // Cargar estad√≠sticas del dashboard desde Airtable
        async function loadDashboardStats() {
            try {
                console.log('üìä Cargando estad√≠sticas del dashboard...');
                
                const response = await fetch('/.netlify/functions/get-dashboard-stats', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({})
                });
                
                const data = await response.json();
                
                if (data.success) {
                    console.log('‚úÖ Estad√≠sticas recibidas:', data.statistics);
                    
                    // Actualizar cards del dashboard
                    document.getElementById('totalTrainings').textContent = data.statistics.totalTrainings;
                    document.getElementById('totalParticipants').textContent = data.statistics.totalParticipants;
                    document.getElementById('adherenceRate').textContent = data.statistics.adherenceRate + '%';
                    document.getElementById('avgImprovement').textContent = '+' + data.statistics.avgImprovement + '%';
                    
                    // Actualizar gr√°fico de participaciones por d√≠a
                    if (participationsChart && data.charts && data.charts.participationsByDay) {
                        participationsChart.data.labels = data.charts.participationsByDay.labels;
                        participationsChart.data.datasets[0].data = data.charts.participationsByDay.data;
                        participationsChart.update();
                    }
                    
                    // Actualizar gr√°fico de departamentos
                    if (departmentChart && data.charts && data.charts.departmentPerformance) {
                        departmentChart.data.labels = data.charts.departmentPerformance.labels;
                        departmentChart.data.datasets[0].data = data.charts.departmentPerformance.data;
                        departmentChart.update();
                    }
                    
                    console.log('‚úÖ Dashboard actualizado correctamente');
                } else {
                    console.error('‚ùå Error en respuesta:', data.error);
                }
                
            } catch (error) {
                console.error('‚ùå Error cargando estad√≠sticas del dashboard:', error);
            }
        }
        
        // Cargar capacitaciones cuando se cambia a la pesta√±a "Gestionar"
        const originalSwitchTab = switchTab;
        window.switchTab = function(tabName) {
            originalSwitchTab(tabName);
            if (tabName === 'manage') {
                loadTrainings();
            }
        };

        // ==================== CHARTS ====================
        
        let participationsChart = null;
        let departmentChart = null;

        function initializeCharts() {
            if (participationsChart) participationsChart.destroy();
            if (departmentChart) departmentChart.destroy();
            
            const ctx1 = document.getElementById('participationsChart');
            if (ctx1) {
                participationsChart = new Chart(ctx1.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b', 'Dom'],
                        datasets: [{
                            label: 'Participaciones',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            borderColor: '#2E7D32',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            }
            
            const ctx2 = document.getElementById('departmentChart');
            if (ctx2) {
                departmentChart = new Chart(ctx2.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['Enfermer√≠a', 'Medicina', 'Admin', 'Lab', 'Radiolog√≠a'],
                        datasets: [{
                            label: 'Rendimiento',
                            data: [0, 0, 0, 0, 0],
                            backgroundColor: [
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(100, 210, 80, 0.8)',
                                'rgba(217, 65, 244, 0.8)',
                                'rgba(248, 150, 30, 0.8)',
                                'rgba(52, 172, 224, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }
        }
        
        // ==================== FUNCIONES PARA GENERAR QR ====================
        
        /**
         * Genera un c√≥digo √∫nico de 6 caracteres alfanum√©ricos
         */
        function generateAccessCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        
        /**
         * Muestra el modal con el QR generado
         */
        async function showTrainingQR(accessCode, trainingTitle) {
            try {
                console.log(`üì± Generando QR para: ${trainingTitle} (${accessCode})`);
                
                // Generar c√≥digo √∫nico si es necesario
                const finalCode = accessCode && accessCode.trim() ? accessCode : generateAccessCode();
                
                // Construir URL con par√°metros
                const baseUrl = window.location.origin + window.location.pathname;
                const qrUrl = `${baseUrl}?code=${finalCode}&auto=true`;
                
                console.log(`üîó URL QR: ${qrUrl}`);
                
                // Limpiar contenedor anterior
                const qrContainer = document.getElementById('qrCode');
                qrContainer.innerHTML = '';
                
                // Generar QR usando QRCode.js
                new QRCode(qrContainer, {
                    text: qrUrl,
                    width: 300,
                    height: 300,
                    colorDark: '#000000',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.H
                });
                
                // Llenar la URL en el campo de texto
                document.getElementById('qrUrl').value = qrUrl;
                
                // Guardar datos para descargar despu√©s
                window.currentQRData = {
                    url: qrUrl,
                    code: finalCode,
                    title: trainingTitle
                };
                
                // Mostrar modal
                document.getElementById('qrModal').style.display = 'flex';
                
                Swal.fire({
                    icon: 'success',
                    title: '¬°QR Generado!',
                    text: `C√≥digo: ${finalCode}\n\nCompartir este enlace o escanear el QR`,
                    timer: 2000,
                    showConfirmButton: false
                });
                
            } catch (error) {
                console.error('‚ùå Error generando QR:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo generar el c√≥digo QR: ' + error.message
                });
            }
        }
        
        /**
         * Cierra el modal del QR
         */
        function closeQRModal() {
            document.getElementById('qrModal').style.display = 'none';
        }
        
        /**
         * Copia la URL del QR al portapapeles
         */
        function copyQRUrl() {
            const qrUrlInput = document.getElementById('qrUrl');
            qrUrlInput.select();
            document.execCommand('copy');
            
            Swal.fire({
                icon: 'success',
                title: '¬°Copiado!',
                text: 'El enlace ha sido copiado al portapapeles',
                timer: 1500,
                showConfirmButton: false
            });
        }
        
        /**
         * Descarga la imagen del QR
         */
        function downloadQRCode() {
            try {
                const qrContainer = document.getElementById('qrCode');
                const qrImage = qrContainer.querySelector('img');
                
                if (!qrImage) {
                    throw new Error('No se encontr√≥ la imagen del QR');
                }
                
                // Crear elemento de descarga
                const link = document.createElement('a');
                link.href = qrImage.src;
                link.download = `QR-${window.currentQRData.code}-${window.currentQRData.title.replace(/\s+/g, '-')}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                Swal.fire({
                    icon: 'success',
                    title: 'Descargado',
                    text: 'El c√≥digo QR ha sido descargado',
                    timer: 1500,
                    showConfirmButton: false
                });
                
            } catch (error) {
                console.error('‚ùå Error descargando QR:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo descargar el QR'
                });
            }
        }
        
        /**
         * Abre el enlace del QR en una nueva pesta√±a (para pruebas)
         */
        function testQRCode() {
            if (window.currentQRData) {
                window.open(window.currentQRData.url, '_blank');
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // FUNCIONES DE REPORTES DE PARTICIPANTES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        // Variables globales para reportes
        let currentReportData = null;
        let allParticipantsData = [];
        
        // Logos para el reporte oficial SLV-SR-03-F05
        const LOGO_COLOMBIA_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="60" height="60">
            <circle cx="50" cy="50" r="48" fill="#003087" stroke="#003087" stroke-width="2"/>
            <text x="50" y="25" text-anchor="middle" fill="white" font-size="8" font-weight="bold">REP√öBLICA</text>
            <text x="50" y="65" text-anchor="middle" fill="white" font-size="8" font-weight="bold">DE</text>
            <text x="50" y="80" text-anchor="middle" fill="white" font-size="8" font-weight="bold">COLOMBIA</text>
            <text x="50" y="45" text-anchor="middle" fill="#FFD700" font-size="20">üá®üá¥</text>
        </svg>`;
        
        const LOGO_HOSPITAL_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 80" width="120" height="65">
            <rect x="0" y="0" width="150" height="80" fill="white"/>
            <text x="10" y="15" fill="#666" font-size="6">HOSPITAL</text>
            <text x="10" y="40" fill="#4CAF50" font-size="18" font-weight="bold">Susana</text>
            <text x="10" y="55" fill="#666" font-size="8">L√≥pez de Valencia E.S.E.</text>
            <circle cx="130" cy="40" r="20" fill="none" stroke="#4CAF50" stroke-width="2"/>
            <text x="130" y="45" text-anchor="middle" fill="#4CAF50" font-size="12">üè•</text>
        </svg>`;

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CARGAR OPCIONES DE CAPACITACIONES EN EL SELECT
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        async function loadReportOptions() {
            try {
                console.log('üìä Cargando opciones de reportes...');
                
                const select = document.getElementById('reportTrainingSelect');
                if (!select) return;
                
                // Mostrar loading en el select
                select.innerHTML = '<option value="">Cargando capacitaciones...</option>';
                select.disabled = true;
                
                // Obtener todas las capacitaciones
                const response = await fetch('/.netlify/functions/airtable-proxy', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        method: 'GET',
                        path: '/Capacitaciones'
                    })
                });
                
                const data = await response.json();
                
                if (!data.success || !data.records) {
                    throw new Error('No se pudieron obtener las capacitaciones');
                }
                
                // Limpiar y llenar el select
                select.innerHTML = '<option value="">-- Selecciona una capacitaci√≥n --</option>';
                
                // Ordenar por fecha (m√°s reciente primero)
                const sortedTrainings = data.records.sort((a, b) => {
                    const dateA = new Date(a.fields['Fecha Creaci√≥n'] || 0);
                    const dateB = new Date(b.fields['Fecha Creaci√≥n'] || 0);
                    return dateB - dateA;
                });
                
                sortedTrainings.forEach(training => {
                    const option = document.createElement('option');
                    option.value = training.id;
                    
                    const titulo = training.fields['T√≠tulo'] || 'Sin t√≠tulo';
                    const departamento = training.fields['Departamento'] || '';
                    const activa = training.fields['Activa'] !== false;
                    const finalizada = training.fields['Finalizada'] === true;
                    
                    let status = '';
                    if (finalizada) {
                        status = ' [FINALIZADA]';
                    } else if (!activa) {
                        status = ' [INACTIVA]';
                    }
                    
                    option.textContent = `${titulo}${departamento ? ' - ' + departamento : ''}${status}`;
                    select.appendChild(option);
                });
                
                select.disabled = false;
                console.log(`‚úÖ ${sortedTrainings.length} capacitaciones cargadas`);
                
            } catch (error) {
                console.error('‚ùå Error cargando opciones de reportes:', error);
                const select = document.getElementById('reportTrainingSelect');
                if (select) {
                    select.innerHTML = '<option value="">Error al cargar capacitaciones</option>';
                    select.disabled = false;
                }
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CRONOGRAMA ANUAL DE CAPACITACIONES (NUEVO)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        // Datos del cronograma generado (para exportar / imprimir)
        let annualScheduleData = [];
        let manualScheduleData = [];
        const CRONOGRAMA_TABLE = 'Cronograma';

        function initScheduleTab() {
            // A√±o por defecto
            const yearInput = document.getElementById('scheduleYear');
            if (yearInput && !yearInput.value) {
                yearInput.value = String(new Date().getFullYear());
            }

            // Limpiar vista del cronograma generado
            const container = document.getElementById('scheduleContainer');
            const empty = document.getElementById('scheduleEmpty');
            if (container) container.style.display = 'none';
            if (empty) empty.style.display = 'none';

            // Reset generado (manual se conserva)
            annualScheduleData = [];

            // Inicializar UI manual + cargar guardados
            initManualScheduleUI();
            loadManualScheduleData();

            updateScheduleActionButtons();
        }

        function setScheduleActionButtonsEnabled(enabled) {
            const btnExcel = document.getElementById('btnDownloadScheduleExcel');
            const btnIcs = document.getElementById('btnDownloadScheduleICS');
            const btnPrint = document.getElementById('btnPrintSchedule');
            if (btnExcel) btnExcel.disabled = !enabled;
            if (btnIcs) btnIcs.disabled = !enabled;
            if (btnPrint) btnPrint.disabled = !enabled;
        }

        function updateScheduleActionButtons() {
            const combined = getCombinedScheduleData();
            setScheduleActionButtonsEnabled(combined.length > 0);

            const btnSave = document.getElementById('btnSaveGeneratedToAirtable');
            if (btnSave) btnSave.disabled = !(annualScheduleData && annualScheduleData.length > 0);
        }

        // ======================
        // CRONOGRAMA: Capacitaciones individuales (manual)
        // ======================
        
async function airtableProxyRequest(payload) {
    // Request helper with automatic fallback when Airtable rejects an "Unknown field name"
    // (commonly due to accents/tilde differences like Observaci√≥n vs Observacion).
    const stripDiacritics = (s) => (s || '')
        .toString()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '');

    // Deep-clone payload to avoid mutating caller objects
    let current = JSON.parse(JSON.stringify(payload || {}));

    const tryFixUnknownField = (msg) => {
        if (!msg) return false;

        // Common Airtable message: Unknown field name: "Observaci√≥n"
        const m = String(msg).match(/Unknown field name\s*:?\s*"?([^"\n]+)"?/i);
        const unknown = m && m[1] ? m[1].trim() : null;
        if (!unknown) return false;

        const fields = current?.body?.fields;
        if (!fields || typeof fields !== 'object') return false;
        if (!(unknown in fields)) return false;

        const alt = stripDiacritics(unknown);

        // 1) Prefer switching to the de-accented name (Observacion)
        if (alt && alt !== unknown && !(alt in fields)) {
            fields[alt] = fields[unknown];
            delete fields[unknown];
            return true;
        }

        // 2) If de-accented already exists or no change, drop the unknown field to allow saving
        delete fields[unknown];
        return true;
    };

    for (let attempt = 0; attempt < 3; attempt++) {
        const res = await fetch('/.netlify/functions/airtable-proxy', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(current)
        });

        const rawText = await res.text();
        let data = null;
        try { data = rawText ? JSON.parse(rawText) : {}; } catch { data = { raw: rawText }; }

        if (res.ok) return data;

        const msg = (data && (data.error || data.message)) ? (data.error || data.message) : rawText;

        // Auto-fix: retry if Airtable complains about an unknown field name
        if (res.status === 422 && attempt < 2 && tryFixUnknownField(msg)) {
            continue;
        }

        throw new Error(msg || `Error HTTP ${res.status}`);
    }

    throw new Error('Error desconocido comunic√°ndose con Airtable.');
}

function makeCronogramaFilterFormula(year, tipo) {
            const y = Number(year);
            if (!tipo) return `{A√±o}=${y}`;
            // Tipo es Single select / texto: Manual o Generado
            return `AND({A√±o}=${y}, {Tipo}='${String(tipo).replace(/'/g, "\'")}')`;
        }

        async function loadScheduleFromAirtable(year, showToast = false) {
            try {
                const y = Number(year || new Date().getFullYear());
                const params = new URLSearchParams();
                params.set('pageSize', '100');
                params.set('filterByFormula', makeCronogramaFilterFormula(y));
                params.append('sort[0][field]', 'Fecha');
                params.append('sort[0][direction]', 'asc');
                params.append('sort[1][field]', 'Hora');
                params.append('sort[1][direction]', 'asc');

                const data = await airtableProxyRequest({
                    method: 'GET',
                    path: `/${CRONOGRAMA_TABLE}?${params.toString()}`
                });

                const records = (data && data.records) ? data.records : [];
                const manual = [];
                const generado = [];

                records.forEach(rec => {
                    const f = rec.fields || {};
                    const tipo = f['Tipo'] || '';
                    const dateISO = (f['Fecha'] || '').slice(0, 10); // Airtable puede devolver fecha con hora
                    const dateObj = dateISO ? new Date(dateISO + 'T00:00:00') : null;

                    const item = {
                        id: rec.id, // recordId Airtable
                        index: 0,
                        dateObj: dateObj || new Date(),
                        dateES: dateObj ? formatDateES(dateObj) : dateISO,
                        dateISO: dateISO,
                        time: f['Hora'] || '00:00',
                        title: f['Capacitaci√≥n'] || f['Capacitacion'] || 'Capacitaci√≥n',
                        department: f['Departamento'] || '',
                        duration: f['Duraci√≥n'] || f['Duracion'] || '',
                        location: f['Lugar'] || '',
                        notes: f['Observaci√≥n'] || f['Observacion'] || '',
                        source: tipo || 'Manual',
                        trainingId: f['Capacitaci√≥n ID'] || f['Capacitacion ID'] || ''
                    };

                    if ((tipo || '').toLowerCase() === 'generado') generado.push(item);
                    else manual.push(item);
                });

                // Reindex para tablas
                generado.forEach((it, idx) => it.index = idx + 1);
                manual.forEach((it, idx) => it.index = idx + 1);

                manualScheduleData = manual;
                annualScheduleData = generado;

                // Render tablas
                if (typeof renderManualScheduleTable === 'function') renderManualScheduleTable();
                if (typeof renderScheduleTable === 'function') renderScheduleTable();

                // Mostrar/ocultar contenedor generado
                const container = document.getElementById('scheduleContainer');
                const empty = document.getElementById('scheduleEmpty');
                if (container && empty) {
                    if (annualScheduleData.length > 0) {
                        container.style.display = 'block';
                        empty.style.display = 'none';
                    } else {
                        container.style.display = 'none';
                        empty.style.display = 'block';
                    }
                }

                updateScheduleActionButtons();

                if (showToast) {
                    Swal.fire({ icon: 'success', title: 'Cronograma cargado', text: `Se cargaron ${manual.length + generado.length} eventos desde Airtable.`, timer: 1400, showConfirmButton: false });
                }
            } catch (err) {
                console.error('‚ùå Error cargando cronograma desde Airtable:', err);
                if (showToast) {
                    Swal.fire({ icon:'error', title:'No se pudo cargar', text:'Verifica la tabla "Cronograma" y los campos en Airtable, o el proxy de Netlify.' });
                }
            }
        }

        // Mantener nombre por compatibilidad con initScheduleTab()
        function loadManualScheduleData(showToast = false) {
            const year = document.getElementById('scheduleYear')?.value || String(new Date().getFullYear());
            loadScheduleFromAirtable(year, showToast);
        }

        // Antes era localStorage. Ahora no se usa, pero se deja por compatibilidad.
        function saveManualScheduleData() {
            // Guardado se hace directamente en Airtable en add/delete.
            updateScheduleActionButtons();
        }

        async function initManualScheduleUI() {
            const select = document.getElementById('manualTrainingSelect');
            if (!select) return;

            let trainings = [];
            try {
                trainings = await fetchTrainingsForSchedule();
            } catch (e) {
                trainings = [];
            }

            select.innerHTML = '';
            const opt0 = document.createElement('option');
            opt0.value = '';
            opt0.textContent = 'Seleccione...';
            select.appendChild(opt0);

            trainings.forEach(t => {
                const opt = document.createElement('option');
                opt.value = t.id || t.title || t.titulo || '';
                opt.dataset.title = t.title || t.titulo || 'Capacitaci√≥n';
                opt.dataset.department = t.department || t.departamento || '';
                opt.dataset.duration = t.duration || t.duracion || '';
                opt.textContent = `${opt.dataset.title}${opt.dataset.department ? ' ‚Äî ' + opt.dataset.department : ''}`;
                select.appendChild(opt);
            });

            const optOther = document.createElement('option');
            optOther.value = '__other__';
            optOther.textContent = 'Otra... (escribir nombre)';
            select.appendChild(optOther);

            select.onchange = () => {
                const wrap = document.getElementById('manualTrainingOtherWrap');
                if (!wrap) return;
                wrap.style.display = (select.value === '__other__') ? 'block' : 'none';
            };

            const d = document.getElementById('manualDate');
            if (d && !d.value) {
                const now = new Date();
                const yyyy = now.getFullYear();
                const mm = String(now.getMonth() + 1).padStart(2, '0');
                const dd = String(now.getDate()).padStart(2, '0');
                d.value = `${yyyy}-${mm}-${dd}`;
            }
        }

        async function addManualScheduleEvent() {
            const sel = document.getElementById('manualTrainingSelect');
            const other = document.getElementById('manualTrainingOther');
            const date = document.getElementById('manualDate');
            const time = document.getElementById('manualTime');
            const duration = document.getElementById('manualDuration');
            const location = document.getElementById('manualLocation');
            const notes = document.getElementById('manualNotes');

            if (!sel || !date || !time) return;

            const year = Number(document.getElementById('scheduleYear')?.value || new Date().getFullYear());
            const dateISO = (date.value || '').trim();
            const hhmm = (time.value || '').trim();

            if (!dateISO || !hhmm) {
                Swal.fire({ icon:'warning', title:'Faltan datos', text:'Selecciona fecha y hora.' });
                return;
            }

            let title = '';
            let department = '';
            let dur = (duration?.value || '').trim();
            let trainingId = '';

            if (sel.value === '__other__') {
                title = (other?.value || '').trim();
                if (!title) {
                    Swal.fire({ icon:'warning', title:'Falta el nombre', text:'Escribe el nombre de la capacitaci√≥n.' });
                    return;
                }
            } else {
                const opt = sel.options[sel.selectedIndex];
                title = opt?.dataset?.title || opt?.textContent || 'Capacitaci√≥n';
                department = opt?.dataset?.department || '';
                trainingId = opt?.value || '';
                if (!dur) dur = opt?.dataset?.duration || '';
            }

            const fields = {
                'A√±o': year,
                'Fecha': dateISO,
                'Hora': hhmm,
                'Capacitaci√≥n': title,
                'Departamento': department,
                'Duraci√≥n': dur,
                'Lugar': (location?.value || '').trim(),
                'Observaci√≥n': (notes?.value || '').trim(),
                'Tipo': 'Manual',
                'Capacitaci√≥n ID': trainingId
            };

            try {
                Swal.fire({ title:'Guardando...', text:'Registrando evento en Airtable', allowOutsideClick:false, didOpen: () => Swal.showLoading() });

                const res = await airtableProxyRequest({
                    method: 'POST',
                    path: `/${CRONOGRAMA_TABLE}`,
                    body: { fields }
                });

                // Airtable devuelve record
                Swal.close();
                clearManualScheduleForm();

                // Recargar desde Airtable para asegurar consistencia en cualquier PC
                await loadScheduleFromAirtable(year);

                Swal.fire({ icon:'success', title:'Agregado', timer: 1000, showConfirmButton:false });
            } catch (err) {
                console.error('‚ùå Error guardando evento manual:', err);
                Swal.fire({ icon:'error', title:'No se pudo guardar', text:'Verifica la tabla "Cronograma" en Airtable y los campos.' });
            }
        }

        function clearManualScheduleForm() {
            const other = document.getElementById('manualTrainingOther');
            const duration = document.getElementById('manualDuration');
            const location = document.getElementById('manualLocation');
            const notes = document.getElementById('manualNotes');
            if (other) other.value = '';
            if (duration) duration.value = '';
            if (location) location.value = '';
            if (notes) notes.value = '';
        }

        async function deleteManualScheduleEvent(id) {
            const year = Number(document.getElementById('scheduleYear')?.value || new Date().getFullYear());

            const confirm = await Swal.fire({
                icon: 'warning',
                title: 'Eliminar evento',
                text: '¬øSeguro que deseas eliminar este evento del cronograma (Airtable)?',
                showCancelButton: true,
                confirmButtonText: 'S√≠, eliminar',
                cancelButtonText: 'Cancelar'
            });

            if (!confirm.isConfirmed) return;

            try {
                Swal.fire({ title:'Eliminando...', allowOutsideClick:false, didOpen: () => Swal.showLoading() });

                await airtableProxyRequest({
                    method: 'DELETE',
                    path: `/${CRONOGRAMA_TABLE}/${id}`
                });

                Swal.close();
                await loadScheduleFromAirtable(year);
                Swal.fire({ icon:'success', title:'Eliminado', timer: 900, showConfirmButton:false });
            } catch (err) {
                console.error('‚ùå Error eliminando evento:', err);
                Swal.fire({ icon:'error', title:'No se pudo eliminar', text:'Revisa permisos/tabla "Cronograma" en Airtable.' });
            }
        }

        function renderManualScheduleTable() {
            const empty = document.getElementById('manualScheduleEmpty');
            const container = document.getElementById('manualScheduleContainer');
            const tbody = document.getElementById('manualScheduleTbody');
            if (!tbody) return;

            if (!manualScheduleData || manualScheduleData.length === 0) {
                if (empty) empty.style.display = 'block';
                if (container) container.style.display = 'none';
                tbody.innerHTML = '';
                return;
            }

            if (empty) empty.style.display = 'none';
            if (container) container.style.display = 'block';

            const sorted = [...manualScheduleData].sort((a,b) => new Date(`${a.dateISO}T${a.time}:00`) - new Date(`${b.dateISO}T${b.time}:00`));

            tbody.innerHTML = '';
            sorted.forEach((r, i) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding:8px; border:1px solid #e5e7eb;">${i+1}</td>
                    <td style="padding:8px; border:1px solid #e5e7eb;">${r.dateISO}</td>
                    <td style="padding:8px; border:1px solid #e5e7eb;">${r.time}</td>
                    <td style="padding:8px; border:1px solid #e5e7eb;"><strong>${escapeHtml(r.title)}</strong></td>
                    <td style="padding:8px; border:1px solid #e5e7eb;">${escapeHtml(r.location || '')}</td>
                    <td style="padding:8px; border:1px solid #e5e7eb;">${escapeHtml(r.duration || '')}</td>
                    <td style="padding:8px; border:1px solid #e5e7eb;">
                        <button class="btn btn-danger" style="padding:6px 10px;" onclick="deleteManualScheduleEvent('${r.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function getCombinedScheduleData() {
            const gen = (annualScheduleData || []).map(x => ({ ...x, source: 'Generado' }));
            const man = (manualScheduleData || []).map(x => ({
                dateISO: x.dateISO,
                time: x.time,
                title: x.title,
                department: x.department || '',
                duration: x.duration || '',
                location: x.location || '',
                notes: x.notes || '',
                source: 'Manual'
            }));

            const all = [...gen, ...man].sort((a,b) => new Date(`${a.dateISO}T${a.time}:00`) - new Date(`${b.dateISO}T${b.time}:00`));
            all.forEach((r, idx) => r._exportIndex = idx + 1);
            return all;
        }

        // ======================
        // Exportar Excel (.xlsx) - formato profesional
        // ======================
        function downloadScheduleExcel() {
            const data = getCombinedScheduleData();
            if (!data || data.length === 0) return;

            if (typeof XLSX === 'undefined') {
                Swal.fire({ icon:'error', title:'Excel no disponible', text:'No se carg√≥ la librer√≠a para Excel. Verifica que xlsx-js-style est√© incluido.' });
                return;
            }

            const year = document.getElementById('scheduleYear')?.value || String(new Date().getFullYear());
            const generatedAt = new Date().toLocaleString('es-CO');

            const header = ['#','Fecha','Hora','Capacitaci√≥n','Departamento','Duraci√≥n','Lugar','Observaci√≥n','Tipo'];
            const aoa = [];
            aoa.push([`Cronograma Anual de Capacitaciones - ${year}`]);
            aoa.push([`Hospital Susana L√≥pez de Valencia | Generado: ${generatedAt}`]);
            aoa.push([]);
            aoa.push(header);

            data.forEach(r => {
                const d = new Date(`${r.dateISO}T00:00:00`);
                const t = (r.time && r.time.includes(':')) ? r.time : '00:00';
                const [hh, mm] = t.split(':').map(x => parseInt(x, 10) || 0);
                const timeFraction = (hh * 60 + mm) / (24 * 60);

                aoa.push([
                    r._exportIndex,
                    d,
                    timeFraction,
                    r.title || '',
                    r.department || '',
                    r.duration || '',
                    r.location || '',
                    r.notes || '',
                    r.source || ''
                ]);
            });

            const ws = XLSX.utils.aoa_to_sheet(aoa, { cellDates: true });

            ws['!cols'] = [
                { wch: 4 }, { wch: 12 }, { wch: 7 }, { wch: 48 }, { wch: 18 },
                { wch: 12 }, { wch: 22 }, { wch: 30 }, { wch: 10 }
            ];

            ws['!merges'] = [
                { s: { r:0, c:0 }, e: { r:0, c:8 } },
                { s: { r:1, c:0 }, e: { r:1, c:8 } }
            ];

            ws['!freeze'] = { xSplit: 0, ySplit: 4, topLeftCell: 'A5', activePane: 'bottomLeft', state: 'frozen' };
            ws['!autofilter'] = { ref: 'A4:I4' };

            const border = {
                top: { style: 'thin', color: { rgb: 'D1D5DB' } },
                bottom: { style: 'thin', color: { rgb: 'D1D5DB' } },
                left: { style: 'thin', color: { rgb: 'D1D5DB' } },
                right: { style: 'thin', color: { rgb: 'D1D5DB' } },
            };

            const titleStyle = {
                font: { bold: true, sz: 16, color: { rgb: 'FFFFFF' } },
                fill: { patternType: 'solid', fgColor: { rgb: '4F46E5' } },
                alignment: { horizontal: 'center', vertical: 'center' }
            };

            const subTitleStyle = {
                font: { italic: true, sz: 11, color: { rgb: '374151' } },
                alignment: { horizontal: 'center', vertical: 'center' }
            };

            const headerStyle = {
                font: { bold: true, color: { rgb: 'FFFFFF' } },
                fill: { patternType: 'solid', fgColor: { rgb: '111827' } },
                alignment: { horizontal: 'center', vertical: 'center', wrapText: true },
                border
            };

            function styleCell(addr, s, z) {
                if (!ws[addr]) return;
                ws[addr].s = s;
                if (z) ws[addr].z = z;
            }

            styleCell('A1', titleStyle);
            styleCell('A2', subTitleStyle);

            ws['!rows'] = [
                { hpt: 28 },
                { hpt: 18 },
                { hpt: 8 },
                { hpt: 20 }
            ];

            const cols = ['A','B','C','D','E','F','G','H','I'];
            cols.forEach(col => styleCell(`${col}4`, headerStyle));

            const firstDataRow = 5;
            const lastRow = 4 + data.length;
            for (let r = firstDataRow; r <= lastRow; r++) {
                const isAlt = ((r - firstDataRow) % 2) === 1;
                const fill = isAlt ? { patternType:'solid', fgColor:{ rgb:'F9FAFB' } } : undefined;

                cols.forEach((col, cidx) => {
                    const addr = `${col}${r}`;
                    if (!ws[addr]) return;

                    const baseStyle = {
                        alignment: { horizontal: (cidx<=2 ? 'center' : 'left'), vertical:'top', wrapText: (col==='D' || col==='H') },
                        border
                    };
                    if (fill) baseStyle.fill = fill;

                    if (col === 'B') ws[addr].z = 'dd/mm/yyyy';
                    if (col === 'C') ws[addr].z = 'hh:mm';

                    ws[addr].s = baseStyle;
                });
            }

            // Resumen
            const monthNames = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
            const monthCount = Array(12).fill(0);
            const typeCount = {};
            data.forEach(r => {
                const m = parseInt(r.dateISO.split('-')[1], 10) - 1;
                if (m >= 0 && m < 12) monthCount[m] += 1;
                typeCount[r.source || ''] = (typeCount[r.source || ''] || 0) + 1;
            });

            const summaryAoa = [];
            summaryAoa.push([`Resumen - Cronograma ${year}`]);
            summaryAoa.push([`Total de eventos`, data.length]);
            summaryAoa.push([]);
            summaryAoa.push(['Eventos por mes', 'Cantidad']);
            monthNames.forEach((name, idx) => summaryAoa.push([name, monthCount[idx]]));
            summaryAoa.push([]);
            summaryAoa.push(['Eventos por tipo', 'Cantidad']);
            Object.keys(typeCount).forEach(k => summaryAoa.push([k, typeCount[k]]));

            const ws2 = XLSX.utils.aoa_to_sheet(summaryAoa);
            ws2['!cols'] = [{ wch: 22 }, { wch: 12 }];
            ws2['!merges'] = [{ s:{r:0,c:0}, e:{r:0,c:1} }];
            ws2['!freeze'] = { xSplit: 0, ySplit: 1, topLeftCell: 'A2', activePane: 'bottomLeft', state: 'frozen' };

            const sumTitle = {
                font: { bold: true, sz: 14, color: { rgb: 'FFFFFF' } },
                fill: { patternType: 'solid', fgColor: { rgb: '0F766E' } },
                alignment: { horizontal: 'center', vertical: 'center' }
            };
            if (ws2['A1']) ws2['A1'].s = sumTitle;
            ws2['!rows'] = [{ hpt: 22 }];

            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Cronograma');
            XLSX.utils.book_append_sheet(wb, ws2, 'Resumen');

            XLSX.writeFile(wb, `cronograma_capacitaciones_${year}.xlsx`);
        }


        async function fetchTrainingsForSchedule() {
            const response = await fetch('/.netlify/functions/airtable-proxy', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    method: 'GET',
                    path: '/Capacitaciones'
                })
            });

            const data = await response.json();
            if (!response.ok || !data || data.success !== true || !Array.isArray(data.records)) {
                const msg = (data && (data.error || data.message)) ? (data.error || data.message) : `HTTP ${response.status}`;
                throw new Error(msg);
            }

            // Filtrar activas y no finalizadas (si existen los campos)
            const trainings = data.records
                .filter(r => {
                    const f = r.fields || {};
                    const activa = f['Activa'] !== false; // por defecto true
                    const finalizada = f['Finalizada'] === true; // por defecto false
                    const estado = String(f['Estado'] || '').toLowerCase();
                    const estadoFinal = estado.includes('final') || estado.includes('complet');
                    return activa && !finalizada && !estadoFinal;
                })
                .map(r => ({
                    id: r.id,
                    title: (r.fields && (r.fields['T√≠tulo'] || r.fields['Titulo'])) || 'Sin t√≠tulo',
                    department: (r.fields && r.fields['Departamento']) || 'General',
                    duration: (r.fields && r.fields['Duraci√≥n']) || (r.fields && r.fields['Duracion']) || ''
                }));

            // Ordenar por t√≠tulo para un resultado estable
            trainings.sort((a, b) => a.title.localeCompare(b.title, 'es'));
            return trainings;
        }

        function parseTimeHHMM(value) {
            const safe = String(value || '08:00');
            const parts = safe.split(':');
            const hh = parseInt(parts[0] || '8', 10);
            const mm = parseInt(parts[1] || '0', 10);
            return {
                hh: Number.isFinite(hh) ? hh : 8,
                mm: Number.isFinite(mm) ? mm : 0
            };
        }

        // Devuelve el n-√©simo d√≠a 'weekday' (0=Dom...6=S√°b) dentro de un mes
        function getNthWeekdayOfMonth(year, monthIndex, weekday, nth) {
            const first = new Date(year, monthIndex, 1);
            const firstDow = first.getDay();
            // offset hasta el primer weekday
            let offset = (weekday - firstDow + 7) % 7;
            let day = 1 + offset;

            if (nth === 'last') {
                // Buscar desde el final
                const last = new Date(year, monthIndex + 1, 0);
                const lastDow = last.getDay();
                const back = (lastDow - weekday + 7) % 7;
                return new Date(year, monthIndex, last.getDate() - back);
            }

            const n = Math.max(1, Math.min(4, parseInt(nth, 10) || 1));
            day += (n - 1) * 7;

            // Si se pasa del mes, caer en la √∫ltima ocurrencia
            const candidate = new Date(year, monthIndex, day);
            if (candidate.getMonth() !== monthIndex) {
                const last = new Date(year, monthIndex + 1, 0);
                const lastDow = last.getDay();
                const back = (lastDow - weekday + 7) % 7;
                return new Date(year, monthIndex, last.getDate() - back);
            }
            return candidate;
        }

        function buildBaseDates(year, frequency, weekOfMonth, dayOfWeek) {
            const dow = parseInt(dayOfWeek, 10);

            if (frequency === 'weekly') {
                // Primer d√≠a del a√±o alineado al dow
                const first = new Date(year, 0, 1);
                const offset = (dow - first.getDay() + 7) % 7;
                const start = new Date(year, 0, 1 + offset);

                const dates = [];
                // Generar hasta final de a√±o
                let d = new Date(start);
                while (d.getFullYear() === year) {
                    dates.push(new Date(d));
                    d.setDate(d.getDate() + 7);
                }
                return dates;
            }

            const monthSteps = {
                monthly: 1,
                bimonthly: 2,
                quarterly: 3
            };

            const step = monthSteps[frequency] || 1;
            const dates = [];
            for (let m = 0; m < 12; m += step) {
                dates.push(getNthWeekdayOfMonth(year, m, dow, weekOfMonth));
            }
            return dates;
        }

        function formatDateES(dateObj) {
            const d = dateObj;
            const dd = String(d.getDate()).padStart(2, '0');
            const mm = String(d.getMonth() + 1).padStart(2, '0');
            const yyyy = d.getFullYear();
            return `${dd}/${mm}/${yyyy}`;
        }

        function formatDateISO(dateObj) {
            const d = dateObj;
            const dd = String(d.getDate()).padStart(2, '0');
            const mm = String(d.getMonth() + 1).padStart(2, '0');
            const yyyy = d.getFullYear();
            return `${yyyy}-${mm}-${dd}`;
        }

        function addMinutesToTime(hh, mm, addMinutes) {
            const total = (hh * 60) + mm + addMinutes;
            const newHH = Math.floor(((total % 1440) + 1440) % 1440 / 60);
            const newMM = ((total % 60) + 60) % 60;
            return {
                hh: String(newHH).padStart(2, '0'),
                mm: String(newMM).padStart(2, '0')
            };
        }

        async function generateAnnualSchedule() {
            try {
                Swal.fire({
                    title: 'Generando cronograma...',
                    text: 'Consultando capacitaciones y construyendo el cronograma anual',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });

                const year = parseInt(document.getElementById('scheduleYear')?.value || String(new Date().getFullYear()), 10);
                const frequency = document.getElementById('scheduleFrequency')?.value || 'monthly';
                const weekOfMonth = document.getElementById('scheduleWeekOfMonth')?.value || '1';
                const dayOfWeek = document.getElementById('scheduleDayOfWeek')?.value || '1';
                const timeValue = document.getElementById('scheduleTime')?.value || '08:00';

                const { hh, mm } = parseTimeHHMM(timeValue);
                const trainings = await fetchTrainingsForSchedule();

                const container = document.getElementById('scheduleContainer');
                const empty = document.getElementById('scheduleEmpty');
                if (container) container.style.display = 'none';
                if (empty) empty.style.display = 'none';

                if (!trainings || trainings.length === 0) {
                    if (empty) empty.style.display = 'block';
                    annualScheduleData = [];
                    setScheduleActionButtonsEnabled(false);
                    Swal.close();
                    return;
                }

                const baseDates = buildBaseDates(year, frequency, weekOfMonth, dayOfWeek);
                const eventsCount = Math.max(baseDates.length, trainings.length);

                annualScheduleData = [];
                for (let i = 0; i < eventsCount; i++) {
                    const training = trainings[i % trainings.length];
                    const dateBase = baseDates[i % baseDates.length];
                    const round = Math.floor(i / baseDates.length);
                    const t = addMinutesToTime(hh, mm, round * 60); // si se repite fecha, escalonar 1h

                    annualScheduleData.push({
                        index: i + 1,
                        dateObj: new Date(dateBase),
                        dateES: formatDateES(dateBase),
                        dateISO: formatDateISO(dateBase),
                        time: `${t.hh}:${t.mm}`,
                        title: training.title,
                        department: training.department,
                        duration: training.duration
                    });
                }

                renderScheduleTable();
                if (container) container.style.display = 'block';
                setScheduleActionButtonsEnabled(true);

                Swal.close();

            } catch (error) {
                console.error('‚ùå Error generando cronograma:', error);
                setScheduleActionButtonsEnabled(false);
                Swal.fire({
                    icon: 'error',
                    title: 'No se pudo generar el cronograma',
                    text: error.message || 'Error desconocido'
                });
            }
        }


        // ======================
        // Guardar cronograma generado (anual) en Airtable (para verlo en cualquier PC)
        // ======================
        async function saveGeneratedScheduleToAirtable() {
            const year = Number(document.getElementById('scheduleYear')?.value || new Date().getFullYear());

            if (!annualScheduleData || annualScheduleData.length === 0) {
                Swal.fire({ icon:'info', title:'Sin cronograma', text:'Primero genera el cronograma anual para poder guardarlo.' });
                return;
            }

            const confirm = await Swal.fire({
                icon: 'question',
                title: 'Guardar en Airtable',
                text: `Se guardar√°n ${annualScheduleData.length} eventos GENERADOS del a√±o ${year}. Esto reemplazar√° los generados existentes de ese a√±o.`,
                showCancelButton: true,
                confirmButtonText: 'Guardar',
                cancelButtonText: 'Cancelar'
            });
            if (!confirm.isConfirmed) return;

            try {
                Swal.fire({ title:'Guardando...', text:'Sincronizando con Airtable', allowOutsideClick:false, didOpen: () => Swal.showLoading() });

                // 1) Buscar generados existentes del a√±o
                const params = new URLSearchParams();
                params.set('pageSize', '100');
                params.set('filterByFormula', makeCronogramaFilterFormula(year, 'Generado'));
                const existing = await airtableProxyRequest({
                    method: 'GET',
                    path: `/${CRONOGRAMA_TABLE}?${params.toString()}`
                });

                const ids = (existing.records || []).map(r => r.id);
                // 2) Eliminar en lotes de 10
                for (let i = 0; i < ids.length; i += 10) {
                    const batch = ids.slice(i, i + 10);
                    const delParams = new URLSearchParams();
                    batch.forEach(id => delParams.append('records[]', id));
                    await airtableProxyRequest({
                        method: 'DELETE',
                        path: `/${CRONOGRAMA_TABLE}?${delParams.toString()}`
                    });
                }

                // 3) Crear nuevos generados en lotes de 10
                const recordsToCreate = annualScheduleData.map(it => ({
                    fields: {
                        'A√±o': year,
                        'Fecha': it.dateISO,
                        'Hora': it.time,
                        'Capacitaci√≥n': it.title || 'Capacitaci√≥n',
                        'Departamento': it.department || '',
                        'Duraci√≥n': it.duration || '',
                        'Lugar': it.location || '',
                        'Observaci√≥n': it.notes || '',
                        'Tipo': 'Generado',
                        'Capacitaci√≥n ID': it.trainingId || ''
                    }
                }));

                for (let i = 0; i < recordsToCreate.length; i += 10) {
                    const batch = recordsToCreate.slice(i, i + 10);
                    await airtableProxyRequest({
                        method: 'POST',
                        path: `/${CRONOGRAMA_TABLE}`,
                        body: { records: batch }
                    });
                }

                Swal.close();
                await loadScheduleFromAirtable(year, false);
                Swal.fire({ icon:'success', title:'Guardado', text:'Cronograma generado guardado en Airtable.', timer: 1400, showConfirmButton:false });

            } catch (err) {
                console.error('‚ùå Error guardando generados en Airtable:', err);
                Swal.fire({ icon:'error', title:'No se pudo guardar', text:'Verifica tabla "Cronograma", campos y el proxy de Netlify.' });
            }
        }

        function renderScheduleTable() {
            const tbody = document.getElementById('scheduleTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            annualScheduleData.forEach(item => {
                const tr = document.createElement('tr');
                tr.style.borderBottom = '1px solid #eee';
                tr.innerHTML = `
                    <td style="padding: 0.75rem;">${item.index}</td>
                    <td style="padding: 0.75rem;">${item.dateES}</td>
                    <td style="padding: 0.75rem;">${item.time}</td>
                    <td style="padding: 0.75rem;"><strong>${escapeHtml(item.title)}</strong></td>
                    <td style="padding: 0.75rem;">${escapeHtml(item.department)}</td>
                    <td style="padding: 0.75rem;">${escapeHtml(item.duration || '')}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function escapeHtml(str) {
            return String(str || '')
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function downloadScheduleCSV() {
            if (!annualScheduleData || annualScheduleData.length === 0) return;

            const year = document.getElementById('scheduleYear')?.value || String(new Date().getFullYear());

            const header = ['#', 'Fecha', 'Hora', 'Capacitaci√≥n', 'Departamento', 'Duraci√≥n'];
            const rows = annualScheduleData.map(r => ([
                r.index,
                r.dateISO,
                r.time,
                r.title,
                r.department,
                r.duration || ''
            ]));

            const csv = [header, ...rows]
                .map(cols => cols.map(c => `"${String(c ?? '').replace(/"/g, '""')}"`).join(','))
                .join('\n');

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cronograma_capacitaciones_${year}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function downloadScheduleICS() {
            const combined = getCombinedScheduleData();
            if (!combined || combined.length === 0) return;

            const year = document.getElementById('scheduleYear')?.value || String(new Date().getFullYear());
            const nowStamp = new Date().toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';

            let ics = 'BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Hospital Susana L√≥pez de Valencia//Capacitaciones//ES\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\n';

            const esc = (s) => String(s || '').replace(/\\/g, '\\\\').replace(/\n/g, '\\n').replace(/,/g, '\\,').replace(/;/g, '\\;');

            combined.forEach(item => {
                const dtStart = item.dateISO.replace(/-/g, '') + 'T' + item.time.replace(':', '') + '00';
                const uid = `cap-${year}-${item._exportIndex}@hslv`;

                const summary = esc(item.title || 'Capacitaci√≥n');
                const location = esc(item.location || '');
                const description = esc(`Departamento: ${item.department || ''}\nDuraci√≥n: ${item.duration || ''}\nObservaci√≥n: ${item.notes || ''}\nTipo: ${item.source || ''}`);

                ics += 'BEGIN:VEVENT\n';
                ics += `UID:${uid}\n`;
                ics += `DTSTAMP:${nowStamp}\n`;
                ics += `DTSTART:${dtStart}\n`;
                ics += `SUMMARY:${summary}\n`;
                if (location) ics += `LOCATION:${location}\n`;
                if (description) ics += `DESCRIPTION:${description}\n`;
                ics += 'END:VEVENT\n';
            });

            ics += 'END:VCALENDAR\n';

            const blob = new Blob([ics], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cronograma_capacitaciones_${year}.ics`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function sanitizeICS(text) {
            return String(text || '')
                .replace(/\\/g, '\\\\')
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '')
                .replace(/,/g, '\\,')
                .replace(/;/g, '\\;');
        }

        function printSchedule() {
            const combined = getCombinedScheduleData();
            if (!combined || combined.length === 0) return;

            const year = document.getElementById('scheduleYear')?.value || String(new Date().getFullYear());
            const generatedAt = new Date().toLocaleString('es-CO');

            const w = window.open('', '_blank');
            if (!w) {
                Swal.fire({ icon:'warning', title:'Ventana bloqueada', text:'Permite ventanas emergentes para imprimir.' });
                return;
            }

            const rowsHtml = combined.map(r => `
                <tr>
                    <td>${r._exportIndex}</td>
                    <td>${r.dateISO}</td>
                    <td>${r.time}</td>
                    <td><strong>${escapeHtml(r.title || '')}</strong></td>
                    <td>${escapeHtml(r.department || '')}</td>
                    <td>${escapeHtml(r.duration || '')}</td>
                    <td>${escapeHtml(r.location || '')}</td>
                    <td>${escapeHtml(r.notes || '')}</td>
                    <td>${escapeHtml(r.source || '')}</td>
                </tr>
            `).join('');

            w.document.write(`
                <html>
                <head>
                    <meta charset="utf-8" />
                    <title>Cronograma Capacitaciones ${year}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 24px; color: #F2FFFA; }
                        .title { font-size: 18px; font-weight: 700; margin-bottom: 6px; }
                        .subtitle { font-size: 12px; color: #F2FFFA; margin-bottom: 16px; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #e5e7eb; padding: 8px; vertical-align: top; }
                        th { background: #111827; color: #F2FFFA; text-align: center; }
                        tr:nth-child(even) td { background: #f9fafb; }
                    </style>
                </head>
                <body>
                    <div class="title">Cronograma Anual de Capacitaciones - ${year}</div>
                    <div class="subtitle">Hospital Susana L√≥pez de Valencia | Generado: ${generatedAt}</div>

                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Fecha</th>
                                <th>Hora</th>
                                <th>Capacitaci√≥n</th>
                                <th>Departamento</th>
                                <th>Duraci√≥n</th>
                                <th>Lugar</th>
                                <th>Observaci√≥n</th>
                                <th>Tipo</th>
                            </tr>
                        </thead>
                        <tbody>${rowsHtml}</tbody>
                    </table>

                </body>
                </html>
            `);
            w.document.close();
            setTimeout(() => { try { w.focus(); w.print(); } catch (e) {} }, 300);
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CARGAR REPORTE DE UNA CAPACITACI√ìN
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        async function loadTrainingReport() {
            const trainingId = document.getElementById('reportTrainingSelect').value;
            
            // Elementos del DOM
            const reportContainer = document.getElementById('reportContainer');
            const reportLoading = document.getElementById('reportLoading');
            const reportInitialMessage = document.getElementById('reportInitialMessage');
            
            if (!trainingId) {
                // Mostrar mensaje inicial
                reportContainer.style.display = 'none';
                reportLoading.style.display = 'none';
                reportInitialMessage.style.display = 'block';
                currentReportData = null;
                return;
            }
            
            try {
                // Mostrar loading
                reportContainer.style.display = 'none';
                reportInitialMessage.style.display = 'none';
                reportLoading.style.display = 'block';
                
                console.log('üìä Cargando reporte para capacitaci√≥n:', trainingId);
                
                // Llamar a la funci√≥n serverless
                const response = await fetch('/.netlify/functions/get-training-participants', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ trainingId })
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Error al obtener el reporte');
                }
                
                console.log('‚úÖ Datos del reporte recibidos:', data);
                
                // Guardar datos globalmente
                currentReportData = data;
                allParticipantsData = data.participants || [];
                
                // Llenar informaci√≥n de la capacitaci√≥n
                document.getElementById('reportTrainingTitle').textContent = data.training.titulo;
                document.getElementById('reportTrainingDescription').textContent = data.training.descripcion || 'Sin descripci√≥n';
                document.getElementById('reportTrainingDepartment').textContent = data.training.departamento || 'General';
                document.getElementById('reportTrainingDate').textContent = formatDateForReport(data.training.fechaCreacion);
                
                // Estado de la capacitaci√≥n
                const statusBadge = document.getElementById('reportTrainingStatus');
                if (data.training.finalizada) {
                    statusBadge.textContent = 'Finalizada';
                    statusBadge.style.background = 'rgba(255,255,255,0.2)';
                } else if (data.training.activa) {
                    statusBadge.textContent = 'Activa';
                    statusBadge.style.background = 'rgba(40,167,69,0.3)';
                } else {
                    statusBadge.textContent = 'Inactiva';
                    statusBadge.style.background = 'rgba(220,53,69,0.3)';
                }
                
                // Estad√≠sticas
                const stats = data.statistics;
                document.getElementById('reportTotalParticipants').textContent = stats.totalParticipants;
                document.getElementById('reportCompletedPostest').textContent = stats.completedPostest;
                document.getElementById('reportAvgImprovement').textContent = `+${stats.avgImprovement}%`;
                document.getElementById('reportAdherenceRate').textContent = `${stats.adherenceRate}%`;
                
                // Promedios de calificaciones
                document.getElementById('reportAvgPretest').textContent = `${stats.avgPretestScore}%`;
                document.getElementById('reportAvgPostest').textContent = `${stats.avgPostestScore}%`;
                document.getElementById('reportAvgImprovementBig').textContent = `+${stats.avgImprovement}%`;
                
                // Llenar tabla de participantes
                fillParticipantsTable(allParticipantsData);
                
                // Actualizar acciones de la capacitaci√≥n
                updateTrainingActions(data.training);
                
                // Mostrar contenedor
                reportLoading.style.display = 'none';
                reportContainer.style.display = 'block';
                
            } catch (error) {
                console.error('‚ùå Error cargando reporte:', error);
                reportLoading.style.display = 'none';
                
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo cargar el reporte: ' + error.message
                });
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // LLENAR TABLA DE PARTICIPANTES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function fillParticipantsTable(participants) {
            const tbody = document.getElementById('participantsTableBody');
            const noParticipantsMessage = document.getElementById('noParticipantsMessage');
            const table = document.getElementById('participantsTable');
            
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (!participants || participants.length === 0) {
                table.style.display = 'none';
                noParticipantsMessage.style.display = 'block';
                return;
            }
            
            table.style.display = 'table';
            noParticipantsMessage.style.display = 'none';
            
            participants.forEach((participant, index) => {
                const row = document.createElement('tr');
                row.dataset.status = participant.status;
                row.dataset.name = participant.nombre.toLowerCase();
                
                // Determinar clases para las calificaciones
                const pretestClass = getScoreClass(participant.pretestScore);
                const postestClass = getScoreClass(participant.postestScore);
                const improvementClass = participant.improvement > 0 ? 'positive' : 
                                        participant.improvement < 0 ? 'negative' : 'neutral';
                
                // Determinar clase para el estado
                let statusClass = 'pending';
                if (participant.status === 'Completado') statusClass = 'completed';
                else if (participant.status === 'Pretest Completado') statusClass = 'pretest-done';
                
                row.innerHTML = `
                    <td style="padding: 0.75rem; font-weight: bold; color: var(--primary);">${index + 1}</td>
                    <td style="padding: 0.75rem;">
                        <div style="font-weight: 500;">${participant.nombre}</div>
                        ${participant.email ? `<div style="font-size: 0.8rem; color: #F2FFFA;">${participant.email}</div>` : ''}
                    </td>
                    <td style="padding: 0.75rem; color: #F2FFFA;">${participant.departamento || '-'}</td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <span class="score-badge ${pretestClass}">${participant.pretestScore > 0 ? participant.pretestScore + '%' : '-'}</span>
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <span class="score-badge ${postestClass}">${participant.postestScore > 0 ? participant.postestScore + '%' : '-'}</span>
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <span class="improvement-badge ${improvementClass}">
                            ${participant.postestScore > 0 ? (participant.improvement >= 0 ? '+' : '') + participant.improvement + '%' : '-'}
                        </span>
                    </td>
                    <td style="padding: 0.75rem; text-align: center;">
                        <span class="status-badge ${statusClass}">${participant.status}</span>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // FILTRAR TABLA DE PARTICIPANTES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function filterParticipantsTable() {
            const searchValue = document.getElementById('participantSearchInput').value.toLowerCase();
            const statusFilter = document.getElementById('participantStatusFilter').value;
            
            // Filtrar datos
            const filteredParticipants = allParticipantsData.filter(p => {
                const matchesSearch = p.nombre.toLowerCase().includes(searchValue) ||
                                     (p.email && p.email.toLowerCase().includes(searchValue)) ||
                                     (p.departamento && p.departamento.toLowerCase().includes(searchValue));
                
                const matchesStatus = !statusFilter || p.status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });
            
            // Actualizar tabla
            fillParticipantsTable(filteredParticipants);
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // ACTUALIZAR ACCIONES DE LA CAPACITACI√ìN
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function updateTrainingActions(training) {
            const container = document.getElementById('trainingActionsContainer');
            if (!container) return;
            
            if (training.finalizada) {
                container.innerHTML = `
                    <div style="background: #e8f5e9; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #4caf50;">
                        <p style="margin: 0; color: #F2FFFA;">
                            <i class="fas fa-check-circle"></i> <strong>Esta capacitaci√≥n est√° FINALIZADA</strong>
                        </p>
                        <p style="margin: 0.5rem 0 0 0; color: #F2FFFA; font-size: 0.9rem;">
                            Puede reutilizar esta capacitaci√≥n creando una nueva sesi√≥n desde la pesta√±a "Gestionar".
                        </p>
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-info" onclick="reactivateTraining('${training.id}')" style="margin: 0;">
                            <i class="fas fa-redo"></i> Reactivar Capacitaci√≥n
                        </button>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div style="background: linear-gradient(135deg, #e65100 0%, #bf360c 100%); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border-left: 4px solid #ff6f00;">
                        <p style="margin: 0; color: #ffffff; font-weight: 600;">
                            <i class="fas fa-exclamation-triangle"></i> <strong>¬øHa finalizado la capacitaci√≥n?</strong>
                        </p>
                        <p style="margin: 0.5rem 0 0 0; color: #ffffff; font-size: 0.9rem;">
                            Al finalizar una capacitaci√≥n, las sesiones activas se desactivar√°n y podr√° crear nuevas sesiones en el futuro.
                        </p>
                    </div>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-success" onclick="confirmFinalizeTraining('${training.id}')" style="margin: 0;">
                            <i class="fas fa-flag-checkered"></i> Finalizar Capacitaci√≥n
                        </button>
                    </div>
                `;
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // FINALIZAR CAPACITACI√ìN
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function confirmFinalizeTraining(trainingId) {
            Swal.fire({
                icon: 'question',
                title: '¬øFinalizar Capacitaci√≥n?',
                html: `
                    <p>Al finalizar la capacitaci√≥n:</p>
                    <ul style="text-align: left; margin: 1rem 0;">
                        <li>Las sesiones activas se desactivar√°n</li>
                        <li>Los participantes no podr√°n acceder con los c√≥digos actuales</li>
                        <li>Podr√°s crear nuevas sesiones para reutilizar la capacitaci√≥n</li>
                        <li>El historial de participantes se mantendr√°</li>
                    </ul>
                `,
                showCancelButton: true,
                confirmButtonText: 'S√≠, Finalizar',
                cancelButtonText: 'Cancelar',
                confirmButtonColor: '#28a745'
            }).then((result) => {
                if (result.isConfirmed) {
                    finalizeTraining(trainingId);
                }
            });
        }

        async function finalizeTraining(trainingId) {
            try {
                Swal.fire({
                    title: 'Finalizando capacitaci√≥n...',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                const response = await fetch('/.netlify/functions/toggle-training-status', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        trainingId: trainingId,
                        action: 'finalize'
                    })
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Error al finalizar');
                }
                
                Swal.fire({
                    icon: 'success',
                    title: '¬°Capacitaci√≥n Finalizada!',
                    text: `Se desactivaron ${data.sessionsUpdated} sesiones.`,
                    confirmButtonText: 'Continuar'
                }).then(() => {
                    // Recargar el reporte
                    loadTrainingReport();
                    // Recargar opciones del select
                    loadReportOptions();
                });
                
            } catch (error) {
                console.error('‚ùå Error finalizando capacitaci√≥n:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo finalizar la capacitaci√≥n: ' + error.message
                });
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // REACTIVAR CAPACITACI√ìN
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        async function reactivateTraining(trainingId) {
            try {
                const result = await Swal.fire({
                    icon: 'question',
                    title: '¬øReactivar Capacitaci√≥n?',
                    text: 'Las sesiones se reactivar√°n y los participantes podr√°n acceder nuevamente.',
                    showCancelButton: true,
                    confirmButtonText: 'S√≠, Reactivar',
                    cancelButtonText: 'Cancelar',
                    confirmButtonColor: '#17a2b8'
                });
                
                if (!result.isConfirmed) return;
                
                Swal.fire({
                    title: 'Reactivando capacitaci√≥n...',
                    allowOutsideClick: false,
                    didOpen: () => Swal.showLoading()
                });
                
                const response = await fetch('/.netlify/functions/toggle-training-status', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        trainingId: trainingId,
                        action: 'reactivate'
                    })
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Error al reactivar');
                }
                
                Swal.fire({
                    icon: 'success',
                    title: '¬°Capacitaci√≥n Reactivada!',
                    text: `Se reactivaron ${data.sessionsUpdated} sesiones.`,
                    confirmButtonText: 'Continuar'
                }).then(() => {
                    loadTrainingReport();
                    loadReportOptions();
                });
                
            } catch (error) {
                console.error('‚ùå Error reactivando capacitaci√≥n:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'No se pudo reactivar la capacitaci√≥n: ' + error.message
                });
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // EXPORTAR REPORTE A CSV
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function exportReportCSV() {
            if (!currentReportData || !currentReportData.participants || currentReportData.participants.length === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Sin datos',
                    text: 'No hay participantes para exportar'
                });
                return;
            }
            
            const training = currentReportData.training;
            const participants = currentReportData.participants;
            
            // Crear contenido CSV
            let csv = '\uFEFF'; // BOM para UTF-8
            csv += 'REPORTE DE CAPACITACI√ìN\n';
            csv += `"T√≠tulo","${training.titulo}"\n`;
            csv += `"Departamento","${training.departamento || 'General'}"\n`;
            csv += `"Fecha","${training.fechaCreacion || ''}"\n`;
            csv += `"Total Participantes","${currentReportData.statistics.totalParticipants}"\n`;
            csv += `"Completados","${currentReportData.statistics.completedPostest}"\n`;
            csv += `"Tasa de Adherencia","${currentReportData.statistics.adherenceRate}%"\n`;
            csv += '\n';
            csv += 'LISTADO DE PARTICIPANTES\n';
            csv += '"#","Nombre","Email","Departamento","Pretest (%)","Posttest (%)","Mejora (%)","Estado"\n';
            
            participants.forEach((p, i) => {
                csv += `"${i + 1}","${p.nombre}","${p.email || ''}","${p.departamento || ''}","${p.pretestScore || 0}","${p.postestScore || 0}","${p.improvement || 0}","${p.status}"\n`;
            });
            
            // Descargar archivo
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `Reporte_${training.titulo.replace(/[^a-zA-Z0-9]/g, '_')}_${formatDateForFile(new Date())}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            Swal.fire({
                icon: 'success',
                title: '¬°Exportado!',
                text: 'El reporte CSV ha sido descargado',
                timer: 2000,
                showConfirmButton: false
            });
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // EXPORTAR REPORTE A EXCEL (HTML TABLE)
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function exportReportExcel() {
            if (!currentReportData || !currentReportData.participants || currentReportData.participants.length === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Sin datos',
                    text: 'No hay participantes para exportar'
                });
                return;
            }
            
            const training = currentReportData.training;
            const participants = currentReportData.participants;
            const stats = currentReportData.statistics;
            const fechaActual = new Date().toLocaleDateString('es-CO', { day: '2-digit', month: 'long', year: 'numeric' }).toUpperCase();
            
            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            // FORMATO OFICIAL SLV-SR-03-F05
            // Hospital Susana L√≥pez de Valencia E.S.E.
            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            
            let html = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel">
                <head>
                    <meta charset="utf-8">
                    <!--[if gte mso 9]>
                    <xml>
                        <x:ExcelWorkbook>
                            <x:ExcelWorksheets>
                                <x:ExcelWorksheet>
                                    <x:Name>Informe</x:Name>
                                    <x:WorksheetOptions>
                                        <x:DisplayGridlines/>
                                    </x:WorksheetOptions>
                                </x:ExcelWorksheet>
                            </x:ExcelWorksheets>
                        </x:ExcelWorkbook>
                    </xml>
                    <![endif]-->
                    <style>
                        table { border-collapse: collapse; width: 100%; font-family: Arial, sans-serif; font-size: 10pt; }
                        th, td { border: 1px solid #000; padding: 6px 8px; vertical-align: top; }
                        .header-title { font-size: 12pt; font-weight: bold; text-align: center; background-color: #F2FFFA; }
                        .header-code { text-align: right; font-weight: bold; }
                        .section-title { background-color: #F2FFFA; font-weight: bold; text-align: center; }
                        .field-label { background-color: #F2FFFA; font-weight: bold; width: 25%; }
                        .field-value { width: 75%; }
                        .participants-header { background-color: #F2FFFA; color: #F2FFFA; font-weight: bold; text-align: center; }
                        .participants-row td { text-align: center; }
                        .participants-row td:nth-child(2) { text-align: left; }
                        .participants-row td:nth-child(3) { text-align: left; }
                        .results-header { background-color: #F2FFFA; color: #F2FFFA; font-weight: bold; }
                        .results-value { text-align: center; font-weight: bold; }
                        .signature-cell { height: 60px; vertical-align: bottom; text-align: center; }
                        .logo-cell { text-align: center; vertical-align: middle; }
                    </style>
                </head>
                <body>
                    <table>
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <!-- ENCABEZADO -->
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <tr>
                            <td rowspan="2" class="logo-cell" style="width: 15%; padding: 10px;">
                                <div style="text-align: center;">
                                    <div style="width: 60px; height: 60px; margin: 0 auto; border: 2px solid #003087; border-radius: 50%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #003087 0%, #001a4d 100%);">
                                        <span style="color: #F2FFFA; font-size: 24px;">‚≠ê</span>
                                    </div>
                                    <div style="margin-top: 5px;">
                                        <strong style="font-size: 9pt; color: #F2FFFA;">REP√öBLICA DE COLOMBIA</strong><br>
                                        <small style="font-size: 8pt; color: #F2FFFA;">Departamento del Cauca</small>
                                    </div>
                                </div>
                            </td>
                            <td colspan="4" rowspan="2" class="header-title">
                                INFORME DE PLANEACI√ìN, EJECUCI√ìN Y EVALUACI√ìN DE<br>
                                CAPACITACIONES INTERNAS
                            </td>
                            <td colspan="2" class="logo-cell" style="width: 20%; padding: 10px;">
                                <div style="text-align: center;">
                                    <div style="display: inline-block; padding: 5px;">
                                        <div style="color: #F2FFFA; font-size: 28px; margin-bottom: 3px;">üè•</div>
                                        <div style="font-size: 7pt; color: #F2FFFA;">HOSPITAL</div>
                                        <div style="font-size: 14pt; color: #F2FFFA; font-weight: bold;">Susana</div>
                                        <div style="font-size: 7pt; color: #F2FFFA;">L√≥pez de Valencia E.S.E.</div>
                                    </div>
                                    <div style="display: inline-block; margin-left: 10px; vertical-align: top;">
                                        <div style="border: 2px solid #003087; padding: 3px; font-size: 6pt; text-align: center;">
                                            <div style="color: #F2FFFA; font-weight: bold;">ACREDITACI√ìN</div>
                                            <div style="color: #F2FFFA;">EN SALUD</div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2" class="header-code">SLV-SR-03-F05</td>
                        </tr>
                        
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <!-- SECCI√ìN I. INFORMACI√ìN GENERAL -->
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <tr>
                            <td colspan="7" class="section-title">I. INFORMACI√ìN GENERAL</td>
                        </tr>
                        <tr>
                            <td class="field-label">CAPACITACI√ìN:</td>
                            <td colspan="6" class="field-value"><strong>${training.titulo || ''}</strong></td>
                        </tr>
                        <tr>
                            <td class="field-label">OBJETIVO DE LA CAPACITACI√ìN:</td>
                            <td colspan="6" class="field-value">${training.descripcion || 'Explicar al personal el uso adecuado del equipo/tema'}</td>
                        </tr>
                        <tr>
                            <td class="field-label">TEMAS A TRATAR:</td>
                            <td colspan="6" class="field-value">Funcionamiento adecuado - ${training.titulo || ''}</td>
                        </tr>
                        <tr>
                            <td class="field-label">METODOLOG√çA:</td>
                            <td colspan="6" class="field-value">Presencial</td>
                        </tr>
                        <tr>
                            <td class="field-label">PLANEACI√ìN:</td>
                            <td colspan="6" class="field-value">
                                1. Se prepara el tema de la capacitaci√≥n y el material educativo para la capacitaci√≥n<br>
                                2. Explicar al personal el correcto uso del tema/equipo<br>
                                3. Creaci√≥n del pre test y post test para aplicar al personal participante y determinar el grado de conocimiento del personal en el correcto uso
                            </td>
                        </tr>
                        <tr>
                            <td class="field-label">HACER:</td>
                            <td colspan="6" class="field-value">Realizar capacitaci√≥n en el buen uso de ${training.titulo || 'el tema'}</td>
                        </tr>
                        <tr>
                            <td class="field-label">VERIFICACI√ìN:</td>
                            <td colspan="6" class="field-value">Se realiz√≥ un pre test y un post test para las personas que participaron en la capacitaci√≥n para evaluar el grado de conocimiento en el tema.</td>
                        </tr>
                        <tr>
                            <td class="field-label">ACTUAR:</td>
                            <td colspan="6" class="field-value">(Aplica si en el pos test el resultado es <= al 100%, no aplica plan de acci√≥n si en el pos test el resultado es el 100% de adherencia)</td>
                        </tr>
                        <tr>
                            <td class="field-label">Lugar de Capacitaci√≥n y fecha:</td>
                            <td colspan="6" class="field-value">Hospital Susana L√≥pez de Valencia - ${fechaActual}</td>
                        </tr>
                        <tr>
                            <td class="field-label">Duraci√≥n de la capacitaci√≥n:</td>
                            <td colspan="6" class="field-value">30 min por proceso asistencial</td>
                        </tr>
                        <tr>
                            <td class="field-label">Expositor Responsable:</td>
                            <td colspan="6" class="field-value">ING. BIOM√âDICO</td>
                        </tr>
                        <tr>
                            <td class="field-label">Coordinador de capacitaci√≥n:</td>
                            <td colspan="6" class="field-value">ING. BIOM√âDICO</td>
                        </tr>
                        <tr>
                            <td class="field-label">Instrumento de Evaluaci√≥n:</td>
                            <td colspan="6" class="field-value">Pre y Post-Test</td>
                        </tr>
                        <tr>
                            <td class="field-label">N√∫mero de preguntas:</td>
                            <td colspan="6" class="field-value">10</td>
                        </tr>
                        <tr>
                            <td class="field-label">M√°xima calificaci√≥n:</td>
                            <td colspan="6" class="field-value">5 (nota: aprueban el examen los participantes que obtienen como resultado nota mayor e igual 3 puntos)</td>
                        </tr>
                        
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <!-- SECCI√ìN II. LISTADO DE PARTICIPANTES -->
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <tr><td colspan="7" style="border: none; height: 10px;"></td></tr>
                        <tr>
                            <td colspan="7" class="section-title">II. LISTADO DE ASISTENTES Y CALIFICACIONES</td>
                        </tr>
                        <tr class="participants-header">
                            <td style="width: 5%;">No.</td>
                            <td style="width: 30%;">NOMBRE COMPLETO</td>
                            <td style="width: 20%;">CARGO</td>
                            <td style="width: 15%;">SERVICIO</td>
                            <td style="width: 10%;">PRE-TEST</td>
                            <td style="width: 10%;">POST-TEST</td>
                            <td style="width: 10%;">FIRMA</td>
                        </tr>
            `;
            
            // Agregar participantes
            participants.forEach((p, i) => {
                html += `
                    <tr class="participants-row">
                        <td>${i + 1}</td>
                        <td>${p.nombre || ''}</td>
                        <td>${p.departamento || ''}</td>
                        <td>${p.departamento || ''}</td>
                        <td>${p.pretestScore > 0 ? (p.pretestScore / 20).toFixed(1) : '-'}</td>
                        <td>${p.postestScore > 0 ? (p.postestScore / 20).toFixed(1) : '-'}</td>
                        <td></td>
                    </tr>
                `;
            });
            
            // Agregar filas vac√≠as si hay menos de 10 participantes
            const filasVacias = Math.max(0, 10 - participants.length);
            for (let i = 0; i < filasVacias; i++) {
                html += `
                    <tr class="participants-row">
                        <td>${participants.length + i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                `;
            }
            
            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            // SECCI√ìN III. RESULTADOS
            // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
            
            html += `
                        <tr><td colspan="7" style="border: none; height: 10px;"></td></tr>
                        <tr>
                            <td colspan="7" class="section-title">III. RESULTADOS DE LA EVALUACI√ìN</td>
                        </tr>
                        <tr class="results-header">
                            <td colspan="2">INDICADOR</td>
                            <td colspan="2">VALOR</td>
                            <td colspan="3">OBSERVACIONES</td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Total de participantes:</td>
                            <td colspan="2" class="results-value">${stats.totalParticipants}</td>
                            <td colspan="3"></td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Participantes que completaron Pre-Test:</td>
                            <td colspan="2" class="results-value">${stats.completedPretest}</td>
                            <td colspan="3"></td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Participantes que completaron Post-Test:</td>
                            <td colspan="2" class="results-value">${stats.completedPostest}</td>
                            <td colspan="3"></td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Promedio Pre-Test:</td>
                            <td colspan="2" class="results-value">${(stats.avgPretestScore / 20).toFixed(1)} / 5.0</td>
                            <td colspan="3">${stats.avgPretestScore}%</td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Promedio Post-Test:</td>
                            <td colspan="2" class="results-value">${(stats.avgPostestScore / 20).toFixed(1)} / 5.0</td>
                            <td colspan="3">${stats.avgPostestScore}%</td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Mejora Promedio:</td>
                            <td colspan="2" class="results-value">+${stats.avgImprovement}%</td>
                            <td colspan="3"></td>
                        </tr>
                        <tr>
                            <td colspan="2" class="field-label">Tasa de Adherencia:</td>
                            <td colspan="2" class="results-value" style="background-color: ${stats.adherenceRate >= 80 ? '#c6efce' : stats.adherenceRate >= 60 ? '#ffeb9c' : '#ffc7ce'};">${stats.adherenceRate}%</td>
                            <td colspan="3">${stats.adherenceRate >= 80 ? 'Meta cumplida' : 'Requiere plan de mejora'}</td>
                        </tr>
                        
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <!-- SECCI√ìN IV. FIRMAS -->
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <tr><td colspan="7" style="border: none; height: 20px;"></td></tr>
                        <tr>
                            <td colspan="7" class="section-title">IV. FIRMAS DE RESPONSABLES</td>
                        </tr>
                        <tr>
                            <td colspan="3" class="signature-cell">
                                <br><br><br>
                                _________________________________<br>
                                <strong>EXPOSITOR RESPONSABLE</strong><br>
                                Ing. Biom√©dico
                            </td>
                            <td colspan="4" class="signature-cell">
                                <br><br><br>
                                _________________________________<br>
                                <strong>COORDINADOR DE CAPACITACI√ìN</strong><br>
                                Ing. Biom√©dico
                            </td>
                        </tr>
                        
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <!-- PIE DE P√ÅGINA -->
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <tr><td colspan="7" style="border: none; height: 10px;"></td></tr>
                        <tr>
                            <td colspan="7" style="text-align: center; font-size: 8pt; color: #F2FFFA; border: none;">
                                Documento generado autom√°ticamente por el Sistema de Capacitaciones - Hospital Susana L√≥pez de Valencia E.S.E.<br>
                                Fecha de generaci√≥n: ${new Date().toLocaleString('es-CO')}
                            </td>
                        </tr>
                    </table>
                </body>
                </html>
            `;
            
            // Descargar archivo
            const blob = new Blob([html], { type: 'application/vnd.ms-excel;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `SLV-SR-03-F05_${training.titulo.replace(/[^a-zA-Z0-9]/g, '_')}_${formatDateForFile(new Date())}.xls`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            Swal.fire({
                icon: 'success',
                title: '¬°Reporte Generado!',
                html: `<p>Se ha descargado el informe oficial <strong>SLV-SR-03-F05</strong></p>
                       <p><small>Formato: Informe de Planeaci√≥n, Ejecuci√≥n y Evaluaci√≥n de Capacitaciones Internas</small></p>`,
                timer: 3000,
                showConfirmButton: false
            });
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // IMPRIMIR REPORTE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function printReport() {
            if (!currentReportData) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Sin datos',
                    text: 'No hay reporte para imprimir'
                });
                return;
            }
            
            window.print();
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // FUNCIONES AUXILIARES PARA REPORTES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        function getScoreClass(score) {
            if (!score || score === 0) return 'pending';
            if (score >= 80) return 'excellent';
            if (score >= 60) return 'good';
            if (score >= 40) return 'average';
            return 'low';
        }

        function formatDateForReport(dateString) {
            if (!dateString) return '-';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('es-CO', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch (e) {
                return dateString;
            }
        }

        function formatDateForFile(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        console.log('üìä M√≥dulo de Reportes cargado correctamente');
    </script>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MODAL DE LINK POSTTEST - PRETEST ‚Üí POSTTEST
     Modal que muestra QR y link permanente para postest
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="postestLinkModal" class="modal-overlay" style="display: none;">
  <div class="modal-content postest-modal" style="max-width: 600px;">
    <button class="close-btn" onclick="closePostestLinkModal()">‚úï</button>
    
    <div class="postest-modal-header">
      <i class="fas fa-check-circle" style="font-size: 3rem; color: #F2FFFA; margin-bottom: 1rem;"></i>
      <h2>¬°Pretest Completado!</h2>
      <p style="color: #F2FFFA; margin-top: 0.5rem;">
        Tu respuesta ha sido guardada correctamente
      </p>
    </div>

    <div class="postest-modal-body">
      <!-- Secci√≥n del QR -->
      <div class="postest-qr-section">
        <h3 style="color: #F2FFFA; margin-bottom: 1rem; text-align: center;">
          <i class="fas fa-qrcode"></i> C√≥digo para Posttest
        </h3>
        
        <div id="postestQrCode" style="
          display: flex;
          justify-content: center;
          padding: 1.5rem;
          background: #F1FAF5;
          border-radius: 12px;
          margin-bottom: 1.5rem;
        "></div>

        <div style="text-align: center; margin-bottom: 2rem;">
          <button onclick="downloadPostestQR()" class="btn btn-secondary" style="
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
          " onmouseover="this.style.background='#e8e8e8'" onmouseout="this.style.background='#f0f0f0'">
            <i class="fas fa-download"></i> Descargar QR
          </button>
        </div>
      </div>

      <!-- Secci√≥n del Link -->
      <div class="postest-link-section">
        <h3 style="color: #F2FFFA; margin-bottom: 1rem;">
          <i class="fas fa-link"></i> Link Permanente
        </h3>

        <div style="
          background: #f5f5f5;
          padding: 1rem;
          border-radius: 8px;
          border: 1px solid #e0e0e0;
          margin-bottom: 1rem;
        ">
          <input 
            type="text" 
            id="postestUrlInput" 
            readonly 
            style="
              width: 100%;
              padding: 0.75rem;
              border: none;
              background: white;
              border-radius: 4px;
              font-family: 'Courier New', monospace;
              font-size: 12px;
              word-break: break-all;
            "
          >
        </div>

        <button onclick="copyPostestUrl()" class="btn btn-primary" style="
          width: 100%;
          padding: 0.75rem 1.5rem;
          background: #2E7D32;
          color: #F2FFFA;
          border: none;
          border-radius: 8px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          margin-bottom: 1rem;
        " onmouseover="this.style.background='#5568d3'" onmouseout="this.style.background='#2E7D32'">
          <i class="fas fa-copy"></i> Copiar Link
        </button>
      </div>

      <!-- Instrucciones -->
      <div style="
        background: #e8f5e9;
        border-left: 4px solid #4caf50;
        padding: 1rem;
        border-radius: 4px;
        margin-top: 1.5rem;
      ">
        <p style="color: #F2FFFA; margin: 0; font-weight: 500;">
          <i class="fas fa-info-circle"></i> Informaci√≥n Importante
        </p>
        <ul style="color: #F2FFFA; font-size: 0.9rem; margin: 0.5rem 0 0 1.5rem; padding: 0;">
          <li>Este link es √∫nico para ti y permanecer√° v√°lido durante toda la capacitaci√≥n</li>
          <li>Guarda el link o escanea el QR para usarlo despu√©s de la capacitaci√≥n</li>
          <li>Podr√°s responder el postest desde cualquier dispositivo usando este c√≥digo</li>
          <li>Solo necesitar√°s este c√≥digo para acceder al postest</li>
        </ul>
      </div>

      <!-- C√≥digo corto -->
      <div style="
        background: #fff3e0;
        border-radius: 8px;
        padding: 1rem;
        text-align: center;
        margin-top: 1.5rem;
      ">
        <p style="color: #F2FFFA; font-size: 0.9rem; margin: 0 0 0.5rem 0;">
          O usa este c√≥digo:
        </p>
        <div style="
          font-size: 1.3rem;
          font-weight: bold;
          color: #F2FFFA;
          font-family: 'Courier New', monospace;
          letter-spacing: 2px;
        " id="postestCodeDisplay">
          ---
        </div>
      </div>
    </div>

    <div class="postest-modal-footer" style="
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid #e0e0e0;
    ">
      <button onclick="closePostestLinkModal()" class="btn-secondary" style="
        flex: 1;
        padding: 0.75rem 1.5rem;
        background: #f0f0f0;
        border: 1px solid #ddd;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s;
      " onmouseover="this.style.background='#e8e8e8'" onmouseout="this.style.background='#f0f0f0'">
        Cerrar
      </button>
      <button onclick="copyPostestUrl()" class="btn-primary" style="
        flex: 1;
        padding: 0.75rem 1.5rem;
        background: #2E7D32;
        color: #F2FFFA;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      " onmouseover="this.style.background='#5568d3'" onmouseout="this.style.background='#2E7D32'">
        Copiar Link
      </button>
    </div>
  </div>
</div>

<!-- CSS para el Modal Posttest -->
<style>
  .postest-modal {
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    padding: 2rem;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
  }

  .postest-modal-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .postest-modal-header h2 {
    color: #F2FFFA;
    font-size: 1.8rem;
    margin: 1rem 0 0.5rem 0;
  }

  .postest-qr-section {
    text-align: center;
    margin-bottom: 2rem;
  }

  .postest-link-section {
    margin: 2rem 0;
  }

  .postest-link-section h3 {
    margin-bottom: 1rem;
  }

  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    padding: 1rem;
  }

  .modal-overlay.show {
    display: flex;
  }

  .close-btn {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #F2FFFA;
    transition: color 0.3s;
  }

  .close-btn:hover {
    color: #F2FFFA;
  }

  /* Responsive */
  @media (max-width: 600px) {
    .postest-modal {
      padding: 1.5rem;
      margin: 0 1rem;
    }

    .postest-modal-header h2 {
      font-size: 1.5rem;
    }

    #postestQrCode {
      width: 200px !important;
      height: 200px !important;
      margin: 0 auto 1rem !important;
    }

    .postest-modal-footer {
      flex-direction: column;
    }

    .postest-modal-footer button {
      width: 100% !important;
    }
  }
</style>

</body>
</html>
